<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Fitting Baselines to Spectra • hyperSpec</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cerulean/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Fitting Baselines to Spectra">
<meta property="og:description" content="baseline: Tutorial explaining hyperSpec's baseline fitting functions.">
<meta name="robots" content="noindex">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">hyperSpec</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.100.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa-book"></span>
     
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li class="dropdown-header">Documentation for version of package:</li>
    <li>
      <a href="https://cbeleites.github.io/hyperSpec/">Released</a>
    </li>
    <li>
      <a href="https://cbeleites.github.io/hyperSpec/dev/">In-development</a>
    </li>
  </ul>
</li>
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/hyperSpec.html">Get started</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/fileio.html">Import and Export Files with Spectra</a>
    </li>
    <li>
      <a href="../articles/plotting.html">Plotting Functions in "hyperSpec"</a>
    </li>
    <li>
      <a href="../articles/baseline.html">Fitting Baselines to Spectra</a>
    </li>
    <li class="divider">
    <li>
      <a href="../articles/index.html">More...</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/r-hyperspec/hyperSpec/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="baseline_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Fitting Baselines to Spectra</h1>
            <h3 class="subtitle">Tutorial Explaining hyperSpec’s Baseline Fitting Functions</h3>
                        <h4 class="author">Claudia Beleites<sup>1,2,3,4,5</sup>, Vilmantas Gegzna</h4>
            <address class="author_afil">
      <ol style="list-style-type: decimal">
<li>DIA Raman Spectroscopy Group, University of Trieste/Italy (2005–2008)</li>
      <li>Spectroscopy <span class="math inline">\(\cdot\)</span> Imaging, IPHT, Jena/Germany (2008–2017)</li>
      <li>ÖPV, JKI, Berlin/Germany (2017–2019)</li>
      <li>Arbeitskreis Lebensmittelmikrobiologie und Biotechnologie, Hamburg University, Hamburg/Germany (2019 – 2020)</li>
      <li>Chemometric Consulting and Chemometrix GmbH, Wölfersheim/Germany (since 2016)</li>
      </ol>
<br><a class="author_email" href="mailto:#"></a><a href="mailto:chemometrie@beleites.de" class="email">chemometrie@beleites.de</a>
      </address>
                  
            <h4 class="date">2021-07-14</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/r-hyperspec/hyperSpec/blob/master/../vignettes/baseline.Rmd"><code>../vignettes/baseline.Rmd</code></a></small>
      <div class="hidden name"><code>baseline.Rmd</code></div>

    </div>

    
    
<div id="sec:introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#sec:introduction" class="anchor"></a><span class="header-section-number">1</span> Introduction</h1>
<p>This document discusses baseline correction methods that can be used with package <strong>hyperSpec</strong>.
Package <strong>hyperSpec</strong> provides two fitting functions for polynomial baselines, <code class="sourceCode r"><span class="kw">spc_fit_poly</span>()</code> and <code class="sourceCode r"><span class="kw">spc_fit_poly_below</span>()</code>.
Another possibility is <code class="sourceCode r"><span class="kw">spc_rubberband</span>()</code>, a “rubberband” method that determines support points by finding the convex hull of each spectrum.
The baselines are then piecewise linear or (smoothing) splines through the support points.</p>
<p>Please note that a specialized package for baseline fitting, package <strong>baseline</strong><span class="citation">[<a href="#ref-R-baseline" role="doc-biblioref">1</a>,<a href="#ref-baseline2010" role="doc-biblioref">2</a>]</span>, exists that provides many more methods to fit baselines to spectroscopic data.
Using package <strong>baseline</strong> with <code class="sourceCode r">hyperSpec</code> objects is demonstrated in <code class="sourceCode r"><span class="kw">vignette</span> (<span class="st">"hyperspec"</span>)</code>.</p>
</div>
<div id="sec:polynomial-baselines" class="section level1">
<h1 class="hasAnchor">
<a href="#sec:polynomial-baselines" class="anchor"></a><span class="header-section-number">2</span> Polynomial Baselines</h1>
<p>In contrast to many other programs that provide baseline correction methods, package <strong>hyperSpec</strong>’s polynomial baseline functions do least squares fits.
However, the baselines can be forced through particular points, if this behaviour is needed.</p>
<p>The main difference between the two functions is that <code class="sourceCode r"><span class="kw">spc_fit_poly</span>()</code> returns a least squares fit through the complete spectrum that is given in <code class="sourceCode r">fit.to</code> whereas <code class="sourceCode r"><span class="kw">spc_fit_poly_below</span>()</code> tries to find appropriate spectral regions to fit the baseline to.</p>
<div id="syntax-and-parameters" class="section level2">
<h2 class="hasAnchor">
<a href="#syntax-and-parameters" class="anchor"></a><span class="header-section-number">2.1</span> Syntax and Parameters</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/spc_fit_poly.html">spc_fit_poly</a></span><span class="op">(</span><span class="va">fit.to</span>, apply.to <span class="op">=</span> <span class="va">fit.to</span>, poly.order <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>

<span class="fu"><a href="../reference/spc_fit_poly.html">spc_fit_poly_below</a></span><span class="op">(</span><span class="va">fit.to</span>, apply.to <span class="op">=</span> <span class="va">fit.to</span>, poly.order <span class="op">=</span> <span class="fl">1</span>, npts.min <span class="op">=</span> <span class="cn">NULL</span>, noise <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></code></pre></div>
<ul>
<li>
<strong><code class="sourceCode r">fit.to</code>:</strong> <code class="sourceCode r">hyperSpec</code> object with the spectra whose baselines are to be fitted.</li>
<li>
<strong><code class="sourceCode r">apply.to</code>:</strong> <code class="sourceCode r">hyperSpec</code> object giving the spectral range, on which the baselines should be evaluated.
If <code class="sourceCode r"><span class="kw">apply</span>()</code> is <code class="sourceCode r"><span class="ot">NULL</span></code>, a <code class="sourceCode r">hyperSpec</code> object with the polynomial coefficients is returned instead of evaluated baselines.</li>
<li>
<strong><code class="sourceCode r">poly.order</code>:</strong> polynomial order of the baselines.</li>
<li>
<strong><code class="sourceCode r">npts.min</code>:</strong> minimal number of data points per spectrum to be used for the fit.
Argument <code class="sourceCode r">npts.min</code> defaults to the larger of 3 times (<code class="sourceCode r">poly.order <span class="op">+</span><span class="st"> </span><span class="dv">1</span></code>) or <span class="math inline">\(\frac{1}{20th}\)</span> of the number of data points per spectrum.
If <code class="sourceCode r">npts.min</code> <span class="math inline">\(\leq\)</span> <code>poly.order</code>, a warning is issued and <code class="sourceCode r">npts.min &lt;-<span class="st"> </span>poly.order <span class="op">+</span><span class="st"> </span><span class="dv">1</span></code> is used.</li>
<li>
<strong><code class="sourceCode r">noise</code>:</strong> a vector giving the amount of noise, see below.</li>
</ul>
</div>
<div id="general-use" class="section level2">
<h2 class="hasAnchor">
<a href="#general-use" class="anchor"></a><span class="header-section-number">2.2</span> General Use</h2>
<p>Both functions fit the polynomial to the spectral range given in <code class="sourceCode r">hyperSpec</code> object <code class="sourceCode r">fit.to</code>.
If <code class="sourceCode r">apply.to</code> is not <code class="sourceCode r"><span class="ot">NULL</span></code>, the polynomials are evaluated on the spectral range of <code class="sourceCode r">apply.to</code>.
Otherwise, the polynomial coefficients are returned.</p>
<p>Subtracting the baseline is up to the user, it is easily done as <code class="sourceCode r">hyperSpec</code> provides the <code class="sourceCode r"><span class="op">-</span></code> (minus) operator.</p>
</div>
<div id="sec:fitt-polyn-basel" class="section level2">
<h2 class="hasAnchor">
<a href="#sec:fitt-polyn-basel" class="anchor"></a><span class="header-section-number">2.3</span> Fitting Polynomial Baselines Using Least Squares</h2>
<p>Commonly, baselines are fit using (single) support points that are specified by the user.
Also, usually <span class="math inline">\(n + 1\)</span> support point is used for a polynomial of order <span class="math inline">\(n\)</span>.
This approach is appropriate for spectra with high signal to noise ratio.</p>
<p>Such a baseline can be obtained by restricting the spectra in <code class="sourceCode r">fit.to</code> to the respective points (see figure <a href="#fig:classical">2.1</a>):</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Load Raman spectra</span>
<span class="va">file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"extdata/chondro_mini.rds"</span>, package <span class="op">=</span> <span class="st">"hyperSpec"</span><span class="op">)</span>
<span class="va">chondro_mini</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span><span class="va">file</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">bl</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/spc_fit_poly.html">spc_fit_poly</a></span><span class="op">(</span><span class="va">chondro_mini</span><span class="op">[</span>, , <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">633</span>, <span class="fl">1788</span><span class="op">)</span><span class="op">]</span>, <span class="va">chondro_mini</span><span class="op">)</span>

<span class="fu"><a href="../reference/plot-methods.html">plot</a></span><span class="op">(</span><span class="va">chondro_mini</span>, plot.args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">200</span>, <span class="fl">600</span><span class="op">)</span><span class="op">)</span>, col <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span>
<span class="fu"><a href="../reference/plot-methods.html">plot</a></span><span class="op">(</span><span class="va">chondro_mini</span><span class="op">[</span>, , <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">633</span>, <span class="fl">1788</span><span class="op">)</span><span class="op">]</span>,
  add <span class="op">=</span> <span class="cn">TRUE</span>, col <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">2</span>,
  lines.args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"p"</span>, pch <span class="op">=</span> <span class="fl">20</span><span class="op">)</span>
<span class="op">)</span>
<span class="fu"><a href="../reference/plot-methods.html">plot</a></span><span class="op">(</span><span class="va">bl</span>, add <span class="op">=</span> <span class="cn">TRUE</span>, col <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span id="fig:classical"></span>
<img src="baseline_files/figure-html/classical-1.png" alt="Fitting a linear baseline through two points.
If the signal to noise ratio is not ideal, wavelengths that work fine for one spectrum (black) may not be appropriate for another (red). "><p class="caption">
Figure 2.1: Fitting a linear baseline through two points.
If the signal to noise ratio is not ideal, wavelengths that work fine for one spectrum (black) may not be appropriate for another (red).
</p>
</div>
<p>However, if the signal to noise ratio is not ideal, a polynomial with <span class="math inline">\(n + 1\)</span> supporting points (i.e. with zero degrees of freedom) is subject to a considerable amount of noise.
If on the other hand, more data points consisting of baseline only are available, the uncertainty on the polynomial can be reduced by a least squares fit.</p>
<p>Both <code class="sourceCode r"><span class="kw">spc_fit_poly</span>()</code> and <code class="sourceCode r"><span class="kw">spc_fit_poly_below</span>()</code> therefore provide least squares fitting for the polynomial.</p>
<p>Function <code class="sourceCode r"><span class="kw">spc_fit_poly</span>()</code> fits to the whole spectral region of <code class="sourceCode r">fit.to</code>.
Thus, for baseline fitting the spectra need to be cut to appropriate wavelength ranges that do not contain any signal.</p>
<p>In order to speed up calculations, the least squares fit is done by using the Vandermonde matrix and solving the equation system by <code class="sourceCode r"><span class="kw">qr.solve</span>()</code>.</p>
<p>This fit is not weighted.
A spectral region with many data points therefore has greater influence on the resulting baseline than a region with just a few data points.
It is up to the user to decide whether this should be corrected for by selecting appropriate numbers of data points (e.g. by using replicates of the shorter spectral region).</p>
</div>
<div id="sec:autofit-baseline" class="section level2">
<h2 class="hasAnchor">
<a href="#sec:autofit-baseline" class="anchor"></a><span class="header-section-number">2.4</span> The Mechanism of Automatically Fitting the Baseline in <code>spc_fit_poly_below()</code>
</h2>
<p>Function <code class="sourceCode r"><span class="kw">spc_fit_poly_below</span>()</code> tries to automatically find appropriate spectral regions for baseline fitting.
This is done by excluding spectral regions that contain signals from the baseline fitting.
The idea is that all data points that lie above a fitted polynomial (initially through the whole spectrum, then through the remaining parts of the spectrum) will be treated as signal and thus be excluded from the baseline fitting.</p>
<p>The supporting points for the baseline polynomials are calculated iteratively:</p>
<ol style="list-style-type: decimal">
<li>A polynomial of the requested order is fit to the considered spectral range, initially to the whole spectrum given in <code class="sourceCode r">fit.to</code>
</li>
<li>Only the parts of the spectrum that lie below this polynomial plus the <code class="sourceCode r">noise</code> are retained as supporting points for the next iteration.</li>
</ol>
<p>These two steps are repeated until either:</p>
<ul>
<li>no further points are excluded, or</li>
<li>the next polynomial would have less than <code class="sourceCode r">npts.min</code> supporting points.</li>
</ul>
<p>The baselines and respective supporting points for each iteration of <code class="sourceCode r"><span class="kw">spc_fit_poly_below</span>(chondro_mini[<span class="dv">1</span>], <span class="dt">poly.order =</span> <span class="dv">1</span>)</code> are shown in figure <a href="#fig:iter">2.2</a>.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">bl</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/spc_fit_poly.html">spc_fit_poly_below</a></span><span class="op">(</span><span class="va">chondro_mini</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, poly.order <span class="op">=</span> <span class="fl">1</span>, max.iter <span class="op">=</span> <span class="fl">8</span>, npts.min <span class="op">=</span> <span class="fl">2</span>, debuglevel <span class="op">=</span> <span class="fl">3L</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span id="fig:iter"></span>
<img src="baseline_files/figure-html/iter-1.png" alt="Iterative fitting of the baseline. The dots give the supporting points for the next iteration's baseline, color: iterations.  "><p class="caption">
Figure 2.2: Iterative fitting of the baseline. The dots give the supporting points for the next iteration’s baseline, color: iterations.
</p>
</div>
</div>
<div id="specifying-the-spectral-range" class="section level2">
<h2 class="hasAnchor">
<a href="#specifying-the-spectral-range" class="anchor"></a><span class="header-section-number">2.5</span> Specifying the Spectral Range</h2>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plot-methods.html">plot</a></span><span class="op">(</span><span class="va">chondro_mini</span><span class="op">[</span><span class="fl">1</span>, , <span class="fl">1700</span> <span class="op">~</span> <span class="fl">1750</span><span class="op">]</span>,
  lines.args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"b"</span><span class="op">)</span>,
  plot.args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html">range</a></span><span class="op">(</span><span class="va">chondro_mini</span><span class="op">[</span><span class="fl">1</span>, , <span class="fl">1700</span> <span class="op">~</span> <span class="fl">1750</span><span class="op">]</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">50</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span>
<span class="op">)</span>

<span class="va">bl</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/spc_fit_poly.html">spc_fit_poly_below</a></span><span class="op">(</span><span class="va">chondro_mini</span><span class="op">[</span><span class="fl">1</span>, , <span class="fl">1700</span> <span class="op">~</span> <span class="fl">1750</span><span class="op">]</span>, <span class="cn">NULL</span>, poly.order <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span><span class="va">bl</span><span class="op">[[</span><span class="op">]</span><span class="op">]</span>, col <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span>

<span class="fu"><a href="../reference/plot-methods.html">plot</a></span><span class="op">(</span>
  <span class="va">chondro_mini</span><span class="op">[</span><span class="fl">1</span>, , <span class="fl">1720</span> <span class="op">~</span> <span class="fl">1750</span><span class="op">]</span>,
  lines.args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"p"</span>, pch <span class="op">=</span> <span class="fl">19</span>, cex <span class="op">=</span> <span class="fl">.6</span><span class="op">)</span>,
  col <span class="op">=</span> <span class="st">"blue"</span>,
  add <span class="op">=</span> <span class="cn">T</span>
<span class="op">)</span>

<span class="va">bl</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/spc_fit_poly.html">spc_fit_poly_below</a></span><span class="op">(</span><span class="va">chondro_mini</span><span class="op">[</span><span class="fl">1</span>, , <span class="fl">1720</span> <span class="op">~</span> <span class="fl">1750</span><span class="op">]</span>, <span class="cn">NULL</span>, poly.order <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span><span class="va">bl</span><span class="op">[[</span><span class="op">]</span><span class="op">]</span>, col <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span id="fig:spectralrange"></span>
<img src="baseline_files/figure-html/spectralrange-1.png" alt="Influence of `fit.to`{.r} on the baseline polynomial.
The black baseline is fit to the spectral range 1700 - 1750 $cm^{-1}$, the blue to 1720 - 1750 $cm^{-1}$ only.  "><p class="caption">
Figure 2.3: Influence of <code class="sourceCode r">fit.to</code> on the baseline polynomial.
The black baseline is fit to the spectral range 1700 - 1750 <span class="math inline">\(cm^{-1}\)</span>, the blue to 1720 - 1750 <span class="math inline">\(cm^{-1}\)</span> only.
</p>
</div>
<p>It is possible to exclude spectral regions that do not contribute to the baseline from the fitting, while the baseline is used for the whole spectrum.
This selection of appropriate spectral regions is essential for <code class="sourceCode r"><span class="kw">spc_fit_poly</span>()</code>.
But also <code class="sourceCode r"><span class="kw">spc_fit_poly_below</span>()</code> can benefit from narrower spectral ranges: the fitting gains speed.
The default value for <code class="sourceCode r">npts.min</code> depends on the number of data points per spectrum.
Thus one should also consider requiring more support points than the default value suggests.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/system.time.html">system.time</a></span><span class="op">(</span><span class="fu"><a href="../reference/spc_fit_poly.html">spc_fit_poly_below</a></span><span class="op">(</span><span class="va">chondro_mini</span>, <span class="cn">NULL</span>, npts.min <span class="op">=</span> <span class="fl">20</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt;    user  system elapsed </span>
<span class="co">#&gt;   0.005   0.000   0.005</span>
<span class="fu"><a href="https://rdrr.io/r/base/system.time.html">system.time</a></span><span class="op">(</span><span class="fu"><a href="../reference/spc_fit_poly.html">spc_fit_poly_below</a></span><span class="op">(</span><span class="va">chondro_mini</span><span class="op">[</span>, , <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">min</span> <span class="op">~</span> <span class="fl">700</span>, <span class="fl">1700</span> <span class="op">~</span> <span class="va">max</span><span class="op">)</span><span class="op">]</span>, <span class="cn">NULL</span>, npts.min <span class="op">=</span> <span class="fl">20</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt;    user  system elapsed </span>
<span class="co">#&gt;   0.004   0.000   0.004</span></code></pre></div>
<p>The choice of the spectral range in <code class="sourceCode r">fit.to</code> influences the resulting baselines to a certain extent, as becomes clear from figure <a href="#fig:spectralrange">2.3</a>.</p>
</div>
<div id="fitting-polynomials-of-different-orders" class="section level2">
<h2 class="hasAnchor">
<a href="#fitting-polynomials-of-different-orders" class="anchor"></a><span class="header-section-number">2.6</span> Fitting Polynomials of Different Orders</h2>
<!-- ======================================================================= -->
<!-- ======================================================================= -->
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">bl</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/spc_fit_poly.html">spc_fit_poly_below</a></span><span class="op">(</span><span class="va">chondro_mini</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, poly.order <span class="op">=</span> <span class="fl">0</span>, debuglevel <span class="op">=</span> <span class="fl">2</span>, max.iter <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>
<span class="co">#&gt; Fitting with npts.min = 8</span>
<span class="co">#&gt; start: 150 support points</span>
<span class="co">#&gt; spectrum      1:    10 support points, noise = 0.0,   5 iterations</span></code></pre></div>
<div class="figure" style="text-align: center">
<span id="fig:figorder0"></span>
<img src="baseline_files/figure-html/figorder0-1.png" alt="Baseline polynomial fit to the first spectrum of the chondro_mini data set of order 0 -- 2 (left to right).
The dots indicate the points used for the fitting of the polynomial.  "><p class="caption">
Figure 2.4: Baseline polynomial fit to the first spectrum of the chondro_mini data set of order 0 – 2 (left to right).
The dots indicate the points used for the fitting of the polynomial.
</p>
</div>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">bl</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/spc_fit_poly.html">spc_fit_poly_below</a></span><span class="op">(</span><span class="va">chondro_mini</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, poly.order <span class="op">=</span> <span class="fl">1</span>, debuglevel <span class="op">=</span> <span class="fl">2</span>, max.iter <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>
<span class="co">#&gt; Fitting with npts.min = 8</span>
<span class="co">#&gt; start: 150 support points</span>
<span class="co">#&gt; Warning in spc_fit_poly_below(chondro_mini[1], poly.order = 1, debuglevel = 2, : Stopped after 5</span>
<span class="co">#&gt; iterations with 14 support points.</span>
<span class="co">#&gt; spectrum      1:    14 support points, noise = 0.0,   5 iterations</span></code></pre></div>
<div class="figure" style="text-align: center">
<span id="fig:figorder1"></span>
<img src="baseline_files/figure-html/figorder1-1.png" alt="Baseline polynomial fit to the first spectrum of the chondro_mini data set of order 0 -- 2 (left to right).
The dots indicate the points used for the fitting of the polynomial.  "><p class="caption">
Figure 2.5: Baseline polynomial fit to the first spectrum of the chondro_mini data set of order 0 – 2 (left to right).
The dots indicate the points used for the fitting of the polynomial.
</p>
</div>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">bl</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/spc_fit_poly.html">spc_fit_poly_below</a></span><span class="op">(</span><span class="va">chondro_mini</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, poly.order <span class="op">=</span> <span class="fl">2</span>, debuglevel <span class="op">=</span> <span class="fl">2</span>, max.iter <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>
<span class="co">#&gt; Fitting with npts.min = 9</span>
<span class="co">#&gt; start: 150 support points</span>
<span class="co">#&gt; spectrum      1:    11 support points, noise = 0.0,   5 iterations</span></code></pre></div>
<div class="figure" style="text-align: center">
<span id="fig:figorder2"></span>
<img src="baseline_files/figure-html/figorder2-1.png" alt="Baseline polynomial fit to the first spectrum of the chondro_mini data set of order 0 -- 2 (left to right).
The dots indicate the points used for the fitting of the polynomial.  "><p class="caption">
Figure 2.6: Baseline polynomial fit to the first spectrum of the chondro_mini data set of order 0 – 2 (left to right).
The dots indicate the points used for the fitting of the polynomial.
</p>
</div>
<p>Figures <a href="#fig:figorder0">2.4</a>, <a href="#fig:figorder1">2.5</a>, <a href="#fig:figorder2">2.6</a> show the resulting baseline polynomial of <code class="sourceCode r"><span class="kw">spc_fit_poly_below</span> (chondro_mini [<span class="dv">1</span>], <span class="dt">poly.order =</span> order)</code> with <code class="sourceCode r">order</code> <span class="math inline">\(=\)</span> 0 to 3 for the first spectrum of the chondro_mini data set.</p>
</div>
<div id="the-noise-level" class="section level2">
<h2 class="hasAnchor">
<a href="#the-noise-level" class="anchor"></a><span class="header-section-number">2.7</span> The Noise Level</h2>
<!-- Upper part: -->
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">spc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/initialize.html">new</a></span><span class="op">(</span><span class="st">"hyperSpec"</span>, spc <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">100</span>, mean <span class="op">=</span> <span class="fl">100</span>, sd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">100</span><span class="op">)</span><span class="op">)</span>
<span class="va">noise</span> <span class="op">&lt;-</span> <span class="fl">4</span>
<span class="fu"><a href="../reference/spc_fit_poly.html">spc_fit_poly_below</a></span><span class="op">(</span><span class="va">spc</span>, poly.order <span class="op">=</span> <span class="fl">0</span>, noise <span class="op">=</span> <span class="va">noise</span>, debuglevel <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>
<span class="co">#&gt; hyperSpec object</span>
<span class="co">#&gt;    1 spectra</span>
<span class="co">#&gt;    1 data columns</span>
<span class="co">#&gt;    100 data points / spectrum</span>
<span class="fu"><a href="../reference/plot-methods.html">plot</a></span><span class="op">(</span><span class="fu"><a href="../reference/spc_fit_poly.html">spc_fit_poly_below</a></span><span class="op">(</span><span class="va">spc</span>, poly.order <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>, col <span class="op">=</span> <span class="st">"black"</span>, add <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span id="fig:fig3"></span>
<img src="baseline_files/figure-html/fig3-1.png" alt="Iterative fitting of the baseline with noise level.
Effects of the noise parameter on the baseline of a spectrum consisting only of noise and offset: without giving `noise`{.r} the resulting baseline (black) is clearly too low.
A noise level of 4 results in the blue baseline. "><p class="caption">
Figure 2.7: Iterative fitting of the baseline with noise level.
Effects of the noise parameter on the baseline of a spectrum consisting only of noise and offset: without giving <code class="sourceCode r">noise</code> the resulting baseline (black) is clearly too low.
A noise level of 4 results in the blue baseline.
</p>
</div>
<!-- The lower part show -->
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">bl</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/spc_fit_poly.html">spc_fit_poly_below</a></span><span class="op">(</span><span class="va">chondro_mini</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, poly.order <span class="op">=</span> <span class="fl">1</span>, noise <span class="op">=</span> <span class="fl">15</span>, max.iter <span class="op">=</span> <span class="fl">8</span>, debuglevel <span class="op">=</span> <span class="fl">3L</span><span class="op">)</span>
<span class="co">#&gt; Warning in spc_fit_poly_below(chondro_mini[1], poly.order = 1, noise = 15, : Stopped after 8</span>
<span class="co">#&gt; iterations with 13 support points.</span></code></pre></div>
<div class="figure" style="text-align: center">
<span id="fig:fig4"></span>
<img src="baseline_files/figure-html/fig4-1.png" alt="Iterative fitting of the baseline with noise level.
The baseline fitting with noise level on the complete spectrum.
Colour: iterations, dots: supporting points for the respectively next baseline.
Dashed: baseline plus noise.
All points above this line are excluded from the next iteration.  "><p class="caption">
Figure 2.8: Iterative fitting of the baseline with noise level.
The baseline fitting with noise level on the complete spectrum.
Colour: iterations, dots: supporting points for the respectively next baseline.
Dashed: baseline plus noise.
All points above this line are excluded from the next iteration.
</p>
</div>
<p>Besides defining a minimal number of supporting points, a “noise level” may be given.
Consider a spectral range consisting only of noise.
The upper part of figures <a href="#fig:fig3">2.7</a>, <a href="#fig:fig4">2.8</a> illustrate the problem.
As the baseline fitting algorithm cannot distinguish between noise and real bands appearing above the fitted polynomial, the resulting baseline (black) is too low if the <code class="sourceCode r">noise</code> parameter is not given.</p>
<p>Setting the noise level to 4 (2 standard deviations), the fitting converges immediately with a much better result.
The resulting baselines for <code class="sourceCode r"><span class="kw">spc_fit_poly_below</span> (chondro_mini [<span class="dv">1</span>], <span class="dt">poly.order =</span> <span class="dv">1</span>, <span class="dt">noise =</span> <span class="dv">12</span>)</code> of the whole spectrum are shown in the middle and lower part of figure <a href="#fig:fig4">2.8</a>.</p>
<p>The <code class="sourceCode r">noise</code> may be a single value for all spectra, or a vector with the noise level for each of the spectra separately.</p>
</div>
</div>
<div id="rubberband-method" class="section level1">
<h1 class="hasAnchor">
<a href="#rubberband-method" class="anchor"></a><span class="header-section-number">3</span> Rubberband Method</h1>
<p>Particularly Raman spectra often show increasing background towards <span class="math inline">\(\Delta\tilde\nu = 0\)</span>.
In this case, polynomial baselines often either need high order or residual background is left in the spectra.</p>
<p>In that case, smoothing splines fitted through the supporting points are a good alternative.</p>
<p>For the <code class="sourceCode r">paracetamol</code> spectrum (fig. <a href="#fig:rubberband-raw">3.1</a>, <a href="#fig:rubberband">3.2</a>), a noise level of 300 counts and the equivalent of 20 degrees of freedom work well.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">bl</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/spc_rubberband.html">spc_rubberband</a></span><span class="op">(</span><span class="va">paracetamol</span><span class="op">[</span>, , <span class="fl">175</span> <span class="op">~</span> <span class="fl">1800</span><span class="op">]</span>, noise <span class="op">=</span> <span class="fl">300</span>, df <span class="op">=</span> <span class="fl">20</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plot-methods.html">plot</a></span><span class="op">(</span><span class="va">paracetamol</span><span class="op">[</span>, , <span class="fl">175</span> <span class="op">~</span> <span class="fl">1800</span><span class="op">]</span><span class="op">)</span>
<span class="fu"><a href="../reference/plot-methods.html">plot</a></span><span class="op">(</span><span class="va">bl</span>, add <span class="op">=</span> <span class="cn">TRUE</span>, col <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span id="fig:rubberband-raw"></span>
<img src="baseline_files/figure-html/rubberband-raw-1.png" alt="Rubberband baselines for the paracetamol spectrum:`paracetamol`{.r} with the `rubberband()`{.r} fitted baseline.  "><p class="caption">
Figure 3.1: Rubberband baselines for the paracetamol spectrum:<code class="sourceCode r">paracetamol</code> with the <code class="sourceCode r"><span class="kw">rubberband</span>()</code> fitted baseline.
</p>
</div>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plot-methods.html">plot</a></span><span class="op">(</span><span class="va">paracetamol</span><span class="op">[</span>, , <span class="fl">175</span> <span class="op">~</span> <span class="fl">1800</span><span class="op">]</span> <span class="op">-</span> <span class="va">bl</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span id="fig:rubberband"></span>
<img src="baseline_files/figure-html/rubberband-1.png" alt="Rubberband baselines for the paracetamol spectrum: corrected spectrum.  "><p class="caption">
Figure 3.2: Rubberband baselines for the paracetamol spectrum: corrected spectrum.
</p>
</div>
<p>However, there is possibly some background left between 1200 and 1750 cm<sup>-1</sup> where the original spectrum is slightly concave.
This can be corrected by bending the spectrum before applying the rubberband correction (fig. <a href="#fig:rubberband-bent-raw">3.3</a>, <a href="#fig:rubberband-bent-corrected">3.4</a>):</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">bend</span> <span class="op">&lt;-</span> <span class="fl">5e4</span> <span class="op">*</span> <span class="fu"><a href="../reference/wl_eval.html">wl_eval</a></span><span class="op">(</span><span class="va">paracetamol</span><span class="op">[</span>, , <span class="fl">175</span> <span class="op">~</span> <span class="fl">1800</span><span class="op">]</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span><span class="op">^</span><span class="fl">2</span>, normalize.wl <span class="op">=</span> <span class="va">normalize01</span><span class="op">)</span>
<span class="va">bl</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/spc_rubberband.html">spc_rubberband</a></span><span class="op">(</span><span class="va">paracetamol</span><span class="op">[</span>, , <span class="fl">175</span> <span class="op">~</span> <span class="fl">1800</span><span class="op">]</span> <span class="op">+</span> <span class="va">bend</span><span class="op">)</span> <span class="op">-</span> <span class="va">bend</span></code></pre></div>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plot-methods.html">plot</a></span><span class="op">(</span><span class="va">paracetamol</span><span class="op">[</span>, , <span class="fl">175</span> <span class="op">~</span> <span class="fl">1800</span><span class="op">]</span> <span class="op">+</span> <span class="va">bend</span><span class="op">)</span>
<span class="fu"><a href="../reference/plot-methods.html">plot</a></span><span class="op">(</span><span class="va">bl</span> <span class="op">+</span> <span class="va">bend</span>, add <span class="op">=</span> <span class="cn">T</span>, col <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span id="fig:rubberband-bent-raw"></span>
<img src="baseline_files/figure-html/rubberband-bent-raw-1.png" alt="Rubberband baselines for the paracetamol spectrum after bending: bent `paracetamol`{.r} spectrum and rubberband baseline. "><p class="caption">
Figure 3.3: Rubberband baselines for the paracetamol spectrum after bending: bent <code class="sourceCode r">paracetamol</code> spectrum and rubberband baseline.
</p>
</div>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plot-methods.html">plot</a></span><span class="op">(</span><span class="va">paracetamol</span><span class="op">[</span>, , <span class="fl">175</span> <span class="op">~</span> <span class="fl">1800</span><span class="op">]</span> <span class="op">-</span> <span class="va">bl</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span id="fig:rubberband-bent-corrected"></span>
<img src="baseline_files/figure-html/rubberband-bent-corrected-1.png" alt="Rubberband baselines for the paracetamol spectrum after bendin: corrected spectrum.  "><p class="caption">
Figure 3.4: Rubberband baselines for the paracetamol spectrum after bendin: corrected spectrum.
</p>
</div>
</div>
<div id="session-info" class="section level1 unnumbered">
<h1 class="hasAnchor">
<a href="#session-info" class="anchor"></a>Session Info</h1>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">sessioninfo</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/sessioninfo/man/session_info.html">session_info</a></span><span class="op">(</span><span class="st">"hyperSpec"</span><span class="op">)</span>
<span class="co">#&gt; ─ Session info ───────────────────────────────────────────────────────────────────────────────────</span>
<span class="co">#&gt;  setting  value                       </span>
<span class="co">#&gt;  version  R version 4.1.0 (2021-05-18)</span>
<span class="co">#&gt;  os       macOS Catalina 10.15.7      </span>
<span class="co">#&gt;  system   x86_64, darwin17.0          </span>
<span class="co">#&gt;  ui       X11                         </span>
<span class="co">#&gt;  language (EN)                        </span>
<span class="co">#&gt;  collate  en_US.UTF-8                 </span>
<span class="co">#&gt;  ctype    en_US.UTF-8                 </span>
<span class="co">#&gt;  tz       UTC                         </span>
<span class="co">#&gt;  date     2021-07-14                  </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; ─ Packages ───────────────────────────────────────────────────────────────────────────────────────</span>
<span class="co">#&gt;  package        * version    date       lib source        </span>
<span class="co">#&gt;  brio             1.1.2      2021-04-23 [1] CRAN (R 4.1.0)</span>
<span class="co">#&gt;  callr            3.7.0      2021-04-20 [1] CRAN (R 4.1.0)</span>
<span class="co">#&gt;  cli              3.0.0      2021-06-30 [1] CRAN (R 4.1.0)</span>
<span class="co">#&gt;  colorspace       2.0-2      2021-06-24 [1] CRAN (R 4.1.0)</span>
<span class="co">#&gt;  crayon           1.4.1      2021-02-08 [1] CRAN (R 4.1.0)</span>
<span class="co">#&gt;  desc             1.3.0      2021-03-05 [1] CRAN (R 4.1.0)</span>
<span class="co">#&gt;  diffobj          0.3.4      2021-03-22 [1] CRAN (R 4.1.0)</span>
<span class="co">#&gt;  digest           0.6.27     2020-10-24 [1] CRAN (R 4.1.0)</span>
<span class="co">#&gt;  dplyr            1.0.7      2021-06-18 [1] CRAN (R 4.1.0)</span>
<span class="co">#&gt;  ellipsis         0.3.2      2021-04-29 [1] CRAN (R 4.1.0)</span>
<span class="co">#&gt;  evaluate         0.14       2019-05-28 [1] CRAN (R 4.1.0)</span>
<span class="co">#&gt;  fansi            0.5.0      2021-05-25 [1] CRAN (R 4.1.0)</span>
<span class="co">#&gt;  farver           2.1.0      2021-02-28 [1] CRAN (R 4.1.0)</span>
<span class="co">#&gt;  generics         0.1.0      2020-10-31 [1] CRAN (R 4.1.0)</span>
<span class="co">#&gt;  ggplot2        * 3.3.5      2021-06-25 [1] CRAN (R 4.1.0)</span>
<span class="co">#&gt;  glue             1.4.2      2020-08-27 [1] CRAN (R 4.1.0)</span>
<span class="co">#&gt;  gtable           0.3.0      2019-03-25 [1] CRAN (R 4.1.0)</span>
<span class="co">#&gt;  hyperSpec      * 0.100.0    2021-07-14 [1] local         </span>
<span class="co">#&gt;  hySpc.testthat   0.2.1.9000 2021-06-15 [1] local         </span>
<span class="co">#&gt;  isoband          0.2.5      2021-07-13 [1] CRAN (R 4.1.0)</span>
<span class="co">#&gt;  jpeg             0.1-8.1    2019-10-24 [1] CRAN (R 4.1.0)</span>
<span class="co">#&gt;  jsonlite         1.7.2      2020-12-09 [1] CRAN (R 4.1.0)</span>
<span class="co">#&gt;  labeling         0.4.2      2020-10-20 [1] CRAN (R 4.1.0)</span>
<span class="co">#&gt;  lattice        * 0.20-44    2021-05-02 [2] CRAN (R 4.1.0)</span>
<span class="co">#&gt;  latticeExtra     0.6-29     2019-12-19 [1] CRAN (R 4.1.0)</span>
<span class="co">#&gt;  lazyeval         0.2.2      2019-03-15 [1] CRAN (R 4.1.0)</span>
<span class="co">#&gt;  lifecycle        1.0.0      2021-02-15 [1] CRAN (R 4.1.0)</span>
<span class="co">#&gt;  magrittr         2.0.1      2020-11-17 [1] CRAN (R 4.1.0)</span>
<span class="co">#&gt;  MASS             7.3-54     2021-05-03 [2] CRAN (R 4.1.0)</span>
<span class="co">#&gt;  Matrix           1.3-3      2021-05-04 [2] CRAN (R 4.1.0)</span>
<span class="co">#&gt;  mgcv             1.8-35     2021-04-18 [2] CRAN (R 4.1.0)</span>
<span class="co">#&gt;  munsell          0.5.0      2018-06-12 [1] CRAN (R 4.1.0)</span>
<span class="co">#&gt;  nlme             3.1-152    2021-02-04 [2] CRAN (R 4.1.0)</span>
<span class="co">#&gt;  pillar           1.6.1      2021-05-16 [1] CRAN (R 4.1.0)</span>
<span class="co">#&gt;  pkgconfig        2.0.3      2019-09-22 [1] CRAN (R 4.1.0)</span>
<span class="co">#&gt;  pkgload          1.2.1      2021-04-06 [1] CRAN (R 4.1.0)</span>
<span class="co">#&gt;  png              0.1-7      2013-12-03 [1] CRAN (R 4.1.0)</span>
<span class="co">#&gt;  praise           1.0.0      2015-08-11 [1] CRAN (R 4.1.0)</span>
<span class="co">#&gt;  processx         3.5.2      2021-04-30 [1] CRAN (R 4.1.0)</span>
<span class="co">#&gt;  ps               1.6.0      2021-02-28 [1] CRAN (R 4.1.0)</span>
<span class="co">#&gt;  purrr            0.3.4      2020-04-17 [1] CRAN (R 4.1.0)</span>
<span class="co">#&gt;  R6               2.5.0      2020-10-28 [1] CRAN (R 4.1.0)</span>
<span class="co">#&gt;  RColorBrewer     1.1-2      2014-12-07 [1] CRAN (R 4.1.0)</span>
<span class="co">#&gt;  rematch2         2.1.2      2020-05-01 [1] CRAN (R 4.1.0)</span>
<span class="co">#&gt;  rlang            0.4.11     2021-04-30 [1] CRAN (R 4.1.0)</span>
<span class="co">#&gt;  rprojroot        2.0.2      2020-11-15 [1] CRAN (R 4.1.0)</span>
<span class="co">#&gt;  rstudioapi       0.13       2020-11-12 [1] CRAN (R 4.1.0)</span>
<span class="co">#&gt;  scales           1.1.1      2020-05-11 [1] CRAN (R 4.1.0)</span>
<span class="co">#&gt;  testthat         3.0.4      2021-07-01 [1] CRAN (R 4.1.0)</span>
<span class="co">#&gt;  tibble           3.1.2      2021-05-16 [1] CRAN (R 4.1.0)</span>
<span class="co">#&gt;  tidyselect       1.1.1      2021-04-30 [1] CRAN (R 4.1.0)</span>
<span class="co">#&gt;  utf8             1.2.1      2021-03-12 [1] CRAN (R 4.1.0)</span>
<span class="co">#&gt;  vctrs            0.3.8      2021-04-29 [1] CRAN (R 4.1.0)</span>
<span class="co">#&gt;  viridisLite      0.4.0      2021-04-13 [1] CRAN (R 4.1.0)</span>
<span class="co">#&gt;  waldo            0.2.5      2021-03-08 [1] CRAN (R 4.1.0)</span>
<span class="co">#&gt;  withr            2.4.2      2021-04-18 [1] CRAN (R 4.1.0)</span>
<span class="co">#&gt;  xml2             1.3.2      2020-04-23 [1] CRAN (R 4.1.0)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [1] /Users/runner/work/_temp/Library</span>
<span class="co">#&gt; [2] /Library/Frameworks/R.framework/Versions/4.1/Resources/library</span></code></pre></div>
</div>
<div id="references" class="section level1 unnumbered">
<h1 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h1>
<div id="refs" class="references">
<div id="ref-R-baseline">
<p>[1] K.H. Liland, B.-H. Mevik, Baseline: Baseline correction of spectra, 2020. <a href="https://CRAN.R-project.org/package=baseline">https://CRAN.R-project.org/package=baseline</a>.</p>
</div>
<div id="ref-baseline2010">
<p>[2] K.H. Liland, T. Almøy, B.-H. Mevik, Optimal choice of baseline correction for multivariate calibration of spectra, Applied Spectroscopy. 64 (2010) 1007–1016.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Claudia Beleites, <a href="https://orcid.org/0000-0002-9500-5167">Vilmantas Gegzna</a>, Bryan Hanson, Roman Kiselev, Erick Oduniyi, Valter Sergo.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
