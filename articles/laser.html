<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Unstable Laser Emission • hyperSpec</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cerulean/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Unstable Laser Emission">
<meta property="og:description" content="laser: Example workflow for time-series spectra dataset `laser`.">
<meta name="robots" content="noindex">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">hyperSpec</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.100.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa-book"></span>
     
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li class="dropdown-header">Documentation for version of package:</li>
    <li>
      <a href="https://cbeleites.github.io/hyperSpec/">Released</a>
    </li>
    <li>
      <a href="https://cbeleites.github.io/hyperSpec/dev/">In-development</a>
    </li>
  </ul>
</li>
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/hyperSpec.html">Get started</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/fileio.html">Import and Export Files with Spectra</a>
    </li>
    <li>
      <a href="../articles/plotting.html">Plotting Functions in "hyperSpec"</a>
    </li>
    <li>
      <a href="../articles/baseline.html">Fitting Baselines to Spectra</a>
    </li>
    <li class="divider">
    <li>
      <a href="../articles/index.html">More...</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/cbeleites/hyperSpec/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="laser_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Unstable Laser Emission</h1>
            <h3 class="subtitle">Example Workflow for Time-Series Spectra Dataset <code>laser</code>
</h3>
                        <h4 class="author">Claudia Beleites<sup>1,2,3,4,5</sup>, Vilmantas Gegzna</h4>
            <address class="author_afil">
      <ol style="list-style-type: decimal">
<li>DIA Raman Spectroscopy Group, University of Trieste/Italy (2005–2008)</li>
      <li>Spectroscopy <span class="math inline">\(\cdot\)</span> Imaging, IPHT, Jena/Germany (2008–2017)</li>
      <li>ÖPV, JKI, Berlin/Germany (2017–2019)</li>
      <li>Arbeitskreis Lebensmittelmikrobiologie und Biotechnologie, Hamburg University, Hamburg/Germany (2019 – 2020)</li>
      <li>Chemometric Consulting and Chemometrix GmbH, Wölfersheim/Germany (since 2016)</li>
      </ol>
<br><a class="author_email" href="mailto:#"></a><a href="mailto:chemometrie@beleites.de" class="email">chemometrie@beleites.de</a>
      </address>
                  
            <h4 class="date">2021-06-17</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/cbeleites/hyperSpec/blob/master/../vignettes/laser.Rmd"><code>../vignettes/laser.Rmd</code></a></small>
      <div class="hidden name"><code>laser.Rmd</code></div>

    </div>

    
    
<pre><code>#&gt; tweaking rgl</code></pre>
<!-- ======================================================================= -->
<!-- ======================================================================= -->
<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor"></a><span class="header-section-number">1</span> Introduction</h1>
<!-- ======================================================================= -->
<!-- ======================================================================= -->
<p>This data set consists of a time series of 84 spectra of an unstable laser emission at 405 nm recorded during ca. 1.5 h.</p>
<p>The spectra were recorded during the installation of the 405 nm laser at a Raman spectrometer.
There is no Raman scattering involved in this data, but the Raman software recorded the abscissa of the spectra as Raman shift in wavenumbers.</p>
<p>This document shows:</p>
<ul>
<li>How to convert the wavelength axis (spectral abscissa),</li>
<li>How to display time series data as intensity over time diagram,</li>
<li>How to display time series data as 3d and false colour image of intensity as function of time and wavelength.</li>
</ul>
</div>
<div id="loading-the-data-and-preprocessing" class="section level1">
<h1 class="hasAnchor">
<a href="#loading-the-data-and-preprocessing" class="anchor"></a><span class="header-section-number">2</span> Loading the Data and Preprocessing</h1>
<p>Load the <strong>hyperSpec</strong> package.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://cbeleites.github.io/hyperSpec">hyperSpec</a></span><span class="op">)</span></code></pre></div>
<p>Read the data files:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Renishaw file</span>
<span class="va">file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"extdata/laser.txt.gz"</span>, package <span class="op">=</span> <span class="st">"hyperSpec"</span><span class="op">)</span>
<span class="va">laser</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/DEPRECATED-read.txt.Renishaw.html">read.txt.Renishaw</a></span><span class="op">(</span><span class="va">file</span>, data <span class="op">=</span> <span class="st">"ts"</span><span class="op">)</span>
<span class="co">#&gt; Warning: Function 'read.txt.Renishaw' is deprecated. </span>
<span class="co">#&gt; Please, find alternatives in package 'hySpc.read.txt'</span>
<span class="co">#&gt; https://r-hyperspec.github.io/hySpc.read.txt</span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plot-methods.html">plot</a></span><span class="op">(</span><span class="va">laser</span>, <span class="st">"spcprctl5"</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span id="fig:rawspc"></span>
<img src="laser_files/figure-html/rawspc-1.png" alt="The raw laser emission spectra.  "><p class="caption">
Figure 2.1: The raw laser emission spectra.
</p>
</div>
<p>As the laser emission was recorded with a Raman spectrometer, the wavelength axis initially is the Raman shift in wavenumbers (cm<sup>-1</sup>).</p>
<p>As most of the spectra do not show any signal (fig. <a href="#fig:rawspc">2.1</a>), so the spectral range can be cut to -75 – 0 cm<sup>-1</sup>.
Note that negative numbers in the spectral range specification with the tilde do not exclude the spectral range but rather mean negative values of the wavelength axis.
The results are shown in figure <a href="#fig:cutspc">2.2</a>.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">laser</span> <span class="op">&lt;-</span> <span class="va">laser</span><span class="op">[</span>, , <span class="op">-</span><span class="fl">75</span> <span class="op">~</span> <span class="fl">0</span><span class="op">]</span>
<span class="fu"><a href="../reference/plot-methods.html">plot</a></span><span class="op">(</span><span class="va">laser</span>, <span class="st">"spcprctl5"</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span id="fig:cutspc"></span>
<img src="laser_files/figure-html/cutspc-1.png" alt="The cut spectra laser emission spectra.   "><p class="caption">
Figure 2.2: The cut spectra laser emission spectra.
</p>
</div>
<p>The wavelength axis was recorded as Raman shift from 405 nm.
However, the spectra were taken before calibrating the wavelength axis.
The band at -50 cm<sup>-1</sup> is known to be at 405 nm.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/wl.html">wl</a></span><span class="op">(</span><span class="va">laser</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/wl.html">wl</a></span><span class="op">(</span><span class="va">laser</span><span class="op">)</span> <span class="op">+</span> <span class="fl">50</span></code></pre></div>
<p>Furthermore, as the spectra are not Raman shift but emission, the wavelength axis should be converted to proper wavelengths in nm.</p>
<p>The Raman shift is calculated from the wavelength as follows in equation <a href="#eq:laser-eq-1">(2.1)</a> with <span class="math inline">\(\Delta\tilde\nu\)</span> being the Raman shift, and <span class="math inline">\(\lambda_0\)</span> the excitation wavelength for a Raman process, here 405 nm.</p>
<!-- Equation ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~  -->
<p><span class="math display" id="eq:laser-eq-1">\[\begin{equation}

  \Delta\tilde\nu = \frac{1}{\lambda_0} -  \frac{1}{\lambda}
  \tag{2.1}

\end{equation}\]</span>
<!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~  --></p>
<p>The wavelengths corresponding to the wavenumbers are thus:</p>
<!-- Equation ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~  -->
<p><span class="math display" id="eq:laser-eq-2">\[\begin{equation}

  \lambda = \frac{1}{ \frac{1}{\lambda_0} - \Delta\tilde\nu}
  \tag{2.2}

\end{equation}\]</span>
<!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~  --></p>
<p>Taking into account that 1 cm = 10<span class="math inline">\(^7\)</span> nm, we arrive at the new wavelength axis:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/wl.html">wl</a></span><span class="op">(</span><span class="va">laser</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
  wl <span class="op">=</span> <span class="fl">1e7</span> <span class="op">/</span> <span class="op">(</span><span class="fl">1</span> <span class="op">/</span> <span class="fl">405e-7</span> <span class="op">-</span> <span class="fu"><a href="../reference/wl.html">wl</a></span><span class="op">(</span><span class="va">laser</span><span class="op">)</span><span class="op">)</span>,
  label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="va">lambda</span> <span class="op">/</span> <span class="va">nm</span><span class="op">)</span>
<span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plot-methods.html">plot</a></span><span class="op">(</span><span class="va">laser</span>, <span class="st">"spcprctl5"</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span id="fig:wlspc"></span>
<img src="laser_files/figure-html/wlspc-1.png" alt="The spectra with wavelength axis. "><p class="caption">
Figure 2.3: The spectra with wavelength axis.
</p>
</div>
<p>Note that the new wavelength axis label is immediately assigned as well.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">laser</span><span class="op">$</span><span class="va">filename</span> <span class="op">&lt;-</span> <span class="cn">NULL</span>
<span class="va">laser</span>
<span class="co">#&gt; hyperSpec object</span>
<span class="co">#&gt;    84 spectra</span>
<span class="co">#&gt;    2 data columns</span>
<span class="co">#&gt;    36 data points / spectrum</span></code></pre></div>
<p>This version of <code class="sourceCode r">laser</code> datasets is shipped with package <strong>hyperSpec</strong>.</p>
</div>
<div id="inspecting-the-time-dependency-of-the-laser-emission" class="section level1">
<h1 class="hasAnchor">
<a href="#inspecting-the-time-dependency-of-the-laser-emission" class="anchor"></a><span class="header-section-number">3</span> Inspecting the Time Dependency of the Laser Emission</h1>
<p>The maxima of the different emission lines encountered during this measurement are at 405.0, 405.1, 405.3, and 405.4 nm (fig. <a href="#fig:markspc">3.1</a>).</p>
<p>Alternatively they can be extracted from the graph using <code class="sourceCode r"><span class="kw">locator</span>()</code> which reads out the coordinates of the points the user clicks with the mouse (use middle or right click to end the input):</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">wls</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/locator.html">locator</a></span><span class="op">(</span><span class="op">)</span><span class="op">$</span><span class="va">x</span></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plot-methods.html">plot</a></span><span class="op">(</span><span class="va">laser</span>, <span class="st">"spcmeansd"</span><span class="op">)</span>

<span class="va">cols</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"black"</span>, <span class="st">"blue"</span>, <span class="st">"red"</span>, <span class="st">"darkgreen"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>v <span class="op">=</span> <span class="va">wls</span>, col <span class="op">=</span> <span class="va">cols</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span id="fig:markspc"></span>
<img src="laser_files/figure-html/markspc-1.png" alt="The spectral position of the bands in the laser emission time series. "><p class="caption">
Figure 3.1: The spectral position of the bands in the laser emission time series.
</p>
</div>
<p>Function <code class="sourceCode r"><span class="kw">plotc</span>()</code> can also be used to plot time-series.
In that case, the abscissa needs to be specified in parameter <code class="sourceCode r">use.c</code>.
The collection time is stored in column <code class="sourceCode r"><span class="op">$</span>t</code> in seconds from start of the measurement, and can be handed over as the column name.
The resulting time series are shown in figure <a href="#fig:ts">3.2</a>.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plotc.html">plotc</a></span><span class="op">(</span><span class="va">laser</span><span class="op">[</span>, , <span class="va">wls</span><span class="op">]</span>, <span class="va">spc</span> <span class="op">~</span> <span class="va">t</span>, groups <span class="op">=</span> <span class="va">.wavelength</span>, type <span class="op">=</span> <span class="st">"b"</span>, cex <span class="op">=</span> <span class="fl">0.3</span>, col <span class="op">=</span> <span class="va">cols</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span id="fig:ts"></span>
<img src="laser_files/figure-html/ts-1.png" alt="The time series data.
The colors in this plot correspond to colors in fig. \@ref(fig:ts).  "><p class="caption">
Figure 3.2: The time series data.
The colors in this plot correspond to colors in fig. <a href="#fig:ts">3.2</a>.
</p>
</div>
<p>Another option is to condition the plot on <span class="math inline">\(\lambda\)</span> <a href="#fig:tsextra">3.3</a>.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plotc.html">plotc</a></span><span class="op">(</span><span class="va">laser</span><span class="op">[</span>, , <span class="va">wls</span><span class="op">]</span>, <span class="va">spc</span> <span class="op">~</span> <span class="va">t</span> <span class="op">|</span> <span class="va">.wavelength</span>, type <span class="op">=</span> <span class="st">"b"</span>, cex <span class="op">=</span> <span class="fl">0.3</span>, col <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span id="fig:tsextra"></span>
<img src="laser_files/figure-html/tsextra-1.png" alt="The time series plots can also be conditioned on `$.wavelength`{.r}. "><p class="caption">
Figure 3.3: The time series plots can also be conditioned on <code class="sourceCode r"><span class="op">$</span>.wavelength</code>.
</p>
</div>
</div>
<div id="sec:plotmat" class="section level1">
<h1 class="hasAnchor">
<a href="#sec:plotmat" class="anchor"></a><span class="header-section-number">4</span> False-Colour Plot of the Spectral Intensity Over Wavelength and Time</h1>
<p>Package <strong>hyperSpec</strong> supplies functions to draw the spectral matrix using package <strong>lattice</strong>’s <code class="sourceCode r"><span class="kw">levelplot</span>()</code>.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plot-methods.html">plot</a></span><span class="op">(</span><span class="va">laser</span>, <span class="st">"mat"</span>, contour <span class="op">=</span> <span class="cn">TRUE</span>, col <span class="op">=</span> <span class="st">"#00000060"</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span id="fig:plotmatr"></span>
<img src="laser_files/figure-html/plotmatr-1.png" alt="The spectra matrix of the `laser`{.r} data set.
The ordinate of the plot may be the number of the spectrum accessed by `$.row`{.r} (here) or any other extra data column, as, e.g., `$t`{.r} in fig. \@ref(fig:plotmatt).  "><p class="caption">
Figure 4.1: The spectra matrix of the <code class="sourceCode r">laser</code> data set.
The ordinate of the plot may be the number of the spectrum accessed by <code class="sourceCode r"><span class="op">$</span>.row</code> (here) or any other extra data column, as, e.g., <code class="sourceCode r"><span class="op">$</span>t</code> in fig. <a href="#fig:plotmatt">4.2</a>.
</p>
</div>
<p>Package <strong>hyperSpec</strong>’s <code class="sourceCode r"><span class="kw">levelplot</span>()</code> method can be used to display the spectra matrix over a data column (instead of the row number): fig. <a href="#fig:plotmatr">4.1</a>, <a href="#fig:plotmatt">4.2</a>.
Note that the <code class="sourceCode r">hyperSpec</code> object is the <em>second</em> argument to the function (according to the notation in <code class="sourceCode r"><span class="kw">levelplot</span>()</code>).</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">levelplot</span><span class="op">(</span><span class="va">spc</span> <span class="op">~</span> <span class="va">.wavelength</span> <span class="op">*</span> <span class="va">t</span>, <span class="va">laser</span>, contour <span class="op">=</span> <span class="cn">TRUE</span>, col <span class="op">=</span> <span class="st">"#00000080"</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span id="fig:plotmatt"></span>
<img src="laser_files/figure-html/plotmatt-1.png" alt="The spectra matrix of the `laser`{.r} data set.
The ordinate of the plot may be any extra data column, here `$t`{.r}.  "><p class="caption">
Figure 4.2: The spectra matrix of the <code class="sourceCode r">laser</code> data set.
The ordinate of the plot may be any extra data column, here <code class="sourceCode r"><span class="op">$</span>t</code>.
</p>
</div>
</div>
<div id="sec:3d-plot-spectral" class="section level1">
<h1 class="hasAnchor">
<a href="#sec:3d-plot-spectral" class="anchor"></a><span class="header-section-number">5</span> A 3D Plot of the Spectral Intensity Over Wavelength and Time</h1>
<p>Class <code class="sourceCode r">hyperSpec</code> objects can be drawn with package <strong>rgl</strong><span class="citation">[<a href="#ref-R-rgl" role="doc-biblioref">1</a>]</span>:</p>
<p>Package <strong>rgl</strong>’s function <code class="sourceCode r"><span class="kw">persp3d</span>()</code> plots a surface in 3d defined by points in x, y, and z.
Handing over the appropriate data columns of the <code class="sourceCode r">hyperSpec</code> object is easy (fig. <a href="#fig:laser3d">5.1</a>).</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/dmurdoch/rgl">rgl</a></span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">laser</span> <span class="op">&lt;-</span> <span class="va">laser</span><span class="op">[</span>, , <span class="fl">404.8</span> <span class="op">~</span> <span class="fl">405.6</span><span class="op">]</span> <span class="op">/</span> <span class="fl">10000</span>
<span class="va">laser</span><span class="op">$</span><span class="va">t</span> <span class="op">&lt;-</span> <span class="va">laser</span><span class="op">$</span><span class="va">t</span> <span class="op">/</span> <span class="fl">3600</span>
<span class="va">cols</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fu"><a href="../reference/matlab.palette.html">matlab.palette</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">laser</span><span class="op">)</span><span class="op">)</span>, <span class="fu"><a href="../reference/ncol,hyperSpec-method.html">nwl</a></span><span class="op">(</span><span class="va">laser</span><span class="op">)</span><span class="op">)</span>

<span class="fu"><a href="https://dmurdoch.github.io/rgl/dev/reference/surface3d.html">surface3d</a></span><span class="op">(</span>y <span class="op">=</span> <span class="fu"><a href="../reference/wl.html">wl</a></span><span class="op">(</span><span class="va">laser</span><span class="op">)</span>, x <span class="op">=</span> <span class="va">laser</span><span class="op">$</span><span class="va">t</span>, z <span class="op">=</span> <span class="va">laser</span><span class="op">$</span><span class="va">spc</span>, col <span class="op">=</span> <span class="va">cols</span><span class="op">)</span>
<span class="fu"><a href="https://dmurdoch.github.io/rgl/dev/reference/surface3d.html">surface3d</a></span><span class="op">(</span>
  y <span class="op">=</span> <span class="fu"><a href="../reference/wl.html">wl</a></span><span class="op">(</span><span class="va">laser</span><span class="op">)</span>, x <span class="op">=</span> <span class="va">laser</span><span class="op">$</span><span class="va">t</span>, z <span class="op">=</span> <span class="va">laser</span><span class="op">$</span><span class="va">spc</span> <span class="op">+</span> <span class="fl">.1</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">laser</span><span class="op">)</span>,
  col <span class="op">=</span> <span class="st">"black"</span>, alpha <span class="op">=</span> <span class="fl">.2</span>, front <span class="op">=</span> <span class="st">"lines"</span>, line_antialias <span class="op">=</span> <span class="cn">TRUE</span>
<span class="op">)</span>

<span class="fu"><a href="https://dmurdoch.github.io/rgl/dev/reference/aspect3d.html">aspect3d</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">0.25</span><span class="op">)</span><span class="op">)</span>

<span class="fu"><a href="https://dmurdoch.github.io/rgl/dev/reference/axes3d.html">axes3d</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"x+-"</span>, <span class="st">"y--"</span>, <span class="st">"z--"</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://dmurdoch.github.io/rgl/dev/reference/axes3d.html">axes3d</a></span><span class="op">(</span><span class="st">"y--"</span>, nticks <span class="op">=</span> <span class="fl">25</span>, labels <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="fu"><a href="https://dmurdoch.github.io/rgl/dev/reference/axes3d.html">mtext3d</a></span><span class="op">(</span><span class="st">"t / h"</span>, <span class="st">"x+-"</span>, line <span class="op">=</span> <span class="fl">2.5</span><span class="op">)</span>
<span class="fu"><a href="https://dmurdoch.github.io/rgl/dev/reference/axes3d.html">mtext3d</a></span><span class="op">(</span><span class="st">"lambda / nm"</span>, <span class="st">"y--"</span>, line <span class="op">=</span> <span class="fl">2.5</span><span class="op">)</span>
<span class="fu"><a href="https://dmurdoch.github.io/rgl/dev/reference/axes3d.html">mtext3d</a></span><span class="op">(</span><span class="st">"I / a.u."</span>, <span class="st">"z--"</span>, line <span class="op">=</span> <span class="fl">2.5</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span id="fig:laser3d"></span>
<img src="laser--rgl-3d.png" alt="The 3d plot of the laser data.  " width="400"><p class="caption">
Figure 5.1: The 3d plot of the laser data.
</p>
</div>
</div>
<div id="session-info" class="section level1 unnumbered">
<h1 class="hasAnchor">
<a href="#session-info" class="anchor"></a>Session Info</h1>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">sessioninfo</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/sessioninfo/man/session_info.html">session_info</a></span><span class="op">(</span><span class="st">"hyperSpec"</span><span class="op">)</span>
<span class="co">#&gt; ─ Session info ───────────────────────────────────────────────────────────────────────────────────</span>
<span class="co">#&gt;  setting  value                       </span>
<span class="co">#&gt;  version  R version 4.1.0 (2021-05-18)</span>
<span class="co">#&gt;  os       macOS Catalina 10.15.7      </span>
<span class="co">#&gt;  system   x86_64, darwin17.0          </span>
<span class="co">#&gt;  ui       X11                         </span>
<span class="co">#&gt;  language (EN)                        </span>
<span class="co">#&gt;  collate  en_US.UTF-8                 </span>
<span class="co">#&gt;  ctype    en_US.UTF-8                 </span>
<span class="co">#&gt;  tz       UTC                         </span>
<span class="co">#&gt;  date     2021-06-17                  </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; ─ Packages ───────────────────────────────────────────────────────────────────────────────────────</span>
<span class="co">#&gt;  package        * version    date       lib source        </span>
<span class="co">#&gt;  brio             1.1.2      2021-04-23 [1] CRAN (R 4.1.0)</span>
<span class="co">#&gt;  callr            3.7.0      2021-04-20 [1] CRAN (R 4.1.0)</span>
<span class="co">#&gt;  cli              2.5.0      2021-04-26 [1] CRAN (R 4.1.0)</span>
<span class="co">#&gt;  colorspace       2.0-1      2021-05-04 [1] CRAN (R 4.1.0)</span>
<span class="co">#&gt;  crayon           1.4.1      2021-02-08 [1] CRAN (R 4.1.0)</span>
<span class="co">#&gt;  desc             1.3.0      2021-03-05 [1] CRAN (R 4.1.0)</span>
<span class="co">#&gt;  diffobj          0.3.4      2021-03-22 [1] CRAN (R 4.1.0)</span>
<span class="co">#&gt;  digest           0.6.27     2020-10-24 [1] CRAN (R 4.1.0)</span>
<span class="co">#&gt;  dplyr            1.0.6      2021-05-05 [1] CRAN (R 4.1.0)</span>
<span class="co">#&gt;  ellipsis         0.3.2      2021-04-29 [1] CRAN (R 4.1.0)</span>
<span class="co">#&gt;  evaluate         0.14       2019-05-28 [1] CRAN (R 4.1.0)</span>
<span class="co">#&gt;  fansi            0.5.0      2021-05-25 [1] CRAN (R 4.1.0)</span>
<span class="co">#&gt;  farver           2.1.0      2021-02-28 [1] CRAN (R 4.1.0)</span>
<span class="co">#&gt;  generics         0.1.0      2020-10-31 [1] CRAN (R 4.1.0)</span>
<span class="co">#&gt;  ggplot2        * 3.3.4      2021-06-16 [1] CRAN (R 4.1.0)</span>
<span class="co">#&gt;  glue             1.4.2      2020-08-27 [1] CRAN (R 4.1.0)</span>
<span class="co">#&gt;  gtable           0.3.0      2019-03-25 [1] CRAN (R 4.1.0)</span>
<span class="co">#&gt;  hyperSpec      * 0.100.0    2021-06-17 [1] local         </span>
<span class="co">#&gt;  hySpc.testthat   0.2.1.9000 2021-06-15 [1] local         </span>
<span class="co">#&gt;  isoband          0.2.4      2021-03-03 [1] CRAN (R 4.1.0)</span>
<span class="co">#&gt;  jpeg             0.1-8.1    2019-10-24 [1] CRAN (R 4.1.0)</span>
<span class="co">#&gt;  jsonlite         1.7.2      2020-12-09 [1] CRAN (R 4.1.0)</span>
<span class="co">#&gt;  labeling         0.4.2      2020-10-20 [1] CRAN (R 4.1.0)</span>
<span class="co">#&gt;  lattice        * 0.20-44    2021-05-02 [2] CRAN (R 4.1.0)</span>
<span class="co">#&gt;  latticeExtra     0.6-29     2019-12-19 [1] CRAN (R 4.1.0)</span>
<span class="co">#&gt;  lazyeval         0.2.2      2019-03-15 [1] CRAN (R 4.1.0)</span>
<span class="co">#&gt;  lifecycle        1.0.0      2021-02-15 [1] CRAN (R 4.1.0)</span>
<span class="co">#&gt;  magrittr         2.0.1      2020-11-17 [1] CRAN (R 4.1.0)</span>
<span class="co">#&gt;  MASS             7.3-54     2021-05-03 [2] CRAN (R 4.1.0)</span>
<span class="co">#&gt;  Matrix           1.3-3      2021-05-04 [2] CRAN (R 4.1.0)</span>
<span class="co">#&gt;  mgcv             1.8-35     2021-04-18 [2] CRAN (R 4.1.0)</span>
<span class="co">#&gt;  munsell          0.5.0      2018-06-12 [1] CRAN (R 4.1.0)</span>
<span class="co">#&gt;  nlme             3.1-152    2021-02-04 [2] CRAN (R 4.1.0)</span>
<span class="co">#&gt;  pillar           1.6.1      2021-05-16 [1] CRAN (R 4.1.0)</span>
<span class="co">#&gt;  pkgconfig        2.0.3      2019-09-22 [1] CRAN (R 4.1.0)</span>
<span class="co">#&gt;  pkgload          1.2.1      2021-04-06 [1] CRAN (R 4.1.0)</span>
<span class="co">#&gt;  png              0.1-7      2013-12-03 [1] CRAN (R 4.1.0)</span>
<span class="co">#&gt;  praise           1.0.0      2015-08-11 [1] CRAN (R 4.1.0)</span>
<span class="co">#&gt;  processx         3.5.2      2021-04-30 [1] CRAN (R 4.1.0)</span>
<span class="co">#&gt;  ps               1.6.0      2021-02-28 [1] CRAN (R 4.1.0)</span>
<span class="co">#&gt;  purrr            0.3.4      2020-04-17 [1] CRAN (R 4.1.0)</span>
<span class="co">#&gt;  R6               2.5.0      2020-10-28 [1] CRAN (R 4.1.0)</span>
<span class="co">#&gt;  RColorBrewer     1.1-2      2014-12-07 [1] CRAN (R 4.1.0)</span>
<span class="co">#&gt;  rematch2         2.1.2      2020-05-01 [1] CRAN (R 4.1.0)</span>
<span class="co">#&gt;  rlang            0.4.11     2021-04-30 [1] CRAN (R 4.1.0)</span>
<span class="co">#&gt;  rprojroot        2.0.2      2020-11-15 [1] CRAN (R 4.1.0)</span>
<span class="co">#&gt;  rstudioapi       0.13       2020-11-12 [1] CRAN (R 4.1.0)</span>
<span class="co">#&gt;  scales           1.1.1      2020-05-11 [1] CRAN (R 4.1.0)</span>
<span class="co">#&gt;  testthat         3.0.3      2021-06-16 [1] CRAN (R 4.1.0)</span>
<span class="co">#&gt;  tibble           3.1.2      2021-05-16 [1] CRAN (R 4.1.0)</span>
<span class="co">#&gt;  tidyselect       1.1.1      2021-04-30 [1] CRAN (R 4.1.0)</span>
<span class="co">#&gt;  utf8             1.2.1      2021-03-12 [1] CRAN (R 4.1.0)</span>
<span class="co">#&gt;  vctrs            0.3.8      2021-04-29 [1] CRAN (R 4.1.0)</span>
<span class="co">#&gt;  viridisLite      0.4.0      2021-04-13 [1] CRAN (R 4.1.0)</span>
<span class="co">#&gt;  waldo            0.2.5      2021-03-08 [1] CRAN (R 4.1.0)</span>
<span class="co">#&gt;  withr            2.4.2      2021-04-18 [1] CRAN (R 4.1.0)</span>
<span class="co">#&gt;  xml2             1.3.2      2020-04-23 [1] CRAN (R 4.1.0)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [1] /Users/runner/work/_temp/Library</span>
<span class="co">#&gt; [2] /Library/Frameworks/R.framework/Versions/4.1/Resources/library</span></code></pre></div>
</div>
<div id="references" class="section level1 unnumbered">
<h1 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h1>
<div id="refs" class="references">
<div id="ref-R-rgl">
<p>[1] D. Adler, D. Murdoch, Rgl: 3D visualization using opengl, 2021. <a href="https://CRAN.R-project.org/package=rgl">https://CRAN.R-project.org/package=rgl</a>.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Claudia Beleites, <a href="https://orcid.org/0000-0002-9500-5167">Vilmantas Gegzna</a>, Bryan Hanson, Roman Kiselev, Erick Oduniyi, Valter Sergo.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
