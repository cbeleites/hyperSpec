<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Plotting spectra — plotspc • hyperSpec</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cerulean/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



  <link href="../extra.css" rel="stylesheet">
  

<meta property="og:title" content="Plotting spectra — plotspc" />
<meta property="og:description" content="Plot the spectra of a hyperSpec object, i.e. intensity over
wavelength. Instead of the intensity values of the spectra matrix summary
values calculated from these may be used.
Usually, the stacked argument of plotspc() will do fine, but if you
need fine control over the stacking, you may calculate the y offsets yourself." />

<meta name="robots" content="noindex" />


<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">hyperSpec</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.100.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa-book"></span>
     
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-header">Documentation for version of package:</li>
    <li>
      <a href="https://cbeleites.github.io/hyperSpec/">Released</a>
    </li>
    <li>
      <a href="https://cbeleites.github.io/hyperSpec/dev/">In-development</a>
    </li>
  </ul>
</li>
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/hyperSpec.html">Get started</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/fileio.html">Import and Export Files with Spectra</a>
    </li>
    <li>
      <a href="../articles/plotting.html">Plotting Functions in "hyperSpec"</a>
    </li>
    <li>
      <a href="../articles/baseline.html">Fitting Baselines to Spectra</a>
    </li>
    <li class="divider"></li>
    <li>
      <a href="../articles/index.html">More...</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/r-hyperspec/hyperSpec/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Plotting spectra</h1>
    <small class="dont-index">Source: <a href='https://github.com/r-hyperspec/hyperSpec/blob/master/R/plotspc.R'><code>R/plotspc.R</code></a></small>
    <div class="hidden name"><code>plotspc.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Plot the spectra of a <code>hyperSpec</code> object, i.e. intensity over
wavelength. Instead of the intensity values of the spectra matrix summary
values calculated from these may be used.</p>
<p>Usually, the <code>stacked</code> argument of <code>plotspc()</code> will do fine, but if you
need fine control over the stacking, you may calculate the y offsets yourself.</p>
    </div>

    <pre class="usage"><span class='fu'>plotspc</span><span class='op'>(</span>
  <span class='va'>object</span>,
  wl.range <span class='op'>=</span> <span class='cn'>TRUE</span>,
  wl.index <span class='op'>=</span> <span class='cn'>FALSE</span>,
  wl.reverse <span class='op'>=</span> <span class='cn'>FALSE</span>,
  spc.nmax <span class='op'>=</span> <span class='fu'><a href='hy.getOptions.html'>hy.getOption</a></span><span class='op'>(</span><span class='st'>"plot.spc.nmax"</span><span class='op'>)</span>,
  func <span class='op'>=</span> <span class='cn'>NULL</span>,
  func.args <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='op'>)</span>,
  stacked <span class='op'>=</span> <span class='cn'>NULL</span>,
  stacked.args <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='op'>)</span>,
  add <span class='op'>=</span> <span class='cn'>FALSE</span>,
  bty <span class='op'>=</span> <span class='st'>"l"</span>,
  plot.args <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='op'>)</span>,
  col <span class='op'>=</span> <span class='st'>"black"</span>,
  lines.args <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='op'>)</span>,
  xoffset <span class='op'>=</span> <span class='fl'>0</span>,
  yoffset <span class='op'>=</span> <span class='fl'>0</span>,
  nxticks <span class='op'>=</span> <span class='fl'>10</span>,
  axis.args <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='op'>)</span>,
  break.args <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='op'>)</span>,
  title.args <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='op'>)</span>,
  fill <span class='op'>=</span> <span class='cn'>NULL</span>,
  fill.col <span class='op'>=</span> <span class='cn'>NULL</span>,
  border <span class='op'>=</span> <span class='cn'>NA</span>,
  polygon.args <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='op'>)</span>,
  zeroline <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>lty <span class='op'>=</span> <span class='fl'>2</span>, col <span class='op'>=</span> <span class='va'>col</span><span class='op'>)</span>,
  debuglevel <span class='op'>=</span> <span class='fu'><a href='hy.getOptions.html'>hy.getOption</a></span><span class='op'>(</span><span class='st'>"debuglevel"</span><span class='op'>)</span>
<span class='op'>)</span>

<span class='fu'>stacked.offsets</span><span class='op'>(</span>
  <span class='va'>x</span>,
  stacked <span class='op'>=</span> <span class='cn'>TRUE</span>,
  min.zero <span class='op'>=</span> <span class='cn'>FALSE</span>,
  add.factor <span class='op'>=</span> <span class='fl'>0.05</span>,
  add.sum <span class='op'>=</span> <span class='fl'>0</span>,
  .spc <span class='op'>=</span> <span class='cn'>NULL</span>,
  debuglevel <span class='op'>=</span> <span class='fu'><a href='hy.getOptions.html'>hy.getOption</a></span><span class='op'>(</span><span class='st'>"debuglevel"</span><span class='op'>)</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>object</th>
      <td><p>the <code>hyperSpec</code> object</p></td>
    </tr>
    <tr>
      <th>wl.range</th>
      <td><p>the wavelength range to be plotted.</p>
<p>Either a numeric vector or a list of vectors with different wavelength
ranges to be plotted separately.</p>
<p>The values can be either wavelengths or wavelength indices (according to
<code>wl.index</code>).</p></td>
    </tr>
    <tr>
      <th>wl.index</th>
      <td><p>if <code>TRUE</code>, <code>wl.range</code> is considered to give
column indices into the spectra matrix. Defaults to specifying wavelength
values rather than indices.</p></td>
    </tr>
    <tr>
      <th>wl.reverse</th>
      <td><p>if <code>TRUE</code>, the wavelength axis is plotted backwards.</p></td>
    </tr>
    <tr>
      <th>spc.nmax</th>
      <td><p>maximal number of spectra to be plotted (to avoid
accidentally plotting of large numbers of spectra).</p></td>
    </tr>
    <tr>
      <th>func</th>
      <td><p>a function to apply to each wavelength in order to calculate
summary spectra such as mean, min, max, etc.</p></td>
    </tr>
    <tr>
      <th>func.args</th>
      <td><p><code>list</code> with furter arguments for <code>func</code></p></td>
    </tr>
    <tr>
      <th>stacked</th>
      <td><p>if not <code>NULL</code>, a "stacked" plot is produced, see the
example. <code>stacked</code> may be <code>TRUE</code> to stack single spectra.  A
numeric or factor is interpreted as giving the grouping, character is
interpreted as the name of the extra data column that holds the groups.</p></td>
    </tr>
    <tr>
      <th>stacked.args</th>
      <td><p>a list with further arguments to
<code>stacked.offsets()</code>.</p></td>
    </tr>
    <tr>
      <th>add</th>
      <td><p>if <code>TRUE</code>, the output is added to the existing plot</p></td>
    </tr>
    <tr>
      <th>bty</th>
      <td><p>see <code><a href='https://rdrr.io/r/graphics/par.html'>graphics::par()</a></code></p></td>
    </tr>
    <tr>
      <th>plot.args</th>
      <td><p><code>list</code> with further arguments to
<code><a href='https://rdrr.io/r/graphics/plot.default.html'>graphics::plot()</a></code></p></td>
    </tr>
    <tr>
      <th>col</th>
      <td><p>see <code><a href='https://rdrr.io/r/graphics/par.html'>graphics::par()</a></code>. <code>col</code> might be a vector
giving individual colors for the spectra.</p></td>
    </tr>
    <tr>
      <th>lines.args</th>
      <td><p>list with further arguments to
<code><a href='https://rdrr.io/r/graphics/lines.html'>graphics::lines()</a></code>.</p>
<p><code>lines.args$type</code> defaults to "l".</p></td>
    </tr>
    <tr>
      <th>xoffset</th>
      <td><p>vector with abscissa offsets for each of the
<code>wl.range</code>s. If it has one element less than there are
<code>wl.range</code>s, 0 is padded at the beginning.</p>
<p>The values are interpreted as the distance along the wavelength axis that
the following parts of the spectra are shifted towards the origin. E.g.
if <code>wl.range = list (600 ~ 1800, 2800 ~ 3200)</code>, <code>xoffset = 750</code>
would result in a reasonable plot. See also the examples.</p></td>
    </tr>
    <tr>
      <th>yoffset</th>
      <td><p>ordinate offset values for the spectra. May be offsets to
stack the spectra (<code>stacked.offsets()</code>). Either one for all
spectra, one per spectrum or one per group in <code>stacked</code>.</p></td>
    </tr>
    <tr>
      <th>nxticks</th>
      <td><p>hint how many tick marks the abscissa should have.</p></td>
    </tr>
    <tr>
      <th>axis.args</th>
      <td><p><code>list</code> with further arguments for
<code><a href='https://rdrr.io/r/graphics/axis.html'>graphics::axis()</a></code>. <code>axis.args$x</code> should contain arguments
for plotting the abscissa, <code>axis.args$y</code> those for the ordinate
(again as <code>lists</code>).</p></td>
    </tr>
    <tr>
      <th>break.args</th>
      <td><p>list with arguments for
<code><a href='https://rdrr.io/pkg/plotrix/man/axis.break.html'>plotrix::axis.break()</a></code>.</p></td>
    </tr>
    <tr>
      <th>title.args</th>
      <td><p>list with further arguments to
<code><a href='https://rdrr.io/r/graphics/title.html'>graphics::title()</a></code>.</p>
<p><code>title.args</code> may contain two lists, <code>$x</code>, and <code>$y</code> to set
parameters individually for each axis.</p></td>
    </tr>
    <tr>
      <th>fill</th>
      <td><p>if not <code>NULL</code>, the area between the specified spectra is
filled with color <code>col</code>. The grouping can be given as factor or
numeric, or as a character with the name of the extra data column to use.
If a group contains more than 2 spectra, the first and the last are used.</p>
<p>If <code>TRUE</code> spectra n and nrow (spc) - n build a group.</p></td>
    </tr>
    <tr>
      <th>fill.col</th>
      <td><p>character vector with fill color. Defaults to brightened
colors from <code>col</code>.</p></td>
    </tr>
    <tr>
      <th>border</th>
      <td><p>character vector with border color. You will need to set the
line color <code>col</code> to <code>NA</code> in order see the effect.</p></td>
    </tr>
    <tr>
      <th>polygon.args</th>
      <td><p>list with further arguments to
<code><a href='https://rdrr.io/r/graphics/polygon.html'>graphics::polygon()</a></code> which draws the filled areas.</p></td>
    </tr>
    <tr>
      <th>zeroline</th>
      <td><p><code>NA</code> or a list with arguments
<code><a href='https://rdrr.io/r/graphics/abline.html'>graphics::abline()</a></code>, used to plot line (s) marking I = 0.</p>
<p><code>NA</code> suppresses plotting of the line.  The line is by default turned
off if <code>yoffset</code> is not 0.</p></td>
    </tr>
    <tr>
      <th>debuglevel</th>
      <td><p>if &gt; 0, additional debug output is produced,
see <code><a href='https://rdrr.io/r/base/options.html'>options()</a></code> for details</p></td>
    </tr>
    <tr>
      <th>x</th>
      <td><p>a <code>hyperSpec</code> object</p></td>
    </tr>
    <tr>
      <th>min.zero</th>
      <td><p>if <code>TRUE</code>, the lesser of zero and the minimum intensity of the spectrum is
used as minimum.</p></td>
    </tr>
    <tr>
      <th>add.factor, add.sum</th>
      <td><p>proportion and absolute amount of space that should be added.</p></td>
    </tr>
    <tr>
      <th>.spc</th>
      <td><p>for internal use. If given, the ranges are evaluated on <code>.spc</code>. However, this
may change in future.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p><code>plotspc</code> invisibly returns a list with</p>
<dt>x</dt><dd><p>the abscissa coordinates of the plotted spectral data points</p></dd>

<dt>y</dt><dd><p>a matrix the ordinate coordinates of the plotted spectral data
points</p></dd>

<dt>wavelengths</dt><dd><p>the wavelengths of the plotted spectral data points</p></dd>

This can be used together with <a href='spc.identify.html'>spc.identify()</a>.

a list containing <dt>offsets</dt><dd><p>numeric with the yoffset for each group in
<code>stacked</code></p></dd> <dt>groups</dt><dd><p>numeric with the group number for each spectrum</p></dd> <dt>levels</dt><dd><p>if
<code>stacked</code> is a factor, the levels of the groups</p></dd>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>This is <code>hyperSpec</code>'s main plotting function for spectra plots.</p>
<p>New plots are created by <code><a href='https://rdrr.io/r/graphics/plot.default.html'>graphics::plot()</a></code>, but the abscissa and
ordinate are drawn separately by <code><a href='https://rdrr.io/r/graphics/axis.html'>graphics::axis()</a></code>. Also,
<code><a href='https://rdrr.io/r/graphics/title.html'>graphics::title()</a></code> is called explicitly to set up titles and
axis labels. This allows fine-grained customization of the plots.</p>
<p>If package plotrix is available, its function
<code><a href='https://rdrr.io/pkg/plotrix/man/axis.break.html'>plotrix::axis.break()</a></code> is used to produce break marks for cut
wavelength axes.</p>
<p>Empty levels of the stacking factor are dropped (as no stacking offset can be calculated in that
case.)</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='https://rdrr.io/r/graphics/plot.default.html'>graphics::plot()</a></code>, <code><a href='https://rdrr.io/r/graphics/axis.html'>graphics::axis()</a></code>,
<code><a href='https://rdrr.io/r/graphics/title.html'>graphics::title()</a></code>, <code><a href='https://rdrr.io/r/graphics/lines.html'>graphics::lines()</a></code>,
<code><a href='https://rdrr.io/r/graphics/polygon.html'>graphics::polygon()</a></code>, <code><a href='https://rdrr.io/r/graphics/par.html'>graphics::par()</a></code> for the
description of the respective arguments.</p>
<p><code><a href='https://rdrr.io/pkg/plotrix/man/axis.break.html'>plotrix::axis.break()</a></code> for cut marks</p>
<p>See <code><a href='plot-methods.html'>plot()</a></code> for some predefined spectra plots such as mean
spectrum +/- one standard deviation and the like.</p>
<p><code><a href='https://rdrr.io/r/graphics/identify.html'>graphics::identify()</a></code> and <code><a href='https://rdrr.io/r/graphics/locator.html'>graphics::locator()</a></code> about
interaction with plots.</p>
<p><code>plotspc()</code></p></div>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>C. Beleites</p>
<p>C. Beleites</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='fu'>plotspc</span><span class='op'>(</span><span class='va'>flu</span><span class='op'>)</span>
</div><div class='img'><img src='plotspc-1.png' alt='' width='466' height='288' /></div><div class='input'>
<span class='co'>## artificial example to show wavelength axis cutting</span>
<span class='fu'>plotspc</span><span class='op'>(</span><span class='va'>faux_cell</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/sample.html'>sample</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>faux_cell</span><span class='op'>)</span>, <span class='fl'>50</span><span class='op'>)</span><span class='op'>]</span>,
  wl.range <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='fl'>600</span> <span class='op'>~</span> <span class='fl'>650</span>, <span class='fl'>1000</span> <span class='op'>~</span> <span class='fl'>1100</span>, <span class='fl'>1600</span> <span class='op'>~</span> <span class='fl'>1700</span><span class='op'>)</span>,
  xoffset <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>300</span>, <span class='fl'>450</span><span class='op'>)</span>
<span class='op'>)</span>
</div><div class='img'><img src='plotspc-2.png' alt='' width='466' height='288' /></div><div class='input'>
<span class='fu'>plotspc</span><span class='op'>(</span><span class='va'>faux_cell</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/sample.html'>sample</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>faux_cell</span><span class='op'>)</span>, <span class='fl'>50</span><span class='op'>)</span><span class='op'>]</span>,
  wl.range <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='fl'>600</span> <span class='op'>~</span> <span class='fl'>650</span>, <span class='fl'>1000</span> <span class='op'>~</span> <span class='fl'>1100</span>, <span class='fl'>1600</span> <span class='op'>~</span> <span class='fl'>1700</span><span class='op'>)</span>,
  xoffset <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>300</span>, <span class='fl'>450</span><span class='op'>)</span>
<span class='op'>)</span>
</div><div class='img'><img src='plotspc-3.png' alt='' width='466' height='288' /></div><div class='input'>
<span class='co'>## some journals publish Raman spectra backwards</span>
<span class='fu'>plotspc</span><span class='op'>(</span><span class='va'>faux_cell</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/sample.html'>sample</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>faux_cell</span><span class='op'>)</span>, <span class='fl'>50</span><span class='op'>)</span><span class='op'>]</span>, wl.reverse <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
</div><div class='img'><img src='plotspc-4.png' alt='' width='466' height='288' /></div><div class='input'>
<span class='fu'>plotspc</span><span class='op'>(</span><span class='va'>laser</span><span class='op'>[</span><span class='op'>(</span><span class='fl'>0</span><span class='op'>:</span><span class='fl'>4</span><span class='op'>)</span> <span class='op'>*</span> <span class='fl'>20</span> <span class='op'>+</span> <span class='fl'>1</span>, , <span class='op'>]</span>, stacked <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
</div><div class='img'><img src='plotspc-5.png' alt='' width='466' height='288' /></div><div class='input'>
<span class='fu'>plotspc</span><span class='op'>(</span><span class='va'>laser</span>,
  func <span class='op'>=</span> <span class='va'>mean_pm_sd</span>,
  col <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='cn'>NA</span>, <span class='st'>"red"</span>, <span class='st'>"black"</span><span class='op'>)</span>, lines.args <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>lwd <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span>,
  fill <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='cn'>NA</span>, <span class='fl'>1</span><span class='op'>)</span>,
  fill.col <span class='op'>=</span> <span class='st'>"yellow"</span>, border <span class='op'>=</span> <span class='st'>"blue"</span>,
  polygon.args <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>lty <span class='op'>=</span> <span class='fl'>2</span>, lwd <span class='op'>=</span> <span class='fl'>4</span><span class='op'>)</span>,
  title.args <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>
    xlab <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/expression.html'>expression</a></span><span class='op'>(</span><span class='va'>lambda</span><span class='op'>[</span><span class='va'>emission</span><span class='op'>]</span> <span class='op'>/</span> <span class='va'>nm</span><span class='op'>)</span>,
    y <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>line <span class='op'>=</span> <span class='fl'>3.4</span><span class='op'>)</span>,
    col.lab <span class='op'>=</span> <span class='st'>"darkgreen"</span>
  <span class='op'>)</span>,
  axis.args <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>col <span class='op'>=</span> <span class='st'>"magenta"</span><span class='op'>)</span>, y <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>las <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span>
<span class='op'>)</span>
</div><div class='img'><img src='plotspc-6.png' alt='' width='466' height='288' /></div><div class='input'>
<span class='va'>mean.pm.sd</span> <span class='op'>&lt;-</span> <span class='fu'><a href='aggregate.html'>aggregate</a></span><span class='op'>(</span><span class='va'>faux_cell</span>, <span class='va'>faux_cell</span><span class='op'>$</span><span class='va'>region</span>, <span class='va'>mean_pm_sd</span><span class='op'>)</span>
<span class='fu'><a href='plot-methods.html'>plot</a></span><span class='op'>(</span><span class='va'>mean.pm.sd</span>, col <span class='op'>=</span> <span class='fu'><a href='palette_matlab.html'>palette_matlab</a></span><span class='op'>(</span><span class='fl'>3</span><span class='op'>)</span>, fill <span class='op'>=</span> <span class='st'>".aggregate"</span>, stacked <span class='op'>=</span> <span class='st'>".aggregate"</span><span class='op'>)</span>
</div><div class='img'><img src='plotspc-7.png' alt='' width='466' height='288' /></div><div class='input'>
<span class='va'>mean.pm.sd</span> <span class='op'>&lt;-</span> <span class='fu'><a href='aggregate.html'>aggregate</a></span><span class='op'>(</span><span class='va'>faux_cell</span>, <span class='va'>faux_cell</span><span class='op'>$</span><span class='va'>region</span>, <span class='va'>mean_pm_sd</span><span class='op'>)</span>

<span class='va'>offset</span> <span class='op'>&lt;-</span> <span class='fu'>stacked.offsets</span><span class='op'>(</span><span class='va'>mean.pm.sd</span>, <span class='st'>".aggregate"</span><span class='op'>)</span>
<span class='fu'><a href='plot-methods.html'>plot</a></span><span class='op'>(</span><span class='va'>mean.pm.sd</span>,
  fill.col <span class='op'>=</span> <span class='fu'><a href='palette_matlab.html'>palette_matlab</a></span><span class='op'>(</span><span class='fl'>3</span><span class='op'>)</span>, fill <span class='op'>=</span> <span class='st'>".aggregate"</span>,
  stacked <span class='op'>=</span> <span class='st'>".aggregate"</span>
<span class='op'>)</span>
</div><div class='input'>
<span class='fu'><a href='plot-methods.html'>plot</a></span><span class='op'>(</span><span class='fu'><a href='aggregate.html'>aggregate</a></span><span class='op'>(</span><span class='va'>faux_cell</span>, <span class='va'>faux_cell</span><span class='op'>$</span><span class='va'>region</span>, <span class='va'>mean</span><span class='op'>)</span>,
  yoffset <span class='op'>=</span> <span class='va'>offset</span><span class='op'>$</span><span class='va'>offsets</span>,
  lines.args <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>lty <span class='op'>=</span> <span class='fl'>2</span>, lwd <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span>, add <span class='op'>=</span> <span class='cn'>TRUE</span>
<span class='op'>)</span>
</div><div class='img'><img src='plotspc-8.png' alt='' width='466' height='288' /></div><div class='input'>
<span class='va'>barb</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/do.call.html'>do.call</a></span><span class='op'>(</span><span class='va'>collapse</span>, <span class='va'>barbiturates</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>3</span><span class='op'>]</span><span class='op'>)</span>
<span class='fu'><a href='plot-methods.html'>plot</a></span><span class='op'>(</span><span class='va'>barb</span>,
  lines.args <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>type <span class='op'>=</span> <span class='st'>"h"</span><span class='op'>)</span>, stacked <span class='op'>=</span> <span class='cn'>TRUE</span>,
  stacked.args <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>add.factor <span class='op'>=</span> <span class='fl'>.2</span><span class='op'>)</span>
<span class='op'>)</span>
</div><div class='img'><img src='plotspc-9.png' alt='' width='466' height='288' /></div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Claudia Beleites, <a href='https://orcid.org/0000-0002-9500-5167'>Vilmantas Gegzna</a>, Bryan Hanson, Roman Kiselev, Erick Oduniyi, Valter Sergo.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


