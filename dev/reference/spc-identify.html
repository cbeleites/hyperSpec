<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Identifying Spectra and Spectral Data Points
This function allows to identify the spectrum and the wavelength of a point
in a plot produced by <code>plotspc</code>. — spc.identify • hyperSpec</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cerulean/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



  <link href="../extra.css" rel="stylesheet">
  

<meta property="og:title" content="Identifying Spectra and Spectral Data Points
This function allows to identify the spectrum and the wavelength of a point
in a plot produced by <code>plotspc</code>. — spc.identify" />
<meta property="og:description" content="This function first finds the spectrum with a point closest to the clicked
position (see locator). The distance to the clicked
point is evaluated relative to the size of the tolerance window." />

<meta name="robots" content="noindex" />
<meta name="robots" content="noindex">

<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">hyperSpec</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="In-development version">0.99-20200615</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa-book"></span>
     
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-header">Documentation for version of package:</li>
    <li>
      <a href="https://cbeleites.github.io/hyperSpec/">Released</a>
    </li>
    <li>
      <a href="https://cbeleites.github.io/hyperSpec/dev/">In-development</a>
    </li>
  </ul>
</li>
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/hyperSpec.html">Get started</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/fileio.html">Import and Export Files with Spectra</a>
    </li>
    <li>
      <a href="../articles/plotting.html">Plotting Functions in "hyperSpec"</a>
    </li>
    <li>
      <a href="../articles/baseline.html">Fitting Baselines to Spectra</a>
    </li>
    <li class="divider"></li>
    <li>
      <a href="../articles/index.html">More...</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/cbeleites/hyperSpec/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Identifying Spectra and Spectral Data Points
This function allows to identify the spectrum and the wavelength of a point
in a plot produced by <code>plotspc</code>.</h1>
    <small class="dont-index">Source: <a href='https://github.com/cbeleites/hyperSpec/blob/master/R/spc.identify.R'><code>R/spc.identify.R</code></a></small>
    <div class="hidden name"><code>spc-identify.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function first finds the spectrum with a point closest to the clicked
position (see <code><a href='https://rdrr.io/r/graphics/locator.html'>locator</a></code>). The distance to the clicked
point is evaluated relative to the size of the tolerance window.</p>
    </div>

    <pre class="usage"><span class='fu'>spc.identify</span>(
  <span class='kw'>x</span>,
  y = <span class='kw'>NULL</span>,
  wavelengths = <span class='kw'>NULL</span>,
  ispc = <span class='kw'>NULL</span>,
  tol.wl = <span class='fu'><a href='https://rdrr.io/r/base/diff.html'>diff</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/range.html'>range</a></span>(<span class='kw'>x</span>))<span class='op'>/</span><span class='fl'>200</span>,
  tol.spc = <span class='fu'><a href='https://rdrr.io/r/base/diff.html'>diff</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/range.html'>range</a></span>(<span class='kw'>y</span>))<span class='op'>/</span><span class='fl'>50</span>,
  point.fn = <span class='kw'>spc.point.max</span>,
  formatter = <span class='kw'>spc.label.default</span>,
  <span class='kw'>...</span>,
  cex = <span class='fl'>0.7</span>,
  adj = <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>0</span>, <span class='fl'>0.5</span>),
  srt = <span class='fl'>90</span>,
  warn = <span class='fl'>TRUE</span>
)

<span class='fu'>spc.point.max</span>(<span class='kw'>wl</span>, <span class='kw'>spc</span>, <span class='kw'>wlclick</span>)

<span class='fu'>spc.point.default</span>(<span class='kw'>wl</span>, <span class='kw'>spc</span>, <span class='kw'>wlclick</span>)

<span class='fu'>spc.point.min</span>(<span class='kw'>wl</span>, <span class='kw'>spc</span>, <span class='kw'>wlclick</span>)

<span class='fu'>spc.point.sqr</span>(<span class='kw'>wl</span>, <span class='kw'>spc</span>, <span class='kw'>wlclick</span>, delta = <span class='fl'>1L</span>)

<span class='fu'>spc.label.default</span>(<span class='kw'>ispc</span>, <span class='kw'>wl</span>, <span class='kw'>spc</span>, digits = <span class='fl'>3</span>)

<span class='fu'>spc.label.wlonly</span>(<span class='kw'>ispc</span>, <span class='kw'>wl</span>, <span class='kw'>spc</span>, digits = <span class='fl'>3</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>either the abscissa coordinates or the list returned by
<code>plotspc</code></p></td>
    </tr>
    <tr>
      <th>y</th>
      <td><p>the ordinate values. Giving <code>y</code> will override any values from
<code>x$y</code>.</p></td>
    </tr>
    <tr>
      <th>wavelengths</th>
      <td><p>the wavelengths for the data points. Giving
<code>wavelengths</code> will override any values from <code>x$wavelengths</code>.</p></td>
    </tr>
    <tr>
      <th>ispc</th>
      <td><p>if a selection of spectra was plotted, their indices can be
given in <code>ispc</code>. In this case <code>ispc [i]</code> is returned rather
than <code>i</code>.</p></td>
    </tr>
    <tr>
      <th>tol.wl, tol.spc</th>
      <td><p>tolerance in wavelength and spectral intensity to
search around the clicked point. See details.</p></td>
    </tr>
    <tr>
      <th>point.fn</th>
      <td><p><code>function (wl, spc, wlclick)</code> to determine the actual
point to label, see details.</p></td>
    </tr>
    <tr>
      <th>formatter</th>
      <td><p><code>function (i, wl, spc)</code> that produces the labels. If
<code>NULL</code>, no labels are displayed.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>passed to <code><a href='https://rdrr.io/r/graphics/text.html'>text</a></code> in order to produce the
labels</p></td>
    </tr>
    <tr>
      <th>cex, adj, srt</th>
      <td><p>see <code><a href='https://rdrr.io/r/graphics/par.html'>par</a></code></p></td>
    </tr>
    <tr>
      <th>warn</th>
      <td><p>Should the user be warned if no point is in the considered
  window? In addition, see the discussion of option <code>debuglevel</code> in
  the details.</p>
<p>If <code>FALSE</code>, the resulting data.frame will have a row of <code>NA</code>s
  instead.</p></td>
    </tr>
    <tr>
      <th>wl</th>
      <td><p>the wavelength to label</p></td>
    </tr>
    <tr>
      <th>spc</th>
      <td><p>the intensity to label</p></td>
    </tr>
    <tr>
      <th>wlclick</th>
      <td><p>the clicked wavelength</p></td>
    </tr>
    <tr>
      <th>delta</th>
      <td><p><code>spc.point.sqr</code> fits the parabola in the window wlclick
\(\pm\) delta points.</p></td>
    </tr>
    <tr>
      <th>digits</th>
      <td><p>how many digits of the wavelength should be displayed?</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>a <code>data.frame</code> with columns</p>
<dt>ispc</dt><dd><p>spectra indices of the
  identified points, i.e. the rows of the <code>hyperSpec</code> object that was
  plotted.If <code>ispc</code> is given, <code>ispc [i]</code> is returned rather than <code>i</code>.</p></dd> <dt>wavelengths</dt><dd><p>the wavelengths of the identified points</p></dd>
  <dt>spc</dt><dd><p>the intensities of the identified points</p></dd>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>In a second step, <code>max.fn</code> searches for the actual point to label
within the specified wavelength window of that spectrum. This allows to
label maxima (or minima) without demanding too precise clicks. Currently,
the following functions to determine the precise point:</p><table class='table'>
<tr><td>spc.point.default</td><td>uses the clicked wavelength together with its
spectral intensity</td></tr>
<tr><td>spc.point.max</td><td>the point with the highest
intensity in the wavelength window</td></tr>
<tr><td>spc.point.min</td><td>the point with
the lowest intensity in the wavelength window</td></tr>
<tr><td>spc.point.sqr</td><td>maximum of a parabola fit throug the point with highest intensity and the
two surrounding points</td></tr>
</table>
<p><code>point.fn</code> is called with the arguments
<code>wl</code> containing the considered wavelength window, <code>spc</code> the
respective intensities of the closest spectrum, and <code>wlclick</code> the
wavelength that was clicked. They return a vector of two elements
(wavelength and intensity).</p>
<p>As a last step, a label for the point produced by <code>formatter</code> and
plotted using <code><a href='https://rdrr.io/r/graphics/text.html'>text</a></code>. Currently, the following
<code>formatter</code>s are available:</p><table class='table'>
<tr><td>spc.label.default</td><td>spectrum number, wavelength</td></tr>
<tr><td>spc.label.wlonly</td><td>wavelength</td></tr>
</table>
<p><code>formatter</code> functions receive the number of the spectrum <code>ispc</code>,
the wavelength <code>wl</code>, and the spectral intensity <code>spc</code> and produce
a character variable suitable for labelling. The predefined formatters
surround the label text by spaces in order to easily have an appropriate
offset from the point of the spectrum.</p>
<p>The warning issued if no spectral point is inside the tolerance window may
be switched of by <code>warn = FALSE</code>. In that case, the click will produce
a row of <code>NA</code>s in the resulting data.frame.</p>
<p><code>spc.identify</code> uses option <code>debuglevel</code> to determine whether debugging output should be
produced. <code>debuglevel == 2</code> will plot the tolerance window for every clicked point,
<code>debuglevel == 1</code> will plot the tolerance window only if no data point was inside.  See
<code>hyperSpec options</code> for details about retrieving and setting
options.</p>
<p>You may want to adjust the plot's <code>ylim</code> to ensure that the labels are
not clipped. As a dirty shortcut, <code>xpd = NA</code> may help.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='https://rdrr.io/r/graphics/locator.html'>locator</a></code>, <code>plotspc</code>,
  <code>hyperSpec options</code></p>
<p><code>map.identify</code> <code>map.sel.poly</code></p></div>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>C. Beleites</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='co'>if</span> (<span class='fu'><a href='https://rdrr.io/r/base/interactive.html'>interactive</a></span> ()){
<span class='kw'>ispc</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/sample.html'>sample</a></span> (<span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span> (<span class='kw'>laser</span>), <span class='fl'>10</span>)
<span class='kw'>ispc</span>

<span class='kw'>identified</span> <span class='op'>&lt;-</span> <span class='fu'>spc.identify</span> (<span class='fu'>plotspc</span> (<span class='kw'>laser</span>[<span class='kw'>ispc</span>]))

<span class='co'>## convert to the "real" spectra indices</span>
<span class='kw'>ispc</span> [<span class='kw'>identified</span><span class='op'>$</span><span class='kw'>ispc</span>]
<span class='kw'>identified</span><span class='op'>$</span><span class='kw'>wl</span>
<span class='kw'>identified</span><span class='op'>$</span><span class='kw'>spc</span>

<span class='co'>## allow the labels to be plotted into the plot margin</span>
<span class='fu'>spc.identify</span> (<span class='fu'>plotspc</span> (<span class='kw'>laser</span>[<span class='kw'>ispc</span>]), ispc = <span class='kw'>ispc</span>, xpd = <span class='fl'>NA</span>)

<span class='fu'>spc.identify</span> (<span class='fu'>plotspc</span> (<span class='kw'>paracetamol</span>, xoffset = <span class='fl'>1100</span>,
              wl.range = <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span> (<span class='fl'>600</span> <span class='op'>~</span> <span class='fl'>1700</span>, <span class='fl'>2900</span> <span class='op'>~</span> <span class='fl'>3150</span>)),
              formatter = <span class='kw'>spc.label.wlonly</span>)

<span class='co'>## looking for minima</span>
<span class='fu'>spc.identify</span> (<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span> (<span class='op'>-</span><span class='kw'>paracetamol</span>, wl.reverse = <span class='fl'>TRUE</span>),
              point.fn = <span class='kw'>spc.point.min</span>, adj = <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span> (<span class='fl'>1</span>, <span class='fl'>0.5</span>))

}
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Claudia Beleites, Valter Sergo.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.9000.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


