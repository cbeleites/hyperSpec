<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Plotting Functions in "hyperSpec" • hyperSpec</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cerulean/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Plotting Functions in " hyperspec>
<meta property="og:description" content="plotting: Manual of hyperSpec's plotting functions">
<meta name="robots" content="noindex">
<meta name="robots" content="noindex">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">hyperSpec</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="In-development version">0.99-20200615</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa-book"></span>
     
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li class="dropdown-header">Documentation for version of package:</li>
    <li>
      <a href="https://cbeleites.github.io/hyperSpec/">Released</a>
    </li>
    <li>
      <a href="https://cbeleites.github.io/hyperSpec/dev/">In-development</a>
    </li>
  </ul>
</li>
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/hyperSpec.html">Get started</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/fileio.html">Import and Export Files with Spectra</a>
    </li>
    <li>
      <a href="../articles/plotting.html">Plotting Functions in "hyperSpec"</a>
    </li>
    <li>
      <a href="../articles/baseline.html">Fitting Baselines to Spectra</a>
    </li>
    <li class="divider">
    <li>
      <a href="../articles/index.html">More...</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/cbeleites/hyperSpec/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="plotting_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Plotting Functions in “hyperSpec”</h1>
                        <h4 class="author">Claudia Beleites<sup>1,2,3,4,5</sup>, Vilmantas Gegzna</h4>
            <address class="author_afil">
      <ol style="list-style-type: decimal">
<li>DIA Raman Spectroscopy Group, University of Trieste/Italy (2005–2008)</li>
      <li>Spectroscopy <span class="math inline">\(\cdot\)</span> Imaging, IPHT, Jena/Germany (2008–2017)</li>
      <li>ÖPV, JKI, Berlin/Germany (2017–2019)</li>
      <li>Arbeitskreis Lebensmittelmikrobiologie und Biotechnologie, Hamburg University, Hamburg/Germany (2019 – 2020)</li>
      <li>Chemometric Consulting and Chemometrix GmbH, Wölfersheim/Germany (since 2016)</li>
      </ol>
<br><a class="author_email" href="mailto:#"></a><a href="mailto:chemometrie@beleites.de" class="email">chemometrie@beleites.de</a>
      </address>
                  
            <h4 class="date">2020-07-05</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/cbeleites/hyperSpec/blob/master/../vignettes/plotting.Rmd"><code>../vignettes/plotting.Rmd</code></a></small>
      <div class="hidden name"><code>plotting.Rmd</code></div>

    </div>

    
    
<pre><code>#&gt; tweaking rgl</code></pre>
<div id="suggested-packages-and-setup" class="section level1 unnumbered">
<h1 class="hasAnchor">
<a href="#suggested-packages-and-setup" class="anchor"></a>Suggested Packages and Setup</h1>
<div class="note">
<p>
<strong>Reproducing the examples in this vignette.</strong>
</p>
<p>
All spectra used in this manual are installed automatically with package <strong>hyperSpec</strong>.
</p>
</div>
<hr>
<blockquote>
<p><strong>Terminology</strong>
Throughout the documentation of the package, the following terms are used:</p>
<ul>
<li>
<strong>wavelength</strong> indicates any type of spectral abscissa.</li>
<li>
<strong>intensity</strong> indicates any type of spectral ordinate.</li>
<li>
<strong>extra data</strong> indicates non-spectroscopic data.</li>
</ul>
</blockquote>
<div class="sourceCode" id="cb2"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="kw"><a href="https://cbeleites.github.io/hyperSpec">hyperSpec</a></span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="kw"><a href="http://latticeextra.r-forge.r-project.org">latticeExtra</a></span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="kw">deldir</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="kw"><a href="http://ggplot2.tidyverse.org">ggplot2</a></span>)
<span class="co"># library(rgl)</span>

<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(mar = <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">4.1</span>, <span class="fl">4.1</span>, <span class="fl">1</span>, <span class="fl">.6</span>))

<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="fl">2020</span>)
</pre></div>
<p>Besides, package <strong>tripack</strong><span class="citation">[<a href="#ref-tripack" role="doc-biblioref">1</a>]</span> is mentioned, but not used in this vignette.</p>
</div>
<div id="preliminary-calculations" class="section level1 unnumbered">
<h1 class="hasAnchor">
<a href="#preliminary-calculations" class="anchor"></a>Preliminary Calculations</h1>
<p>For some plots of the <code class="sourceCode r">chondro</code> dataset, the pre-processed spectra and their cluster averages <span class="math inline">\(\pm\)</span> one standard deviation are more suitable:</p>
<div class="sourceCode" id="cb3"><pre class="downlit">
<span class="kw">chondro</span> <span class="op">&lt;-</span> <span class="kw">hyperSpec</span>::<span class="kw"><a href="../reference/chondro.html">chondro</a></span>

<span class="kw">chondro.preproc</span> <span class="op">&lt;-</span> <span class="kw">chondro</span> <span class="op">-</span> <span class="fu"><a href="../reference/spc.fit.poly.html">spc.fit.poly.below</a></span>(<span class="kw">chondro</span>)
<span class="kw">chondro.preproc</span> <span class="op">&lt;-</span> <span class="kw">chondro.preproc</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html">rowMeans</a></span>(<span class="kw">chondro</span>)
<span class="kw">chondro.preproc</span> <span class="op">&lt;-</span> <span class="kw">chondro.preproc</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span>(<span class="kw">chondro.preproc</span>, <span class="fl">0.05</span>)

<span class="kw">cluster.cols</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"dark blue"</span>, <span class="st">"orange"</span>, <span class="st">"#C02020"</span>)
<span class="kw">cluster.meansd</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/aggregate.html">aggregate</a></span>(<span class="kw">chondro.preproc</span>, <span class="kw">chondro</span><span class="op">$</span><span class="kw">clusters</span>, <span class="kw">mean_pm_sd</span>)
<span class="kw">cluster.means</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/aggregate.html">aggregate</a></span>(<span class="kw">chondro.preproc</span>, <span class="kw">chondro</span><span class="op">$</span><span class="kw">clusters</span>, <span class="kw">mean</span>)
</pre></div>
<p>For details about the pre-processing, please refer to the example workflow in <code><a href="../articles/chondro.html">vignette("chondro")</a></code>, or the help <code><a href="../reference/chondro.html">?chondro</a></code>.</p>
</div>
<div id="predefined-functions" class="section level1">
<h1 class="hasAnchor">
<a href="#predefined-functions" class="anchor"></a><span class="header-section-number">1</span> Predefined Functions</h1>
<p>Package <strong>hyperSpec</strong> comes with 6 major predefined plotting functions:</p>
<dl>
<dt><strong><code class="sourceCode r"><span class="kw">plot</span>()</code></strong></dt>
<dd>main switchyard for most plotting tasks.
More details in section <a href="#fun-plot">2</a>.
</dd>
<dt><strong><code class="sourceCode r"><span class="kw">plotspc</span>()</code></strong></dt>
<dd>plots spectra.
More details in sections <a href="#exm-plotspc">1.1</a>, <a href="#arg-spc">2.1</a>, and <a href="#fun-plotspc">3</a>.
</dd>
<dt><strong><code class="sourceCode r"><span class="kw">plotc</span>()</code></strong></dt>
<dd>calibration plot, time series, depth profile.
More details in sections <a href="#exm-plotc">1.3</a>, <a href="#arg-c">2.5</a>, <a href="#arg-ts">2.6</a>, <a href="#arg-depth">2.7</a>, and <a href="#fun-plotc">4</a>.
(<code class="sourceCode r"><span class="kw">plotc</span>()</code> is a package <strong>lattice</strong> function)
</dd>
<dt><strong><code class="sourceCode r"><span class="kw">levelplot</span>()</code></strong></dt>
<dd>package <strong>hyperSpec</strong> has a method for package <strong>lattice</strong><span class="citation">[<a href="#ref-lattice" role="doc-biblioref">2</a>]</span> function <code class="sourceCode r"><span class="kw">levelplot</span>()</code>.
More details in sections <a href="#exm-levelplot">1.4</a>, and <a href="#fun-levelplot">5</a>.
</dd>
<dt><strong><code class="sourceCode r"><span class="kw">plotmat</span>()</code></strong></dt>
<dd>plots the spectra matrix.
More details in sections <a href="#exm-plotmat">1.2</a>, <a href="#arg-mat">2.8</a>, and <a href="#fun-plotmat">6</a>.
</dd>
<dt><strong><code class="sourceCode r"><span class="kw">plotmap</span>()</code></strong></dt>
<dd>more specialized version of <code class="sourceCode r"><span class="kw">levelplot</span>()</code> for map or image plots.
More details in sections <a href="#exm-plotmap">1.5</a>, <a href="#arg-map">2.9</a>, and <a href="#fun-plotmap">7</a>.
(<code class="sourceCode r"><span class="kw">plotmap</span>()</code> is a package <strong>lattice</strong> function)
</dd>
<dt><strong><code class="sourceCode r"><span class="kw">plotvoronoi</span>()</code></strong></dt>
<dd>more specialized version of <code class="sourceCode r"><span class="kw">plotmap</span>()</code> that produces Voronoi tesselations.
More details in sections <a href="#exm-plotvoronoi">1.6</a>, and <a href="#arg-voronoi">2.10</a>.
(<code class="sourceCode r"><span class="kw">plotvoronoi</span>()</code> is a package <strong>lattice</strong> function)
</dd>
</dl>
<div class="note">
<p>
<strong>NOTE.</strong> Functions <code class="sourceCode r"><span class="kw">plotmap</span>()</code>, <code class="sourceCode r"><span class="kw">plotvoronoi</span>()</code>, and <code class="sourceCode r"><span class="kw">levelplot</span>()</code> are package <strong>lattice</strong> functions. Therefore, in loops, functions, R Markdown chunks, etc. lattice objects need to be printed explicitly by, e.g., <code class="sourceCode r"><span class="kw">print</span>(<span class="kw">plotmap</span>(object))</code> (<a href="http://cran.r-project.org/doc/FAQ/R-FAQ.html#Why-do-lattice_002ftrellis-graphics-not-work_003f">R FAQ: Why do lattice/trellis graphics not work?</a>).
</p>
</div>
<div id="exm-plotspc" class="section level2">
<h2 class="hasAnchor">
<a href="#exm-plotspc" class="anchor"></a><span class="header-section-number">1.1</span> Function <code class="sourceCode r"><span class="kw">plotspc</span>()</code>
</h2>
<p>Function <code class="sourceCode r"><span class="kw">plotspc</span>()</code> plots the spectra (Fig. <a href="#fig:plotspc">1.1</a>), i.e., the intensities (<code class="sourceCode r"><span class="op">$</span>spc</code>) over the wavelengths (<code class="sourceCode r"><span class="op">@</span>wavelength</code>).</p>
<div class="sourceCode" id="cb4"><pre class="downlit">
<span class="fu"><a href="../reference/plotspc.html">plotspc</a></span>(<span class="kw">flu</span>)
</pre></div>
<div class="figure" style="text-align: center">
<span id="fig:plotspc"></span>
<img src="plotting_files/figure-html/plotspc-1.png" alt="Spectra in dataset `flu`.  "><p class="caption">
Figure 1.1: Spectra in dataset <code>flu</code>.
</p>
</div>
</div>
<div id="exm-plotmat" class="section level2">
<h2 class="hasAnchor">
<a href="#exm-plotmat" class="anchor"></a><span class="header-section-number">1.2</span> Function <code class="sourceCode r"><span class="kw">plotmat</span>()</code>
</h2>
<p>Function <code class="sourceCode r"><span class="kw">plotmat</span>()</code> plots the spectra, i.e., the colour coded intensities (<code class="sourceCode r"><span class="op">$</span>spc</code>) over the wavelengths (<code class="sourceCode r"><span class="op">@</span>wavelength</code>) and the row number (Fig. <a href="#fig:plotmat-flu">1.2</a>).</p>
<div class="sourceCode" id="cb5"><pre class="downlit">
<span class="fu"><a href="../reference/plotmat.html">plotmat</a></span>(<span class="kw">flu</span>)
</pre></div>
<div class="figure" style="text-align: center">
<span id="fig:plotmat-flu"></span>
<img src="plotting_files/figure-html/plotmat-flu-1.png" alt="Matrix of spectra: the colour coded intensities over the wavelengths and the row number.  "><p class="caption">
Figure 1.2: Matrix of spectra: the colour coded intensities over the wavelengths and the row number.
</p>
</div>
</div>
<div id="exm-plotc" class="section level2">
<h2 class="hasAnchor">
<a href="#exm-plotc" class="anchor"></a><span class="header-section-number">1.3</span> Function <code class="sourceCode r"><span class="kw">plotc</span>()</code>
</h2>
<p>Function <code class="sourceCode r"><span class="kw">plotc</span>()</code> plots an intensity over a single other data column, e.g., concentration (calibration plot, e.g., Fig. <a href="#fig:plotflu">1.3</a>), depth (depth profile plot), or time (time series plot).</p>
<div class="sourceCode" id="cb6"><pre class="downlit">
<span class="fu"><a href="../reference/plotc.html">plotc</a></span>(<span class="kw">flu</span>)
<span class="co">#&gt; Warning in plotc(flu): Intensity at first wavelengh only is used.</span>
</pre></div>
<div class="figure" style="text-align: center">
<span id="fig:plotflu"></span>
<img src="plotting_files/figure-html/plotflu-1.png" alt="Calibration plot: an intensity over concentration.  "><p class="caption">
Figure 1.3: Calibration plot: an intensity over concentration.
</p>
</div>
<blockquote>
<p>The following warning is expected: <code>Intensity at first wavelengh only is used.</code></p>
</blockquote>
</div>
<div id="exm-levelplot" class="section level2">
<h2 class="hasAnchor">
<a href="#exm-levelplot" class="anchor"></a><span class="header-section-number">1.4</span> Function <code class="sourceCode r"><span class="kw">levelplot</span>()</code>
</h2>
<p>Function <code class="sourceCode r"><span class="kw">levelplot</span>()</code> plots a false colour map, defined by a formula (Fig. <a href="#fig:levelplot">5.1</a>).</p>
<div class="sourceCode" id="cb7"><pre class="downlit">
<span class="fu">levelplot</span>(<span class="kw">spc</span> <span class="op">~</span> <span class="kw">x</span> <span class="op">*</span> <span class="kw">y</span>, <span class="kw">chondro</span>, aspect = <span class="st">"iso"</span>)
<span class="co">#&gt; Warning in .local(x, data, ...): Only first wavelength is used for plotting</span>
</pre></div>
<div class="figure" style="text-align: center">
<span id="fig:levelplot-1"></span>
<img src="plotting_files/figure-html/levelplot-1-1.png" alt="False colour map (1).  "><p class="caption">
Figure 1.4: False colour map (1).
</p>
</div>
<blockquote>
<p>The following warning is expected: <code>Only first wavelength is used for plotting</code>.</p>
</blockquote>
</div>
<div id="exm-plotmap" class="section level2">
<h2 class="hasAnchor">
<a href="#exm-plotmap" class="anchor"></a><span class="header-section-number">1.5</span> Function <code class="sourceCode r"><span class="kw">plotmap</span>()</code>
</h2>
<p>Function <code class="sourceCode r"><span class="kw">plotmap</span>()</code> is a specialized version of <code class="sourceCode r"><span class="kw">levelplot</span>()</code>.
It uses a single value (e.g., average intensity or cluster membership) over two data columns (default are <code class="sourceCode r"><span class="op">$</span>x</code> and <code class="sourceCode r"><span class="op">$</span>y</code>) to plot a false colour map (Fig. <a href="#fig:plotmap">1.5</a>).</p>
<div class="sourceCode" id="cb8"><pre class="downlit">
<span class="fu"><a href="../reference/plotmap.html">plotmap</a></span>(<span class="kw">chondro</span>)
</pre></div>
<div class="figure" style="text-align: center">
<span id="fig:plotmap"></span>
<img src="plotting_files/figure-html/plotmap-1.png" alt="False colour map created with `plotmap()`{.r}.  "><p class="caption">
Figure 1.5: False colour map created with <code class="sourceCode r"><span class="kw">plotmap</span>()</code>.
</p>
</div>
</div>
<div id="exm-plotvoronoi" class="section level2">
<h2 class="hasAnchor">
<a href="#exm-plotvoronoi" class="anchor"></a><span class="header-section-number">1.6</span> Function <code class="sourceCode r"><span class="kw">plotvoronoi</span>()</code>
</h2>
<p>Function <code class="sourceCode r"><span class="kw">plotvoronoi</span>()</code> is a special version of <code class="sourceCode r"><span class="kw">plotmap</span>()</code> that produces Voronoi diagram of the <code>hyperSpec</code> object (Fig. <a href="#fig:voronoi">1.6</a>).</p>
<div class="sourceCode" id="cb9"><pre class="downlit">
<span class="fu"><a href="../reference/plotmap.html">plotvoronoi</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span>(<span class="kw">chondro</span>, <span class="fl">300</span>), <span class="kw">clusters</span> <span class="op">~</span> <span class="kw">x</span> <span class="op">*</span> <span class="kw">y</span>)
<span class="co">#&gt; </span>
<span class="co">#&gt;      PLEASE NOTE:  The components "delsgs" and "summary" of the</span>
<span class="co">#&gt;  object returned by deldir() are now DATA FRAMES rather than</span>
<span class="co">#&gt;  matrices (as they were prior to release 0.0-18).</span>
<span class="co">#&gt;  See help("deldir").</span>
<span class="co">#&gt;  </span>
<span class="co">#&gt;      PLEASE NOTE: The process that deldir() uses for determining</span>
<span class="co">#&gt;  duplicated points has changed from that used in version</span>
<span class="co">#&gt;  0.0-9 of this package (and previously). See help("deldir").</span>
</pre></div>
<div class="figure" style="text-align: center">
<span id="fig:voronoi"></span>
<img src="plotting_files/figure-html/voronoi-1.png" alt="Voronoi diagram: an example with `chondro` dataset.  "><p class="caption">
Figure 1.6: Voronoi diagram: an example with <code>chondro</code> dataset.
</p>
</div>
</div>
</div>
<div id="fun-plot" class="section level1">
<h1 class="hasAnchor">
<a href="#fun-plot" class="anchor"></a><span class="header-section-number">2</span> Arguments for <code class="sourceCode r"><span class="kw">plot</span>()</code>
</h1>
<p>The <strong>hyperSpec</strong>’s <code class="sourceCode r"><span class="kw">plot</span>()</code> method uses its second argument to determine which of the specialized plots to produce.
This allows some handy abbreviations.
All further arguments are handed over to the function actually producing the plot.</p>
<div id="arg-spc" class="section level2">
<h2 class="hasAnchor">
<a href="#arg-spc" class="anchor"></a><span class="header-section-number">2.1</span> Argument <code class="sourceCode r"><span class="st">"spc"</span></code>
</h2>
<p>Command <code class="sourceCode r"><span class="kw">plot</span>(x, <span class="st">"spc"</span>)</code> is equivalent to <code class="sourceCode r"><span class="kw">plotspc</span>(flu)</code> (Fig. <a href="#fig:plotspcflu">2.1</a>).</p>
<div class="sourceCode" id="cb10"><pre class="downlit">
<span class="fu"><a href="../reference/plot-methods.html">plot</a></span>(<span class="kw">flu</span>, <span class="st">"spc"</span>)
</pre></div>
<div class="figure" style="text-align: center">
<span id="fig:plotspcflu"></span>
<img src="plotting_files/figure-html/plotspcflu-1.png" alt="All spectra of dataset `flu`.  "><p class="caption">
Figure 2.1: All spectra of dataset <code>flu</code>.
</p>
</div>
</div>
<div id="arg-spcmeansd" class="section level2">
<h2 class="hasAnchor">
<a href="#arg-spcmeansd" class="anchor"></a><span class="header-section-number">2.2</span> Argument <code class="sourceCode r"><span class="st">"spcmeansd"</span></code>
</h2>
<p>Command <code class="sourceCode r"><span class="kw">plot</span>(x, <span class="st">"spcmeansd"</span>)</code> plots mean spectrum <span class="math inline">\(\pm\)</span> 1 standard deviation (Fig. <a href="#fig:plotchomean">2.2</a>).</p>
<div class="sourceCode" id="cb11"><pre class="downlit">
<span class="fu"><a href="../reference/plot-methods.html">plot</a></span>(<span class="kw">chondro.preproc</span>, <span class="st">"spcmeansd"</span>)
</pre></div>
<div class="figure" style="text-align: center">
<span id="fig:plotchomean"></span>
<img src="plotting_files/figure-html/plotchomean-1.png" alt="Summary spectra: mean $\pm$ one standard deviation at each wavelength (wavenumber).  "><p class="caption">
Figure 2.2: Summary spectra: mean <span class="math inline">\(\pm\)</span> one standard deviation at each wavelength (wavenumber).
</p>
</div>
</div>
<div id="arg-spcprctile" class="section level2">
<h2 class="hasAnchor">
<a href="#arg-spcprctile" class="anchor"></a><span class="header-section-number">2.3</span> Argument <code class="sourceCode r"><span class="st">"spcprctile"</span></code>
</h2>
<p>Code <code class="sourceCode r"><span class="kw">plot</span>(x, <span class="st">"spcprctile"</span>)</code> plots median, 16<sup>th</sup> and 84<sup>th</sup> percentile for each wavelength (Fig. <a href="#fig:plotchoprctl">2.3</a>).
For Gaussian distributed data, 16<sup>th</sup>, 50<sup>th</sup> and 84<sup>th</sup> percentile are equal to mean <span class="math inline">\(\pm\)</span> standard deviation.
Spectroscopic data frequently are not Gaussian distributed.
The percentiles give a better idea of the true distribution.
They are also less sensitive to outliers.</p>
<div class="sourceCode" id="cb12"><pre class="downlit">
<span class="fu"><a href="../reference/plot-methods.html">plot</a></span>(<span class="kw">chondro.preproc</span>, <span class="st">"spcprctile"</span>)
</pre></div>
<div class="figure" style="text-align: center">
<span id="fig:plotchoprctl"></span>
<img src="plotting_files/figure-html/plotchoprctl-1.png" alt="Summary spectra: median, 16^th^ and 84^th^ percentiles at each wavelength (wavenumber).  "><p class="caption">
Figure 2.3: Summary spectra: median, 16<sup>th</sup> and 84<sup>th</sup> percentiles at each wavelength (wavenumber).
</p>
</div>
</div>
<div id="arg-spcprctl5" class="section level2">
<h2 class="hasAnchor">
<a href="#arg-spcprctl5" class="anchor"></a><span class="header-section-number">2.4</span> Argument <code class="sourceCode r"><span class="st">"spcprctl5"</span></code>
</h2>
<p>The code <code class="sourceCode r"><span class="kw">plot</span>(x, <span class="st">"spcprctl5"</span>)</code> is like <code class="sourceCode r"><span class="st">"spcprctile"</span></code> plus 5<sup>th</sup> and 95<sup>th</sup> percentile (Fig. <a href="#fig:plotchoprctl5">2.4</a>).</p>
<div class="sourceCode" id="cb13"><pre class="downlit">
<span class="fu"><a href="../reference/plot-methods.html">plot</a></span>(<span class="kw">chondro.preproc</span>, <span class="st">"spcprctl5"</span>)
</pre></div>
<div class="figure" style="text-align: center">
<span id="fig:plotchoprctl5"></span>
<img src="plotting_files/figure-html/plotchoprctl5-1.png" alt="Summary spectra: median, 5^th^, 16^th^, 84^th^, 95^th^ percentiles at each wavelength (wavenumber).  "><p class="caption">
Figure 2.4: Summary spectra: median, 5<sup>th</sup>, 16<sup>th</sup>, 84<sup>th</sup>, 95<sup>th</sup> percentiles at each wavelength (wavenumber).
</p>
</div>
</div>
<div id="arg-c" class="section level2">
<h2 class="hasAnchor">
<a href="#arg-c" class="anchor"></a><span class="header-section-number">2.5</span> Argument <code class="sourceCode r"><span class="st">"c"</span></code>
</h2>
<p>Command <code class="sourceCode r"><span class="kw">plot</span>(x, <span class="st">"c"</span>)</code> is equivalent to <code class="sourceCode r"><span class="kw">plotc</span>(flu)</code> (Fig. <a href="#fig:plotflu2">2.5</a>).</p>
<div class="sourceCode" id="cb14"><pre class="downlit">
<span class="fu"><a href="../reference/plot-methods.html">plot</a></span>(<span class="kw">flu</span>, <span class="st">"c"</span>)
<span class="co">#&gt; Warning in plotc(x, ...): Intensity at first wavelengh only is used.</span>
</pre></div>
<div class="figure" style="text-align: center">
<span id="fig:plotflu2"></span>
<img src="plotting_files/figure-html/plotflu2-1.png" alt="Calibration plot: spectra intensities over concentration.  "><p class="caption">
Figure 2.5: Calibration plot: spectra intensities over concentration.
</p>
</div>
</div>
<div id="arg-ts" class="section level2">
<h2 class="hasAnchor">
<a href="#arg-ts" class="anchor"></a><span class="header-section-number">2.6</span> Argument <code class="sourceCode r"><span class="st">"ts"</span></code>
</h2>
<p>Function <code class="sourceCode r"><span class="kw">plot</span>(x, <span class="st">"ts"</span>)</code> plots a time series plot and is equivalent to <code class="sourceCode r"><span class="kw">plotc</span>(laser, spc <span class="op">~</span><span class="st"> </span>t)</code> (Fig. <a href="#fig:plotts">2.6</a>).</p>
<div class="sourceCode" id="cb15"><pre class="downlit">
<span class="fu"><a href="../reference/plot-methods.html">plot</a></span>(<span class="kw">laser</span>[, , <span class="fl">405</span>], <span class="st">"ts"</span>)
</pre></div>
<div class="figure" style="text-align: center">
<span id="fig:plotts"></span>
<img src="plotting_files/figure-html/plotts-1.png" alt="Time series plot: spectra intensities over time.  "><p class="caption">
Figure 2.6: Time series plot: spectra intensities over time.
</p>
</div>
</div>
<div id="arg-depth" class="section level2">
<h2 class="hasAnchor">
<a href="#arg-depth" class="anchor"></a><span class="header-section-number">2.7</span> Argument <code class="sourceCode r"><span class="st">"depth"</span></code>
</h2>
<p>Code <code class="sourceCode r"><span class="kw">plot</span>(x, <span class="st">"depth"</span>)</code> plots a depth profile plot and is the same as <code class="sourceCode r"><span class="kw">plotc</span>(laser, spc <span class="op">~</span><span class="st"> </span>z)</code> (Fig. <a href="#fig:plotdepth">2.7</a>).</p>
<div class="sourceCode" id="cb16"><pre class="downlit">
<span class="kw">depth.profile</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/initialize.html">new</a></span>(<span class="st">"hyperSpec"</span>,
  spc = <span class="fu"><a href="../reference/as.data.frame.html">as.matrix</a></span>(<span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(<span class="fl">20</span>) <span class="op">+</span> <span class="fl">1</span><span class="op">:</span><span class="fl">20</span>),
  data = <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(z = <span class="fl">1</span><span class="op">:</span><span class="fl">20</span>),
  labels = <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(
    spc = <span class="st">"I / a.u."</span>,
    z = <span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span>(<span class="fu">`/`</span>(<span class="kw">z</span>, <span class="kw">mu</span> <span class="op">*</span> <span class="kw">m</span>)),
    .wavelength = <span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span>(<span class="kw">lambda</span>)
  )
)

<span class="fu"><a href="../reference/plot-methods.html">plot</a></span>(<span class="kw">depth.profile</span>, <span class="st">"depth"</span>)
</pre></div>
<div class="figure" style="text-align: center">
<span id="fig:plotdepth"></span>
<img src="plotting_files/figure-html/plotdepth-1.png" alt="Depth profile plot.  "><p class="caption">
Figure 2.7: Depth profile plot.
</p>
</div>
</div>
<div id="arg-mat" class="section level2">
<h2 class="hasAnchor">
<a href="#arg-mat" class="anchor"></a><span class="header-section-number">2.8</span> Argument <code class="sourceCode r"><span class="st">"mat"</span></code>
</h2>
<p>Code <code class="sourceCode r"><span class="kw">plot</span>(x, <span class="st">"mat"</span>)</code> plots the spectra matrix (Fig. <a href="#fig:plotmat">2.8</a>).</p>
<div class="sourceCode" id="cb17"><pre class="downlit">
<span class="fu"><a href="../reference/plot-methods.html">plot</a></span>(<span class="kw">laser</span>, <span class="st">"mat"</span>)
</pre></div>
<div class="figure" style="text-align: center">
<span id="fig:plotmat"></span>
<img src="plotting_files/figure-html/plotmat-1.png" alt="Spectra matrix.  "><p class="caption">
Figure 2.8: Spectra matrix.
</p>
</div>
<p>The code is equivalent to:</p>
<div class="sourceCode" id="cb18"><pre class="downlit">
<span class="fu"><a href="../reference/plotmat.html">plotmat</a></span>(<span class="kw">laser</span>)
</pre></div>
<p>A <strong>lattice</strong> alternative is:</p>
<div class="sourceCode" id="cb19"><pre class="downlit">
<span class="fu">levelplot</span>(<span class="kw">spc</span> <span class="op">~</span> <span class="kw">.wavelength</span> <span class="op">*</span> <span class="kw">.row</span>, data = <span class="kw">laser</span>)
</pre></div>
</div>
<div id="arg-map" class="section level2">
<h2 class="hasAnchor">
<a href="#arg-map" class="anchor"></a><span class="header-section-number">2.9</span> Argument <code class="sourceCode r"><span class="st">"map"</span></code>
</h2>
<p>Code <code class="sourceCode r"><span class="kw">plot</span>(x, <span class="st">"map"</span>)</code> is equivalent to <code class="sourceCode r"><span class="kw">plotmap</span>(chondro)</code> (Fig. <a href="#fig:plotmapcho2">2.9</a>).</p>
<div class="sourceCode" id="cb20"><pre class="downlit">
<span class="fu"><a href="../reference/plot-methods.html">plot</a></span>(<span class="kw">chondro</span>, <span class="st">"map"</span>)
</pre></div>
<div class="figure" style="text-align: center">
<span id="fig:plotmapcho2"></span>
<img src="plotting_files/figure-html/plotmapcho2-1.png" alt="False color map: alternative R syntax.   "><p class="caption">
Figure 2.9: False color map: alternative R syntax.
</p>
</div>
</div>
<div id="arg-voronoi" class="section level2">
<h2 class="hasAnchor">
<a href="#arg-voronoi" class="anchor"></a><span class="header-section-number">2.10</span> Argument <code class="sourceCode r"><span class="st">"voronoi"</span></code>
</h2>
<p>Use <code class="sourceCode r"><span class="kw">plot</span>(x, <span class="st">"voronoi"</span>)</code> for a Voronoi plot (Fig. <a href="#fig:plotvoronoi">2.10</a>).</p>
<div class="sourceCode" id="cb21"><pre class="downlit">
<span class="fu"><a href="../reference/plot-methods.html">plot</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span>(<span class="kw">chondro</span>, <span class="fl">300</span>), <span class="st">"voronoi"</span>)
</pre></div>
<div class="figure" style="text-align: center">
<span id="fig:plotvoronoi"></span>
<img src="plotting_files/figure-html/plotvoronoi-1.png" alt="Voronoi plot: alternative R syntax.  "><p class="caption">
Figure 2.10: Voronoi plot: alternative R syntax.
</p>
</div>
<p>See <code class="sourceCode r"><a href="../reference/plotmap.html">?plotvoronoi</a></code> and <code class="sourceCode r">?latticeExtra<span class="op">::</span>panel.voronoi</code>.</p>
</div>
</div>
<div id="fun-plotspc" class="section level1">
<h1 class="hasAnchor">
<a href="#fun-plotspc" class="anchor"></a><span class="header-section-number">3</span> Customized Plots of Spectra: <code class="sourceCode r"><span class="kw">plotspc</span>()</code>
</h1>
<!-- \mFun{`plotspc()`{.r}} -->
<p>Function <code class="sourceCode r"><span class="kw">plotspc</span>()</code> offers a variety of parameters for customized plots.</p>
<div id="plot-particular-wavelength-range" class="section level2">
<h2 class="hasAnchor">
<a href="#plot-particular-wavelength-range" class="anchor"></a><span class="header-section-number">3.1</span> Plot Particular Wavelength Range</h2>
<p>If only one wavelength range is needed (Fig. <a href="#fig:wavelength">3.1</a>), the extract command is handiest.</p>
<div class="sourceCode" id="cb22"><pre class="downlit">
<span class="fu"><a href="../reference/plotspc.html">plotspc</a></span>(<span class="kw">paracetamol</span>[, , <span class="fl">700</span> <span class="op">~</span> <span class="fl">1200</span>])
</pre></div>
<div class="figure" style="text-align: center">
<span id="fig:wavelength"></span>
<img src="plotting_files/figure-html/wavelength-1.png" alt="Plot of wavelength (wavenumber) range from 700 to 1200 $cm^{-1}.$  "><p class="caption">
Figure 3.1: Plot of wavelength (wavenumber) range from 700 to 1200 <span class="math inline">\(cm^{-1}.\)</span>
</p>
</div>
<p>Numbers connected with the tilde (<code><a href="https://rdrr.io/r/base/tilde.html">~</a></code>) are interpreted as having the same units as the wavelengths.
If <code class="sourceCode r">wl.range</code> already contains indices use <code class="sourceCode r">wl.index =<span class="st"> </span><span class="ot">TRUE</span></code>.
For more details refer to <code class="sourceCode r"><span class="kw">vignette</span>(<span class="st">"hyperspec"</span>, <span class="dt">package =</span> <span class="st">"hyperSpec"</span>)</code>.</p>
</div>
<div id="plot-several-wavelength-ranges" class="section level2">
<h2 class="hasAnchor">
<a href="#plot-several-wavelength-ranges" class="anchor"></a><span class="header-section-number">3.2</span> Plot Several Wavelength Ranges</h2>
<p>To plot severel wavelength ranges (Fig. <a href="#fig:wavelength-2">3.2</a>), use <code class="sourceCode r">wl.range =<span class="st"> </span><span class="kw">list</span> (<span class="dv">600</span> <span class="op">~</span><span class="st"> </span><span class="dv">1800</span>, <span class="dv">2800</span> <span class="op">~</span><span class="st"> </span><span class="dv">3100</span>)</code>.
Cut the wavelength axis appropriately with <code class="sourceCode r">xoffset =<span class="st"> </span><span class="dv">750</span></code>.
If available, the package package <strong>plotrix</strong><span class="citation">[<a href="#ref-plotrix" role="doc-biblioref">3</a>]</span> is used to produce the cut mark.</p>
<div class="sourceCode" id="cb23"><pre class="downlit">
<span class="fu"><a href="../reference/plotspc.html">plotspc</a></span>(<span class="kw">paracetamol</span>,
  wl.range = <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">300</span> <span class="op">~</span> <span class="fl">1800</span>, <span class="fl">2800</span> <span class="op">~</span> <span class="kw">max</span>),
  xoffset = <span class="fl">750</span>
)
</pre></div>
<div class="figure" style="text-align: center">
<span id="fig:wavelength-2"></span>
<img src="plotting_files/figure-html/wavelength-2-1.png" alt="Plot of several wavelength (wavenumber) ranges.  "><p class="caption">
Figure 3.2: Plot of several wavelength (wavenumber) ranges.
</p>
</div>
</div>
<div id="plot-with-reversed-abscissa" class="section level2">
<h2 class="hasAnchor">
<a href="#plot-with-reversed-abscissa" class="anchor"></a><span class="header-section-number">3.3</span> Plot with Reversed Abscissa</h2>
<p>To create a plot with reversed abscissa (Fig. <a href="#fig:abscissa">3.3</a>), use <code class="sourceCode r">wl.reverse =<span class="st"> </span><span class="ot">TRUE</span></code></p>
<div class="sourceCode" id="cb24"><pre class="downlit">
<span class="fu"><a href="../reference/plotspc.html">plotspc</a></span>(<span class="kw">paracetamol</span>, wl.reverse = <span class="fl">TRUE</span>)
</pre></div>
<div class="figure" style="text-align: center">
<span id="fig:abscissa"></span>
<img src="plotting_files/figure-html/abscissa-1.png" alt="Plot with reversed/descending wavelength (wavenumber) range.  "><p class="caption">
Figure 3.3: Plot with reversed/descending wavelength (wavenumber) range.
</p>
</div>
</div>
<div id="plot-in-different-colours" class="section level2">
<h2 class="hasAnchor">
<a href="#plot-in-different-colours" class="anchor"></a><span class="header-section-number">3.4</span> Plot in Different Colours</h2>
<p>To have different colours of spectra (Fig. <a href="#fig:colours">3.4</a>), use <code class="sourceCode r">col =<span class="st"> </span>vector_of_colours</code>.</p>
<div class="sourceCode" id="cb25"><pre class="downlit">
<span class="fu"><a href="../reference/plotspc.html">plotspc</a></span>(<span class="kw">flu</span>, col = <span class="fu"><a href="../reference/matlab.palette.html">matlab.dark.palette</a></span>(<span class="fl">6</span>))
</pre></div>
<div class="figure" style="text-align: center">
<span id="fig:colours"></span>
<img src="plotting_files/figure-html/colours-1.png" alt="Spectra plotted in different colours.  "><p class="caption">
Figure 3.4: Spectra plotted in different colours.
</p>
</div>
</div>
<div id="plot-dots-instead-of-lines" class="section level2">
<h2 class="hasAnchor">
<a href="#plot-dots-instead-of-lines" class="anchor"></a><span class="header-section-number">3.5</span> Plot Dots Instead of Lines</h2>
<p>To plot dots instead of lines (Fig. <a href="#fig:dots">3.5</a>), use, e.g., <code class="sourceCode r">lines.args =<span class="st"> </span><span class="kw">list</span> (<span class="dt">pch =</span> <span class="dv">20</span>, <span class="dt">type =</span> <span class="st">"p"</span>)</code></p>
<div class="sourceCode" id="cb26"><pre class="downlit">
<span class="fu"><a href="../reference/plotspc.html">plotspc</a></span>(<span class="kw">paracetamol</span>[, , <span class="fl">2800</span> <span class="op">~</span> <span class="fl">3200</span>],
  lines.args = <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(pch = <span class="fl">20</span>, type = <span class="st">"p"</span>)
)
</pre></div>
<div class="figure" style="text-align: center">
<span id="fig:dots"></span>
<img src="plotting_files/figure-html/dots-1.png" alt="Spectrum with dots instead of lines.  "><p class="caption">
Figure 3.5: Spectrum with dots instead of lines.
</p>
</div>
</div>
<div id="plot-mass-spectra" class="section level2">
<h2 class="hasAnchor">
<a href="#plot-mass-spectra" class="anchor"></a><span class="header-section-number">3.6</span> Plot Mass Spectra</h2>
<p>TO plot mass spectra (Fig. <a href="#fig:mass">3.6</a>), use <code class="sourceCode r">lines.args =<span class="st"> </span><span class="kw">list</span>(<span class="dt">type =</span> <span class="st">"h"</span>)</code></p>
<div class="sourceCode" id="cb27"><pre class="downlit">
<span class="fu"><a href="../reference/plot-methods.html">plot</a></span>(<span class="kw">barbiturates</span>[[<span class="fl">1</span>]], lines.args = <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(type = <span class="st">"h"</span>))
</pre></div>
<div class="figure" style="text-align: center">
<span id="fig:mass"></span>
<img src="plotting_files/figure-html/mass-1.png" alt="An example of mass spectrum.  "><p class="caption">
Figure 3.6: An example of mass spectrum.
</p>
</div>
</div>
<div id="add-more-spectra-into-an-existing-plot" class="section level2">
<h2 class="hasAnchor">
<a href="#add-more-spectra-into-an-existing-plot" class="anchor"></a><span class="header-section-number">3.7</span> Add More Spectra into an Existing Plot</h2>
<p>To plot additional spectra onto an existing plot (Fig. <a href="#fig:add">3.7</a>), use <code class="sourceCode r">add =<span class="st"> </span><span class="ot">TRUE</span></code></p>
<div class="sourceCode" id="cb28"><pre class="downlit">
<span class="fu"><a href="../reference/plotspc.html">plotspc</a></span>(<span class="kw">chondro</span>[<span class="fl">30</span>, , ])
<span class="fu"><a href="../reference/plotspc.html">plotspc</a></span>(<span class="kw">chondro</span>[<span class="fl">300</span>, , ], add = <span class="fl">TRUE</span>, col = <span class="st">"blue"</span>)
</pre></div>
<div class="figure" style="text-align: center">
<span id="fig:add"></span>
<img src="plotting_files/figure-html/add-1.png" alt="A spectrum added to an existing plot.  "><p class="caption">
Figure 3.7: A spectrum added to an existing plot.
</p>
</div>
</div>
<div id="plot-summary-characteristics" class="section level2">
<h2 class="hasAnchor">
<a href="#plot-summary-characteristics" class="anchor"></a><span class="header-section-number">3.8</span> Plot Summary Characteristics</h2>
<p>Argument <code class="sourceCode r">func</code> may be used to calculate summary characteristics before plotting.
To plot, e.g., the standard deviation of the spectra, use <code class="sourceCode r"><span class="kw">plotspc</span>(..., <span class="dt">func =</span> sd)</code> (Fig. <a href="#fig:sd">3.8</a>).</p>
<div class="sourceCode" id="cb29"><pre class="downlit">
<span class="fu"><a href="../reference/plotspc.html">plotspc</a></span>(<span class="kw">chondro.preproc</span>, func = <span class="kw">sd</span>)
</pre></div>
<div class="figure" style="text-align: center">
<span id="fig:sd"></span>
<img src="plotting_files/figure-html/sd-1.png" alt="A spectrum of summary statistics calculated via `func` parameter.
In the example, the standard deviation is used.  "><p class="caption">
Figure 3.8: A spectrum of summary statistics calculated via <code>func</code> parameter.
In the example, the standard deviation is used.
</p>
</div>
</div>
<div id="plot-different-line-at-i-0" class="section level2">
<h2 class="hasAnchor">
<a href="#plot-different-line-at-i-0" class="anchor"></a><span class="header-section-number">3.9</span> Plot Different Line at <span class="math inline">\(I = 0\)</span>
</h2>
<p>To plot a different line at zero intensity <span class="math inline">\((I = 0)\)</span>, argument <code class="sourceCode r">zeroline</code> may be used (Fig. <a href="#fig:diffline">3.9</a>).
Argument <code class="sourceCode r">zeroline</code> takes a list with parameters that are passed to function <code class="sourceCode r"><span class="kw">abline</span>()</code>, <code class="sourceCode r"><span class="ot">NA</span></code> suppresses the line.</p>
<div class="sourceCode" id="cb30"><pre class="downlit">
<span class="fu"><a href="../reference/plotspc.html">plotspc</a></span>(<span class="kw">paracetamol</span>,
  zeroline = <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(col = <span class="st">"red"</span>)
)
</pre></div>
<div class="figure" style="text-align: center">
<span id="fig:diffline"></span>
<img src="plotting_files/figure-html/diffline-1.png" alt="Spectrum with added zero-intensity line.  "><p class="caption">
Figure 3.9: Spectrum with added zero-intensity line.
</p>
</div>
</div>
<div id="adding-annotations-to-a-spectra-plot" class="section level2">
<h2 class="hasAnchor">
<a href="#adding-annotations-to-a-spectra-plot" class="anchor"></a><span class="header-section-number">3.10</span> Adding Annotations to a Spectra Plot</h2>
<p>Function <code class="sourceCode r"><span class="kw">plotspc</span>()</code> uses base graphics.
After plotting the spectra, more content may be added to the graphic by <code class="sourceCode r"><span class="kw">abline</span>()</code>, <code class="sourceCode r"><span class="kw">lines</span>()</code>, <code class="sourceCode r"><span class="kw">points</span>()</code>, etc. (Fig. <a href="#fig:add-line">3.10</a>).</p>
<div class="sourceCode" id="cb31"><pre class="downlit">
<span class="fu"><a href="../reference/plot-methods.html">plot</a></span>(<span class="kw">laser</span>, <span class="st">"spcmeansd"</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span>(
  v = <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">405.0063</span>, <span class="fl">405.1121</span>, <span class="fl">405.2885</span>, <span class="fl">405.3591</span>),
  col = <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"black"</span>, <span class="st">"blue"</span>, <span class="st">"red"</span>, <span class="st">"darkgreen"</span>)
)
</pre></div>
<div class="figure" style="text-align: center">
<span id="fig:add-line"></span>
<img src="plotting_files/figure-html/add-line-1.png" alt="A summary spectrum with annotation lines.  "><p class="caption">
Figure 3.10: A summary spectrum with annotation lines.
</p>
</div>
</div>
<div id="sec:stacked-spectra" class="section level2">
<h2 class="hasAnchor">
<a href="#sec:stacked-spectra" class="anchor"></a><span class="header-section-number">3.11</span> Stacked Spectra</h2>
<div id="simple-stacking" class="section level3">
<h3 class="hasAnchor">
<a href="#simple-stacking" class="anchor"></a><span class="header-section-number">3.11.1</span> Simple Stacking</h3>
<p>To stack spectra, use <code class="sourceCode r">stacked =<span class="st"> </span><span class="ot">TRUE</span></code> (Fig. <a href="#fig:stacked1">3.11</a>).</p>
<div class="sourceCode" id="cb32"><pre class="downlit">
<span class="fu"><a href="../reference/plotspc.html">plotspc</a></span>(<span class="kw">cluster.means</span>,
  col = <span class="kw">cluster.cols</span>,
  stacked = <span class="fl">TRUE</span>
)
</pre></div>
<div class="figure" style="text-align: center">
<span id="fig:stacked1"></span>
<img src="plotting_files/figure-html/stacked1-1.png" alt="Stacked spectra of means.  "><p class="caption">
Figure 3.11: Stacked spectra of means.
</p>
</div>
</div>
<div id="stacking-groups-of-spectra" class="section level3">
<h3 class="hasAnchor">
<a href="#stacking-groups-of-spectra" class="anchor"></a><span class="header-section-number">3.11.2</span> Stacking Groups of Spectra</h3>
<!-- ======================================================================= -->
<!-- ======================================================================= -->
<p>The spectra to be stacked can be grouped: <code class="sourceCode r">stacked =<span class="st"> "factor"</span></code>.
Alternatively, the name of an extra data column can be used for grouping (Fig. <a href="#fig:stacked2">3.12</a>).</p>
<div class="sourceCode" id="cb33"><pre class="downlit">
<span class="kw">op</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(las = <span class="fl">1</span>, mgp = <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">3.1</span>, <span class="fl">.7</span>, <span class="fl">0</span>))

<span class="fu"><a href="../reference/plot-methods.html">plot</a></span>(<span class="kw">cluster.meansd</span>,
  stacked = <span class="st">".aggregate"</span>,
  fill    = <span class="st">".aggregate"</span>,
  col     = <span class="kw">cluster.cols</span>
)
</pre></div>
<div class="figure" style="text-align: center">
<span id="fig:stacked2"></span>
<img src="plotting_files/figure-html/stacked2-1.png" alt="Stacked summary spectra (mean $\pm$ one standard deviation).  "><p class="caption">
Figure 3.12: Stacked summary spectra (mean <span class="math inline">\(\pm\)</span> one standard deviation).
</p>
</div>
</div>
<div id="manually-giving-yoffset" class="section level3">
<h3 class="hasAnchor">
<a href="#manually-giving-yoffset" class="anchor"></a><span class="header-section-number">3.11.3</span> Manually Giving <code>yoffset</code>
</h3>
<p>Stacking values can also be given manually as numeric values in <code class="sourceCode r">yoffset</code> (Fig. <a href="#fig:stacked3">3.13</a>).</p>
<div class="sourceCode" id="cb34"><pre class="downlit">
<span class="fu"><a href="../reference/plotspc.html">plotspc</a></span>(<span class="kw">cluster.meansd</span>,
  yoffset = <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fl">0</span><span class="op">:</span><span class="fl">2</span>, each = <span class="fl">3</span>),
  col = <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="kw">cluster.cols</span>, each = <span class="fl">3</span>)
)
</pre></div>
<div class="figure" style="text-align: center">
<span id="fig:stacked3"></span>
<img src="plotting_files/figure-html/stacked3-1.png" alt="Stacked spectra with customized y offset.  "><p class="caption">
Figure 3.13: Stacked spectra with customized y offset.
</p>
</div>
</div>
<div id="dense-stacking" class="section level3">
<h3 class="hasAnchor">
<a href="#dense-stacking" class="anchor"></a><span class="header-section-number">3.11.4</span> Dense Stacking</h3>
<p>It is possible to obtain a denser stacking (Fig. <a href="#fig:stacked4">3.14</a>).</p>
<div class="sourceCode" id="cb35"><pre class="downlit">
<span class="kw">yoffsets</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/apply.html">apply</a></span>(<span class="kw">cluster.means</span>[[]], <span class="fl">2</span>, <span class="kw">diff</span>)
<span class="kw">yoffsets</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fu"><a href="../reference/apply.html">apply</a></span>(<span class="kw">yoffsets</span>, <span class="fl">1</span>, <span class="kw">min</span>)
<span class="fu"><a href="../reference/plot-methods.html">plot</a></span>(<span class="kw">cluster.means</span>,
  yoffset = <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/cumsum.html">cumsum</a></span>(<span class="kw">yoffsets</span>)),
  col = <span class="kw">cluster.cols</span>
)
</pre></div>
<div class="figure" style="text-align: center">
<span id="fig:stacked4"></span>
<img src="plotting_files/figure-html/stacked4-1.png" alt="Dense-stacked spectra.  "><p class="caption">
Figure 3.14: Dense-stacked spectra.
</p>
</div>
</div>
<div id="elaborate-example" class="section level3">
<h3 class="hasAnchor">
<a href="#elaborate-example" class="anchor"></a><span class="header-section-number">3.11.5</span> Elaborate Example</h3>
<p>Function <code class="sourceCode r"><span class="kw">plotspc</span>()</code> allows fine grained customization of almost all aspects of the plot (see example in Fig. <a href="#fig:stacked5">3.15</a>).
This is possible by giving arguments to the functions that actually perform the plotting <code class="sourceCode r"><span class="kw">plot</span>()</code> for setting up the plot area, <code class="sourceCode r"><span class="kw">lines</span>()</code> for the plotting of the lines, <code class="sourceCode r"><span class="kw">axis</span>()</code> for the axes, etc.
The arguments for these functions should be given in lists as <code class="sourceCode r">plot.args</code>, <code class="sourceCode r">lines.args</code>, <code class="sourceCode r">axis.args</code>, etc.</p>
<div class="sourceCode" id="cb36"><pre class="downlit">
<span class="kw">yoffset</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/apply.html">apply</a></span>(<span class="kw">chondro.preproc</span>, <span class="fl">2</span>, <span class="kw">quantile</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.05</span>, <span class="fl">0.95</span>))
<span class="kw">yoffset</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html">range</a></span>(<span class="kw">yoffset</span>)
<span class="fu"><a href="../reference/plot-methods.html">plot</a></span>(<span class="kw">chondro.preproc</span>[<span class="fl">1</span>],
  plot.args = <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(ylim = <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>, <span class="fl">2</span>) <span class="op">*</span> <span class="kw">yoffset</span>),
  lines.args = <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(type = <span class="st">"n"</span>)
)
<span class="kw">yoffset</span> <span class="op">&lt;-</span> (<span class="fl">0</span><span class="op">:</span><span class="fl">1</span>) <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/diff.html">diff</a></span>(<span class="kw">yoffset</span>)
<span class="co">for</span> (<span class="kw">i</span> <span class="co">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span>) {
  <span class="fu"><a href="../reference/plot-methods.html">plot</a></span>(<span class="kw">chondro.preproc</span>, <span class="st">"spcprctl5"</span>,
    yoffset = <span class="kw">yoffset</span>[<span class="kw">i</span>],
    col = <span class="st">"gray"</span>, add = <span class="fl">TRUE</span>
  )
  <span class="fu"><a href="../reference/plot-methods.html">plot</a></span>(<span class="kw">chondro.preproc</span>[<span class="kw">i</span>],
    yoffset = <span class="kw">yoffset</span>[<span class="kw">i</span>],
    col = <span class="fu"><a href="../reference/matlab.palette.html">matlab.dark.palette</a></span>(<span class="fl">3</span>) [<span class="kw">i</span>], add = <span class="fl">TRUE</span>,
    lines.args = <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(lwd = <span class="fl">2</span>)
  )
}
</pre></div>
<div class="figure" style="text-align: center">
<span id="fig:stacked5"></span>
<img src="plotting_files/figure-html/stacked5-1.png" alt="An example of highly customized spectra.  "><p class="caption">
Figure 3.15: An example of highly customized spectra.
</p>
</div>
</div>
</div>
</div>
<div id="fun-plotc" class="section level1">
<h1 class="hasAnchor">
<a href="#fun-plotc" class="anchor"></a><span class="header-section-number">4</span> Calibration, (Depth) Profile, and Time Series Plots: <code class="sourceCode r"><span class="kw">plotc</span>()</code>
</h1>
<!-- \mFun{`plotc()`{.r}} -->
<div id="intensities-over-concentration" class="section level2">
<h2 class="hasAnchor">
<a href="#intensities-over-concentration" class="anchor"></a><span class="header-section-number">4.1</span> Intensities over Concentration</h2>
<p>Spectra intensities of one wavelength can be plotted over the concentration for univariate calibration (Fig. <a href="#fig:lin-cal-1">4.1</a>).</p>
<div class="sourceCode" id="cb37"><pre class="downlit">
<span class="fu"><a href="../reference/plotc.html">plotc</a></span>(<span class="kw">flu</span>[, , <span class="fl">450</span>])
</pre></div>
<div class="figure" style="text-align: center">
<span id="fig:lin-cal-1"></span>
<img src="plotting_files/figure-html/lin-cal-1-1.png" alt="Intensities at 450 nm over concentration.  "><p class="caption">
Figure 4.1: Intensities at 450 nm over concentration.
</p>
</div>
<p>The default is to use the first intensity only.</p>
</div>
<div id="summary-intensities-over-concentration" class="section level2">
<h2 class="hasAnchor">
<a href="#summary-intensities-over-concentration" class="anchor"></a><span class="header-section-number">4.2</span> Summary Intensities over Concentration</h2>
<p>A function to compute a summary of the intensities before the drawing can be used via argument <code>func</code> (Fig. <a href="#fig:lin-cal-3">4.2</a>).</p>
<div class="sourceCode" id="cb38"><pre class="downlit">
<span class="fu"><a href="../reference/plotc.html">plotc</a></span>(<span class="kw">flu</span>, func = <span class="kw">range</span>, groups = <span class="kw">.wavelength</span>)
</pre></div>
<div class="figure" style="text-align: center">
<span id="fig:lin-cal-3"></span>
<img src="plotting_files/figure-html/lin-cal-3-1.png" alt="The summary (minimum and maximum) of intensities at each measured concentration.  "><p class="caption">
Figure 4.2: The summary (minimum and maximum) of intensities at each measured concentration.
</p>
</div>
<p>If <code class="sourceCode r"><span class="kw">func</span>()</code> returns more than one value, the different results are accessible by <code>.wavelength</code>.</p>
</div>
<div id="conditioning-plotting-more-traces-separately" class="section level2">
<h2 class="hasAnchor">
<a href="#conditioning-plotting-more-traces-separately" class="anchor"></a><span class="header-section-number">4.3</span> Conditioning: Plotting More Traces Separately</h2>
<p><strong>Lattice</strong> conditioning (operator <code><a href="https://rdrr.io/r/base/Logic.html">|</a></code>) can be used to plot more traces separately (Fig. <a href="#fig:plotc2">4.3</a>).</p>
<div class="sourceCode" id="cb39"><pre class="downlit">
<span class="fu"><a href="../reference/plotc.html">plotc</a></span>(<span class="kw">flu</span>[, , <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">405</span>, <span class="fl">445</span>)], <span class="kw">spc</span> <span class="op">~</span> <span class="kw">c</span> <span class="op">|</span> <span class="kw">.wavelength</span>,
  cex = <span class="fl">.3</span>, scales = <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(alternating = <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>, <span class="fl">1</span>))
)
</pre></div>
<div class="figure" style="text-align: center">
<span id="fig:plotc2"></span>
<img src="plotting_files/figure-html/plotc2-1.png" alt="Conditioning: several calibration spectra on separate subplots.  "><p class="caption">
Figure 4.3: Conditioning: several calibration spectra on separate subplots.
</p>
</div>
</div>
<div id="grouping-plot-more-traces-in-one-panel" class="section level2">
<h2 class="hasAnchor">
<a href="#grouping-plot-more-traces-in-one-panel" class="anchor"></a><span class="header-section-number">4.4</span> Grouping: Plot More Traces in One Panel</h2>
<p>Argument <code class="sourceCode r">groups</code> may be used as a grouping parameter to plot more traces in one panel (Fig. <a href="#fig:plotc3">4.4</a>).</p>
<div class="sourceCode" id="cb40"><pre class="downlit">
<span class="fu"><a href="../reference/plotc.html">plotc</a></span>(<span class="kw">flu</span>[, , <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">405</span>, <span class="fl">445</span>)], groups = <span class="kw">.wavelength</span>)
</pre></div>
<div class="figure" style="text-align: center">
<span id="fig:plotc3"></span>
<img src="plotting_files/figure-html/plotc3-1.png" alt="Grouping: several calibration spectra on one plot.  "><p class="caption">
Figure 4.4: Grouping: several calibration spectra on one plot.
</p>
</div>
</div>
<div id="changing-axis-labels-and-other-parameters" class="section level2">
<h2 class="hasAnchor">
<a href="#changing-axis-labels-and-other-parameters" class="anchor"></a><span class="header-section-number">4.5</span> Changing Axis Labels (and Other Parameters)</h2>
<p>Arguments of <strong>lattice</strong> function <code class="sourceCode r"><span class="kw">xyplot</span>()</code> can be given to <code class="sourceCode r"><span class="kw">plotc</span>()</code> (Fig. <a href="#fig:lin-cal-4">4.5</a>).</p>
<div class="sourceCode" id="cb41"><pre class="downlit">
<span class="fu"><a href="../reference/plotc.html">plotc</a></span>(<span class="kw">flu</span>[, , <span class="fl">450</span>],
  ylab = <span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span>(<span class="kw">I</span>[<span class="st">"450 nm"</span>] <span class="op">/</span> <span class="kw">a.u.</span>),
  xlim = <span class="fu"><a href="https://rdrr.io/r/base/range.html">range</a></span>(<span class="fl">0</span>, <span class="kw">flu</span><span class="op">$</span><span class="kw">c</span> <span class="op">+</span> <span class="fl">.01</span>),
  ylim = <span class="fu"><a href="https://rdrr.io/r/base/range.html">range</a></span>(<span class="fl">0</span>, <span class="kw">flu</span><span class="op">$</span><span class="kw">spc</span> <span class="op">+</span> <span class="fl">10</span>),
  pch = <span class="fl">4</span>
)
</pre></div>
<div class="figure" style="text-align: center">
<span id="fig:lin-cal-4"></span>
<img src="plotting_files/figure-html/lin-cal-4-1.png" alt="Modified axis labels and point characters.  "><p class="caption">
Figure 4.5: Modified axis labels and point characters.
</p>
</div>
</div>
<div id="adding-things-to-the-plot-customized-panel-function" class="section level2">
<h2 class="hasAnchor">
<a href="#adding-things-to-the-plot-customized-panel-function" class="anchor"></a><span class="header-section-number">4.6</span> Adding Things to the Plot: Customized Panel Function</h2>
<p>As <code class="sourceCode r"><span class="kw">plotc</span>()</code> uses the package <strong>lattice</strong> function <code class="sourceCode r"><span class="kw">xyplot</span>()</code>, additions to the plot must be made via the panel function (Fig. <a href="#fig:lin-cal-5">4.6</a>).</p>
<div class="sourceCode" id="cb42"><pre class="downlit">
<span class="kw">panelcalibration</span> <span class="op">&lt;-</span> <span class="fu">function</span>(<span class="kw">x</span>, <span class="kw">y</span>, <span class="kw">...</span>, <span class="kw">clim</span> = <span class="fu"><a href="https://rdrr.io/r/base/range.html">range</a></span>(<span class="kw">x</span>), <span class="kw">level</span> = <span class="fl">.95</span>) {
  <span class="fu">panel.xyplot</span>(<span class="kw">x</span>, <span class="kw">y</span>, <span class="kw">...</span>)
  <span class="kw">lm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>(<span class="kw">y</span> <span class="op">~</span> <span class="kw">x</span>)
  <span class="fu">panel.abline</span>(<span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span>(<span class="kw">lm</span>), <span class="kw">...</span>)
  <span class="kw">cx</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/seq.hyperSpec.html">seq</a></span>(<span class="kw">clim</span>[<span class="fl">1</span>], <span class="kw">clim</span>[<span class="fl">2</span>], length.out = <span class="fl">50</span>)
  <span class="kw">cy</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span>(<span class="kw">lm</span>, <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(x = <span class="kw">cx</span>),
    interval = <span class="st">"confidence"</span>,
    level = <span class="kw">level</span>
  )
  <span class="fu">panel.lines</span>(<span class="kw">cx</span>, <span class="kw">cy</span>[, <span class="fl">2</span>], col = <span class="st">"gray"</span>)
  <span class="fu">panel.lines</span>(<span class="kw">cx</span>, <span class="kw">cy</span>[, <span class="fl">3</span>], col = <span class="st">"gray"</span>)
}
</pre></div>
<div class="sourceCode" id="cb43"><pre class="downlit">
<span class="fu"><a href="../reference/plotc.html">plotc</a></span>(<span class="kw">flu</span>[, , <span class="fl">405</span>],
  panel = <span class="kw">panelcalibration</span>,
  pch = <span class="fl">4</span>, clim = <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>, <span class="fl">0.35</span>), level = <span class="fl">.99</span>
)
</pre></div>
<div class="figure" style="text-align: center">
<span id="fig:lin-cal-5"></span>
<img src="plotting_files/figure-html/lin-cal-5-1.png" alt="Plot that uses a customized paanel function.  "><p class="caption">
Figure 4.6: Plot that uses a customized paanel function.
</p>
</div>
</div>
<div id="sec:time-series" class="section level2">
<h2 class="hasAnchor">
<a href="#sec:time-series" class="anchor"></a><span class="header-section-number">4.7</span> Time Series and Other Plots of the Type “Intensity-over-Something”</h2>
<p>Abscissae other than <code>c</code> may be specified by explicitly giving the model formula (Fig. <a href="#fig:plotc4">4.7</a>).</p>
<div class="sourceCode" id="cb44"><pre class="downlit">
<span class="fu"><a href="../reference/plotc.html">plotc</a></span>(<span class="kw">laser</span>[, , <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">405.0063</span>, <span class="fl">405.1121</span>, <span class="fl">405.2885</span>, <span class="fl">405.3591</span>)],
  <span class="kw">spc</span> <span class="op">~</span> <span class="kw">t</span>,
  groups = <span class="kw">.wavelength</span>,
  type   = <span class="st">"b"</span>,
  col    = <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"black"</span>, <span class="st">"blue"</span>, <span class="st">"red"</span>, <span class="st">"darkgreen"</span>)
)
</pre></div>
<div class="figure" style="text-align: center">
<span id="fig:plotc4"></span>
<img src="plotting_files/figure-html/plotc4-1.png" alt="Plot with abscissae explicitly indicated by model formula.  "><p class="caption">
Figure 4.7: Plot with abscissae explicitly indicated by model formula.
</p>
</div>
</div>
</div>
<div id="fun-levelplot" class="section level1">
<h1 class="hasAnchor">
<a href="#fun-levelplot" class="anchor"></a><span class="header-section-number">5</span> Levelplot: <code class="sourceCode r"><span class="kw">levelplot</span>()</code>
</h1>
<p>Package <strong>hyperSpec</strong>’s function <code class="sourceCode r"><span class="kw">levelplot</span>()</code> can use two special column names:</p>
<ul>
<li>
<strong>.wavelength</strong> for the wavelengths,</li>
<li>
<strong>.row</strong> for the row index (i.e., spectrum number) in the data.</li>
</ul>
<p>Besides that, it behaves exactly like <strong>lattice</strong> <code class="sourceCode r"><span class="kw">levelplot</span>()</code>.
Particularly, the data is given as the <em>second</em> argument (Fig. <a href="#fig:levelplot">5.1</a>).</p>
<div class="sourceCode" id="cb45"><pre class="downlit">
<span class="fu">levelplot</span>(<span class="kw">spc</span> <span class="op">~</span> <span class="kw">x</span> <span class="op">*</span> <span class="kw">y</span>, data = <span class="kw">chondro</span>)
<span class="co">#&gt; Warning in .local(x, data, ...): Only first wavelength is used for plotting</span>
</pre></div>
<div class="figure" style="text-align: center">
<span id="fig:levelplot"></span>
<img src="plotting_files/figure-html/levelplot-1.png" alt="An example of a levelplot.  "><p class="caption">
Figure 5.1: An example of a levelplot.
</p>
</div>
<p>If the colour-coded value is a factor, the display is adjusted to this fact (Fig. <a href="#fig:levelplot-factor">5.2</a>).</p>
<!-- Factors as `z` -->
<div class="sourceCode" id="cb46"><pre class="downlit">
<span class="fu">levelplot</span>(<span class="kw">clusters</span> <span class="op">~</span> <span class="kw">x</span> <span class="op">*</span> <span class="kw">y</span>, data = <span class="kw">chondro</span>)
</pre></div>
<div class="figure" style="text-align: center">
<span id="fig:levelplot-factor"></span>
<img src="plotting_files/figure-html/levelplot-factor-1.png" alt="Levelplot when colour-coded value is a factor.  "><p class="caption">
Figure 5.2: Levelplot when colour-coded value is a factor.
</p>
</div>
</div>
<div id="fun-plotmat" class="section level1">
<h1 class="hasAnchor">
<a href="#fun-plotmat" class="anchor"></a><span class="header-section-number">6</span> Spectra Matrix: <code class="sourceCode r"><span class="kw">plotmat</span>()</code>
</h1>
<p>It is often useful to plot the spectra against an additional coordinate, e.g., the time for time
series, the depth for depth profiles, etc.
This can be done by <code class="sourceCode r"><span class="kw">plot</span>(object, <span class="st">"mat"</span>)</code>.
The actual plotting is done by <code class="sourceCode r"><span class="kw">image</span>()</code>, but <code class="sourceCode r"><span class="kw">levelplot</span>()</code> can produce spectra matrix plots as well and these plots can be grouped or conditioned.</p>
<div id="different-palette" class="section level2">
<h2 class="hasAnchor">
<a href="#different-palette" class="anchor"></a><span class="header-section-number">6.1</span> Different Palette</h2>
<p>Argument <code>col</code> can be used to provide a different colour palette (Fig. <a href="#fig:plotmat1">6.1</a>).</p>
<div class="sourceCode" id="cb47"><pre class="downlit">
<span class="fu"><a href="../reference/plot-methods.html">plot</a></span>(<span class="kw">laser</span>, <span class="st">"mat"</span>, col = <span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html">heat.colors</a></span>(<span class="fl">20</span>))
</pre></div>
<div class="figure" style="text-align: center">
<span id="fig:plotmat1"></span>
<img src="plotting_files/figure-html/plotmat1-1.png" alt="Spectra matrix with non-default palette.  "><p class="caption">
Figure 6.1: Spectra matrix with non-default palette.
</p>
</div>
<p>This is the same as:</p>
<div class="sourceCode" id="cb48"><pre class="downlit">
<span class="fu"><a href="../reference/plotmat.html">plotmat</a></span>(<span class="kw">laser</span>, col = <span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html">heat.colors</a></span>(<span class="fl">20</span>))
</pre></div>
</div>
<div id="different-y-axis" class="section level2">
<h2 class="hasAnchor">
<a href="#different-y-axis" class="anchor"></a><span class="header-section-number">6.2</span> Different Y-Axis</h2>
<p>Different extra data column can be used as y-axis (Fig. <a href="#fig:plotmat2">6.2</a>).</p>
<div class="sourceCode" id="cb49"><pre class="downlit">
<span class="fu"><a href="../reference/plotmat.html">plotmat</a></span>(<span class="kw">laser</span>, y = <span class="st">"t"</span>)
</pre></div>
<div class="figure" style="text-align: center">
<span id="fig:plotmat2"></span>
<img src="plotting_files/figure-html/plotmat2-1.png" alt="Spectra matrix with time (in column `t`) on y axis.    "><p class="caption">
Figure 6.2: Spectra matrix with time (in column <code>t</code>) on y axis.
</p>
</div>
<p>Alternatively, y values and axis label can be given separately.</p>
<div class="sourceCode" id="cb50"><pre class="downlit">
<span class="fu"><a href="../reference/plotmat.html">plotmat</a></span>(<span class="kw">laser</span>, y = <span class="kw">laser</span><span class="op">$</span><span class="kw">t</span>, ylab = <span class="fu"><a href="https://rdrr.io/r/base/labels.html">labels</a></span>(<span class="kw">laser</span>, <span class="st">"t"</span>))
</pre></div>
</div>
<div id="contour-lines" class="section level2">
<h2 class="hasAnchor">
<a href="#contour-lines" class="anchor"></a><span class="header-section-number">6.3</span> Contour Lines</h2>
<p>Contour lines may also be added (Fig. <a href="#fig:plotmat3">6.3</a>).</p>
<div class="sourceCode" id="cb51"><pre class="downlit">
<span class="fu"><a href="../reference/plotmat.html">plotmat</a></span>(<span class="kw">flu</span>, col = <span class="fu"><a href="../reference/matlab.palette.html">matlab.dark.palette</a></span>(<span class="fl">20</span>))
<span class="fu"><a href="../reference/plotmat.html">plotmat</a></span>(<span class="kw">flu</span>, col = <span class="st">"white"</span>, contour = <span class="fl">TRUE</span>, add = <span class="fl">TRUE</span>)
</pre></div>
<div class="figure" style="text-align: center">
<span id="fig:plotmat3"></span>
<img src="plotting_files/figure-html/plotmat3-1.png" alt="Spectra matrix with added contour lines.  "><p class="caption">
Figure 6.3: Spectra matrix with added contour lines.
</p>
</div>
</div>
<div id="colour-coded-points-special-panel-function" class="section level2">
<h2 class="hasAnchor">
<a href="#colour-coded-points-special-panel-function" class="anchor"></a><span class="header-section-number">6.4</span> Colour-Coded Points: Special Panel Function</h2>
<p>In <code class="sourceCode r"><span class="kw">levelplot</span>()</code>, colour-coded points may be set via special panel function (Fig. <a href="#fig:plotmap-barb">6.4</a>).</p>
<div class="sourceCode" id="cb52"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="st"><a href="http://latticeextra.r-forge.r-project.org">"latticeExtra"</a></span>)

<span class="kw">barb</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html">do.call</a></span>(<span class="kw">collapse</span>, <span class="kw">barbiturates</span>[<span class="fl">1</span><span class="op">:</span><span class="fl">50</span>])
<span class="kw">barb</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/orderwl.html">orderwl</a></span>(<span class="kw">barb</span>)
</pre></div>
<div class="sourceCode" id="cb53"><pre class="downlit">
<span class="fu">levelplot</span>(<span class="kw">spc</span> <span class="op">~</span> <span class="kw">.wavelength</span> <span class="op">*</span> <span class="kw">z</span>, <span class="kw">barb</span>,
  panel = <span class="kw">panel.levelplot.points</span>,
  cex = <span class="fl">.33</span>, col.symbol = <span class="fl">NA</span>,
  col.regions = <span class="kw">matlab.palette</span>
)
</pre></div>
<div class="figure" style="text-align: center">
<span id="fig:plotmap-barb"></span>
<img src="plotting_files/figure-html/plotmap-barb-1.png" alt="Colour-coded points via special panel function.  "><p class="caption">
Figure 6.4: Colour-coded points via special panel function.
</p>
</div>
</div>
</div>
<div id="fun-plotmap" class="section level1">
<h1 class="hasAnchor">
<a href="#fun-plotmap" class="anchor"></a><span class="header-section-number">7</span> False-Colour Maps: <code class="sourceCode r"><span class="kw">plotmap</span>()</code>
</h1>
<div id="plotmap" class="section level2">
<h2 class="hasAnchor">
<a href="#plotmap" class="anchor"></a><span class="header-section-number">7.1</span> Plotting map</h2>
<p>Function <code class="sourceCode r"><span class="kw">plotmap</span>()</code> is a specialized version of <code class="sourceCode r"><span class="kw">levelplot</span>()</code> (Fig. <a href="#fig:plotmap-clu">7.3</a>).
The spectral intensities may be summarized by a function before plotting (default: <code class="sourceCode r"><span class="kw">mean</span>()</code>).
The same scale is used for x and y axes (<code class="sourceCode r">aspect =<span class="st"> "iso"</span></code>).</p>
<div class="sourceCode" id="cb54"><pre class="downlit">
<span class="fu"><a href="../reference/plotmap.html">plotmap</a></span>(<span class="kw">chondro</span>)
</pre></div>
<div class="figure" style="text-align: center">
<span id="fig:plotmap-chondro"></span>
<img src="plotting_files/figure-html/plotmap-chondro-1.png" alt="An example of a false colour map.  "><p class="caption">
Figure 7.1: An example of a false colour map.
</p>
</div>
</div>
<div id="plotmap-manual-xy" class="section level2">
<h2 class="hasAnchor">
<a href="#plotmap-manual-xy" class="anchor"></a><span class="header-section-number">7.2</span> Plotting Maps with Manually Specified X and Y Axes</h2>
<p>Specify the colour-coded variable, abscissa and ordinate as formula: <code class="sourceCode r">colour.coded <span class="op">~</span><span class="st"> </span>abscissa <span class="op">*</span><span class="st"> </span>ordinate</code> (Fig. <a href="#fig:plotmap-yx">7.2</a>).</p>
<div class="sourceCode" id="cb55"><pre class="downlit">
<span class="fu"><a href="../reference/plotmap.html">plotmap</a></span>(<span class="kw">chondro</span>, <span class="kw">spc</span> <span class="op">~</span> <span class="kw">y</span> <span class="op">*</span> <span class="kw">x</span>)
</pre></div>
<div class="figure" style="text-align: center">
<span id="fig:plotmap-yx"></span>
<img src="plotting_files/figure-html/plotmap-yx-1.png" alt="False colour map with an explicit specification of x and y axes.  "><p class="caption">
Figure 7.2: False colour map with an explicit specification of x and y axes.
</p>
</div>
</div>
<div id="discrete-colours" class="section level2">
<h2 class="hasAnchor">
<a href="#discrete-colours" class="anchor"></a><span class="header-section-number">7.3</span> Discrete Colours</h2>
<p>Factor variables may be used for discrete colour coding (Fig. <a href="#fig:plotmap-clu">7.3</a>).</p>
<div class="sourceCode" id="cb56"><pre class="downlit">
<span class="fu"><a href="../reference/plotmap.html">plotmap</a></span>(<span class="kw">chondro</span>, <span class="kw">clusters</span> <span class="op">~</span> <span class="kw">x</span> <span class="op">*</span> <span class="kw">y</span>)
</pre></div>
<div class="figure" style="text-align: center">
<span id="fig:plotmap-clu"></span>
<img src="plotting_files/figure-html/plotmap-clu-1.png" alt="False colour map with colours defined by a factor variable.  "><p class="caption">
Figure 7.3: False colour map with colours defined by a factor variable.
</p>
</div>
<p>If the colour-coded variable is a factor, each level gets its own colour, and the legend is labelled accordingly.</p>
</div>
<div id="different-palette-1" class="section level2">
<h2 class="hasAnchor">
<a href="#different-palette-1" class="anchor"></a><span class="header-section-number">7.4</span> Different Palette</h2>
<p>To use a different palette, use argument <code class="sourceCode r">col.regions</code> (Fig. <a href="#fig:plotmap-col">7.4</a>).</p>
<div class="sourceCode" id="cb57"><pre class="downlit">
<span class="fu"><a href="../reference/plotmap.html">plotmap</a></span>(<span class="kw">chondro</span>, <span class="kw">clusters</span> <span class="op">~</span> <span class="kw">x</span> <span class="op">*</span> <span class="kw">y</span>,
  col.regions = <span class="kw">cluster.cols</span>
)
</pre></div>
<div class="figure" style="text-align: center">
<span id="fig:plotmap-col"></span>
<img src="plotting_files/figure-html/plotmap-col-1.png" alt="False colour map with non-default colour palette.  "><p class="caption">
Figure 7.4: False colour map with non-default colour palette.
</p>
</div>
</div>
</div>
<div id="fine-tuning-lattice-parameters" class="section level1">
<h1 class="hasAnchor">
<a href="#fine-tuning-lattice-parameters" class="anchor"></a><span class="header-section-number">8</span> Fine-Tuning <strong><em>lattice</em></strong> Parameters</h1>
<p>The plotting of colour maps is done via R package <strong>lattice</strong> (aka Trellis graphic approach), which is highly customizable.
Use function <code class="sourceCode r"><span class="kw">trellis.par.get</span>()</code> and <code class="sourceCode r"><span class="kw">trellis.par.set</span>()</code> to get/set the settings for the current graphics device.</p>
<div class="sourceCode" id="cb58"><pre class="downlit">
<span class="kw">my.theme</span> <span class="op">&lt;-</span> <span class="fu">trellis.par.get</span>()
<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span>(<span class="kw">my.theme</span>) <span class="co"># note how many parameters are tunable</span>
<span class="co">#&gt;  [1] "grid.pars"         "fontsize"          "background"        "panel.background" </span>
<span class="co">#&gt;  [5] "clip"              "add.line"          "add.text"          "plot.polygon"     </span>
<span class="co">#&gt;  [9] "box.dot"           "box.rectangle"     "box.umbrella"      "dot.line"         </span>
<span class="co">#&gt; [13] "dot.symbol"        "plot.line"         "plot.symbol"       "reference.line"   </span>
<span class="co">#&gt; [17] "strip.background"  "strip.shingle"     "strip.border"      "superpose.line"   </span>
<span class="co">#&gt; [21] "superpose.symbol"  "superpose.polygon" "regions"           "shade.colors"     </span>
<span class="co">#&gt; [25] "axis.line"         "axis.text"         "axis.components"   "layout.heights"   </span>
<span class="co">#&gt; [29] "layout.widths"     "box.3d"            "par.xlab.text"     "par.ylab.text"    </span>
<span class="co">#&gt; [33] "par.zlab.text"     "par.main.text"     "par.sub.text"</span>
</pre></div>
<p>Any of these parameters can be fine-tuned to produce the desired output.
For example, parameter <code class="sourceCode r">my.theme<span class="op">$</span>region</code> is responsible for the appearance of color maps, and it contains elements <code class="sourceCode r"><span class="op">$</span>alpha</code> and <code class="sourceCode r"><span class="op">$</span>col</code>.
By changing these parameters you can create your own theme for plotting and pass it to the plotting function via <code class="sourceCode r">par.settings</code>.</p>
<div id="changed-palette" class="section level2">
<h2 class="hasAnchor">
<a href="#changed-palette" class="anchor"></a><span class="header-section-number">8.1</span> Changed Palette</h2>
<p>Fig. <a href="#fig:plotmap-col-default">8.1</a> uses a customized <strong>lattice</strong> theme.</p>
<div class="sourceCode" id="cb59"><pre class="downlit">
<span class="kw">my.theme</span><span class="op">$</span><span class="kw">regions</span><span class="op">$</span><span class="kw">col</span> <span class="op">&lt;-</span> <span class="kw">grDevices</span>::<span class="kw"><a href="https://rdrr.io/r/grDevices/palettes.html">terrain.colors</a></span>
<span class="fu"><a href="../reference/plotmap.html">plotmap</a></span>(<span class="kw">chondro</span>, par.settings = <span class="kw">my.theme</span>)
</pre></div>
<div class="figure" style="text-align: center">
<span id="fig:plotmap-col-default"></span>
<img src="plotting_files/figure-html/plotmap-col-default-1.png" alt="A false-colour map that uses `terrain.colors` palette.   "><p class="caption">
Figure 8.1: A false-colour map that uses <code>terrain.colors</code> palette.
</p>
</div>
<p>It is possible to <strong>persistently</strong> (i.e. inside of the current R session) set <strong>lattice</strong> parameters, so they would apply to all further plots.
This is done via a call to <code class="sourceCode r"><span class="kw">trellis.par.set</span>()</code>, for example <code class="sourceCode r"><span class="kw">trellis.par.set</span>(my.theme)</code>.</p>
<p>The current settings can be visualized via a call to <code class="sourceCode r"><span class="kw">show.settings</span>()</code></p>
</div>
<div id="show-current-lattice-settings" class="section level2">
<h2 class="hasAnchor">
<a href="#show-current-lattice-settings" class="anchor"></a><span class="header-section-number">8.2</span> Show Current <strong><em>lattice</em></strong> Settings</h2>
<p>Graphical parameters for <em>trellis</em> may be displayed via <code class="sourceCode r"><span class="kw">show.settings</span>()</code> (Fig. <a href="#fig:lattice-settings">8.2</a>).</p>
<div class="sourceCode" id="cb60"><pre class="downlit">
<span class="co"># Display current trellis parameters</span>
<span class="fu">show.settings</span>()
</pre></div>
<div class="sourceCode" id="cb61"><pre class="downlit">
<span class="fu">show.settings</span>(<span class="kw">my.theme</span>)
</pre></div>
<div class="figure" style="text-align: center">
<span id="fig:lattice-settings"></span>
<img src="plotting_files/figure-html/lattice-settings-1.png" alt="Show **lattice** settings.  "><p class="caption">
Figure 8.2: Show <strong>lattice</strong> settings.
</p>
</div>
<p>An overview of different colour palettes, and ways to create your own, can be found
in the <a href="https://www.nceas.ucsb.edu/~frazier/RSpatialGuides/colorPaletteCheatsheet.pdf">R colour cheatsheet</a>.</p>
</div>
<div id="defined-wavelengths" class="section level2">
<h2 class="hasAnchor">
<a href="#defined-wavelengths" class="anchor"></a><span class="header-section-number">8.3</span> Defined Wavelengths</h2>
<p>A map of the average intensity at particular wavelengths can be plotted if the wavelengths of interested are explicitly extracted (Fig. <a href="#fig:plotmap-wave">8.3</a>).</p>
<div class="sourceCode" id="cb62"><pre class="downlit">
<span class="fu"><a href="../reference/plotmap.html">plotmap</a></span>(<span class="kw">chondro.preproc</span>[, , <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(
  <span class="fl">728</span>, <span class="fl">782</span>, <span class="fl">1098</span>,
  <span class="fl">1240</span>, <span class="fl">1482</span>, <span class="fl">1577</span>
)],
col.regions = <span class="kw">matlab.palette</span>
)
</pre></div>
<div class="figure" style="text-align: center">
<span id="fig:plotmap-wave"></span>
<img src="plotting_files/figure-html/plotmap-wave-1.png" alt="A map of average intensity at explicitly indicated wavelengths.  "><p class="caption">
Figure 8.3: A map of average intensity at explicitly indicated wavelengths.
</p>
</div>
</div>
<div id="conditioning" class="section level2">
<h2 class="hasAnchor">
<a href="#conditioning" class="anchor"></a><span class="header-section-number">8.4</span> Conditioning</h2>
<p>Logical conditions may be used to create subplots (Fig. <a href="#fig:plotmap-pca">8.4</a>).</p>
<div class="sourceCode" id="cb63"><pre class="downlit">
<span class="fu"><a href="../reference/plotmap.html">plotmap</a></span>(<span class="kw">chondro</span>,
  <span class="kw">spc</span> <span class="op">~</span> <span class="kw">y</span> <span class="op">*</span> <span class="kw">x</span> <span class="op">|</span> <span class="kw">x</span> <span class="op">&gt;</span> <span class="fl">5</span>,
  col.regions = <span class="fu"><a href="../reference/matlab.palette.html">matlab.palette</a></span>(<span class="fl">20</span>)
)
</pre></div>
<div class="figure" style="text-align: center">
<span id="fig:plotmap-pca"></span>
<img src="plotting_files/figure-html/plotmap-pca-1.png" alt="Subplots created by logical conditions.  "><p class="caption">
Figure 8.4: Subplots created by logical conditions.
</p>
</div>
</div>
<div id="conditioning-on--wavelength" class="section level2">
<h2 class="hasAnchor">
<a href="#conditioning-on--wavelength" class="anchor"></a><span class="header-section-number">8.5</span> Conditioning on <code class="sourceCode r">.wavelength</code>
</h2>
<p>Function <code class="sourceCode r"><span class="kw">plotmap</span>()</code> automatically applies the function in <code class="sourceCode r">func</code> before plotting.
Argument <code class="sourceCode r">func</code> defaults to function <code class="sourceCode r"><span class="kw">mean</span>()</code>.
In order to suppress this, use <code class="sourceCode r">func =<span class="st"> </span><span class="ot">NULL</span></code>.
This allows conditioning on the wavelengths.</p>
<p>Fig. <a href="#fig:plotmap-pca2">8.5</a> demonstrates an example to plot the maps of principal components scores.</p>
<div class="sourceCode" id="cb64"><pre class="downlit">
<span class="kw">pca</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/prcomp.html">prcomp</a></span>(<span class="op">~</span><span class="kw">spc</span>, data = <span class="kw">chondro.preproc</span><span class="op">$</span><span class="kw">.</span>)

<span class="kw">scores</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/decomposition.html">decomposition</a></span>(<span class="kw">chondro</span>, <span class="kw">pca</span><span class="op">$</span><span class="kw">x</span>,
  label.wavelength = <span class="st">"PC"</span>,
  label.spc = <span class="st">"score /  a.u."</span>
)

<span class="fu"><a href="../reference/plotmap.html">plotmap</a></span>(<span class="kw">scores</span>[, , <span class="fl">1</span><span class="op">:</span><span class="fl">2</span>],
  <span class="kw">spc</span> <span class="op">~</span> <span class="kw">y</span> <span class="op">*</span> <span class="kw">x</span> <span class="op">|</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span>(<span class="kw">.wavelength</span>),
  func = <span class="kw">NULL</span>,
  col.regions = <span class="fu"><a href="../reference/matlab.palette.html">matlab.palette</a></span>(<span class="fl">20</span>)
)
</pre></div>
<div class="figure" style="text-align: center">
<span id="fig:plotmap-pca2"></span>
<img src="plotting_files/figure-html/plotmap-pca2-1.png" alt="The maps of the scores of the first two principal components (I).  "><p class="caption">
Figure 8.5: The maps of the scores of the first two principal components (I).
</p>
</div>
<p>Alternatively, use <code class="sourceCode r"><span class="kw">levelplot</span>()</code> directly (Fig. <a href="#fig:plotmap-pca3">8.6</a>).</p>
<div class="sourceCode" id="cb65"><pre class="downlit">
<span class="fu">levelplot</span>(<span class="kw">spc</span> <span class="op">~</span> <span class="kw">y</span> <span class="op">*</span> <span class="kw">x</span> <span class="op">|</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span>(<span class="kw">.wavelength</span>),
  <span class="kw">scores</span>[, , <span class="fl">1</span><span class="op">:</span><span class="fl">2</span>],
  aspect = <span class="st">"iso"</span>,
  col.regions = <span class="fu"><a href="../reference/matlab.palette.html">matlab.palette</a></span>(<span class="fl">20</span>)
)
</pre></div>
<div class="figure" style="text-align: center">
<span id="fig:plotmap-pca3"></span>
<img src="plotting_files/figure-html/plotmap-pca3-1.png" alt="The maps of the scores of the first two principal components (II).  "><p class="caption">
Figure 8.6: The maps of the scores of the first two principal components (II).
</p>
</div>
</div>
<div id="voronoi-plot" class="section level2">
<h2 class="hasAnchor">
<a href="#voronoi-plot" class="anchor"></a><span class="header-section-number">8.6</span> Voronoi Plot</h2>
<p>Fig. <a href="#fig:voronoi-2">8.7</a> shows an example of a Voronoi plot.
Voronoi uses <code class="sourceCode r"><span class="kw">panel.voronoi</span>()</code> from package <strong>latticeExtra</strong><span class="citation">[<a href="#ref-latticeExtra" role="doc-biblioref">4</a>]</span>.
The tesselation is calculated by default using package <strong>deldir</strong><span class="citation">[<a href="#ref-deldir" role="doc-biblioref">5</a>]</span>, but package <strong>tripack</strong><span class="citation">[<a href="#ref-tripack" role="doc-biblioref">1</a>]</span> can also be used.
Package <strong>tripack</strong> seems to be faster in general, but may “hang” with certain data sets (particularly regular grids with missing spectra as in this example).
Furthermore, it is not FOSS (free and open-source software), so users are kindly asked to review package <strong>tripack</strong>’s license before using it.</p>
<div class="sourceCode" id="cb66"><pre class="downlit">
<span class="fu"><a href="../reference/plotmap.html">plotvoronoi</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span>(<span class="kw">chondro</span>, <span class="fl">300</span>), <span class="kw">clusters</span> <span class="op">~</span> <span class="kw">x</span> <span class="op">*</span> <span class="kw">y</span>,
  col.regions = <span class="fu"><a href="../reference/matlab.palette.html">matlab.palette</a></span>(<span class="fl">20</span>)
)
</pre></div>
<div class="figure" style="text-align: center">
<span id="fig:voronoi-2"></span>
<img src="plotting_files/figure-html/voronoi-2-1.png" alt="Voronoi plot that uses non-default discrette colour palette.  "><p class="caption">
Figure 8.7: Voronoi plot that uses non-default discrette colour palette.
</p>
</div>
</div>
<div id="mark-missing-spectra" class="section level2">
<h2 class="hasAnchor">
<a href="#mark-missing-spectra" class="anchor"></a><span class="header-section-number">8.7</span> Mark Missing Spectra</h2>
<p>If the spectra come from a rectangular grid, missing positions can be marked with the following panel function:</p>
<div class="sourceCode" id="cb67"><pre class="downlit">
<span class="kw">mark.missing</span> <span class="op">&lt;-</span> <span class="fu">function</span>(<span class="kw">x</span>, <span class="kw">y</span>, <span class="kw">z</span>, <span class="kw">...</span>) {
  <span class="fu">panel.levelplot</span>(<span class="kw">x</span>, <span class="kw">y</span>, <span class="kw">z</span>, <span class="kw">...</span>)

  <span class="kw">miss</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html">expand.grid</a></span>(x = <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span>(<span class="kw">x</span>), y = <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span>(<span class="kw">y</span>))
  <span class="kw">miss</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/merge,hyperSpec,hyperSpec-method.html">merge</a></span>(<span class="kw">miss</span>, <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="kw">x</span>, <span class="kw">y</span>, <span class="fl">TRUE</span>), all.x = <span class="fl">TRUE</span>)
  <span class="kw">miss</span> <span class="op">&lt;-</span> <span class="kw">miss</span>[<span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span>(<span class="kw">miss</span>[, <span class="fl">3</span>]), ]
  <span class="fu">panel.xyplot</span>(<span class="kw">miss</span>[, <span class="fl">1</span>], <span class="kw">miss</span>[, <span class="fl">2</span>], pch = <span class="fl">4</span>, <span class="kw">...</span>)
}
</pre></div>
<p>Fig. <a href="#fig:missing">8.8</a> shows the result.</p>
<div class="sourceCode" id="cb68"><pre class="downlit">
<span class="fu"><a href="../reference/plotmap.html">plotmap</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span>(<span class="kw">chondro</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="kw">chondro</span>) <span class="op">-</span> <span class="fl">20</span>),
  col.regions = <span class="fu"><a href="../reference/matlab.palette.html">matlab.palette</a></span>(<span class="fl">20</span>),
  col = <span class="st">"black"</span>,
  panel = <span class="kw">mark.missing</span>
)
</pre></div>
<div class="figure" style="text-align: center">
<span id="fig:missing"></span>
<img src="plotting_files/figure-html/missing-1.png" alt="Marks of missing spectra in a false-colour map.  "><p class="caption">
Figure 8.8: Marks of missing spectra in a false-colour map.
</p>
</div>
</div>
<div id="unevenly-spaced-measurement-grid" class="section level2">
<h2 class="hasAnchor">
<a href="#unevenly-spaced-measurement-grid" class="anchor"></a><span class="header-section-number">8.8</span> Unevenly Spaced Measurement Grid</h2>
<p>The panel function used by <code class="sourceCode r"><span class="kw">plotmap</span>()</code> defaults to <code class="sourceCode r"><span class="kw">panel.levelplot.raster</span>()</code> which assumes an evenly spaced measurement grid.
Even if the spectra are measured on a nominally evenly spaced grid, the actual stage position may slightly vary due to positioning inaccuracy and some manufacturers (e.g., Kaiser) record the position reported by the stage rather than the position requested by the stage control.
This leads to weird-looking output with holes, and possibly wrong columns (Fig. <a href="#fig:uneven-I">8.9</a>).</p>
<div class="sourceCode" id="cb69"><pre class="downlit">
<span class="fu"><a href="../reference/plotmap.html">plotmap</a></span>(<span class="kw">uneven</span>)
<span class="co">#&gt; Warning in (function (x, y, z, subscripts, at = pretty(z), ..., col.regions = regions$col, : 'x'</span>
<span class="co">#&gt; values are not equispaced; output may be wrong</span>
<span class="co">#&gt; Warning in (function (x, y, z, subscripts, at = pretty(z), ..., col.regions = regions$col, : 'y'</span>
<span class="co">#&gt; values are not equispaced; output may be wrong</span>
</pre></div>
<div class="figure" style="text-align: center">
<span id="fig:uneven-I"></span>
<img src="plotting_files/figure-html/uneven-I-1.png" alt="Unevenly spaced measurement grid: example I.
Note warnings `values are not equispaced; output may be wrong`."><p class="caption">
Figure 8.9: Unevenly spaced measurement grid: example I.
Note warnings <code>values are not equispaced; output may be wrong</code>.
</p>
</div>
<p>The symptom of this situation are warnings about values in x and/or y not being equispaced; and that the output, therefore, may be wrong.</p>
<p>One possibility to obtain a correct map is using <code class="sourceCode r"><span class="kw">plotvoronoi</span>()</code> instead which will construct a mosaic-like image with the respective “pixel” areas being centred around the actually recorded <code>$x</code> and <code>$y</code> position (Fig. <a href="#fig:uneven-II">8.10</a>).</p>
<div class="sourceCode" id="cb70"><pre class="downlit">
<span class="fu"><a href="../reference/plotmap.html">plotvoronoi</a></span>(<span class="kw">uneven</span>)
</pre></div>
<div class="figure" style="text-align: center">
<span id="fig:uneven-II"></span>
<img src="plotting_files/figure-html/uneven-II-1.png" alt="Unevenly spaced measurement grid: example II.  "><p class="caption">
Figure 8.10: Unevenly spaced measurement grid: example II.
</p>
</div>
<p>Another possibility that underlines a point shape of the measurements is switching to <code class="sourceCode r">latticeExtra<span class="op">::</span><span class="kw">panel.levelplot.points</span>()</code> (Fig. <a href="#fig:uneven-III">8.11</a>).</p>
<div class="sourceCode" id="cb71"><pre class="downlit">
<span class="fu"><a href="../reference/plotmap.html">plotmap</a></span>(<span class="kw">uneven</span>,
  panel = <span class="kw">panel.levelplot.points</span>,
  cex = <span class="fl">0.75</span>,
  col.symbol = <span class="fl">NA</span>
)
</pre></div>
<div class="figure" style="text-align: center">
<span id="fig:uneven-III"></span>
<img src="plotting_files/figure-html/uneven-III-1.png" alt="Unevenly spaced measurement grid: example III.  "><p class="caption">
Figure 8.11: Unevenly spaced measurement grid: example III.
</p>
</div>
<p>Alternatively, the measurement raster positions can be rounded to their nominal raster (e.g. Fig. <a href="#fig:uneven-IV">8.12</a>).</p>
<div class="sourceCode" id="cb72"><pre class="downlit">
<span class="kw">rx</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/makeraster.html">makeraster</a></span>(<span class="kw">uneven</span><span class="op">$</span><span class="kw">x</span>, startx = <span class="op">-</span><span class="fl">11.55</span>, d = <span class="fl">1</span>, tol = <span class="fl">0.3</span>)
<span class="kw">uneven</span><span class="op">$</span><span class="kw">x</span> <span class="op">&lt;-</span> <span class="kw">rx</span><span class="op">$</span><span class="kw">x</span>

<span class="kw">ry</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/makeraster.html">makeraster</a></span>(<span class="kw">uneven</span><span class="op">$</span><span class="kw">y</span>, startx = <span class="op">-</span><span class="fl">4.77</span>, d = <span class="fl">1</span>, tol = <span class="fl">0.3</span>)
<span class="kw">uneven</span><span class="op">$</span><span class="kw">y</span> <span class="op">&lt;-</span> <span class="kw">ry</span><span class="op">$</span><span class="kw">x</span>

<span class="fu"><a href="../reference/plotmap.html">plotmap</a></span>(<span class="kw">uneven</span>)
</pre></div>
<div class="figure" style="text-align: center">
<span id="fig:uneven-IV"></span>
<img src="plotting_files/figure-html/uneven-IV-1.png" alt="Unevenly spaced measurement grid: example IV.  "><p class="caption">
Figure 8.12: Unevenly spaced measurement grid: example IV.
</p>
</div>
</div>
</div>
<div id="plots-3d" class="section level1">
<h1 class="hasAnchor">
<a href="#plots-3d" class="anchor"></a><span class="header-section-number">9</span> 3D Plots (with package <strong><em>rgl</em></strong>)</h1>
<p>Package <strong>rgl</strong><span class="citation">[<a href="#ref-rgl" role="doc-biblioref">6</a>]</span> offers fast 3d plotting in R.
As package <strong>rgl</strong>’s axis annotations are sometimes awkward, they may better be set manually:</p>
<!-- evaluation in rgl-do -->
<div class="sourceCode" id="cb73"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="kw"><a href="https://r-forge.r-project.org/projects/rgl">rgl</a></span>)

<span class="kw">laser</span> <span class="op">&lt;-</span> <span class="kw">laser</span> [, , <span class="fl">404.8</span> <span class="op">~</span> <span class="fl">405.6</span>] <span class="op">/</span> <span class="fl">10000</span>
<span class="kw">laser</span><span class="op">$</span><span class="kw">t</span> <span class="op">&lt;-</span> <span class="kw">laser</span><span class="op">$</span><span class="kw">t</span> <span class="op">/</span> <span class="fl">3600</span>
<span class="kw">cols</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fu"><a href="../reference/matlab.palette.html">matlab.palette</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="kw">laser</span>)), <span class="fu"><a href="../reference/ncol,hyperSpec-method.html">nwl</a></span>(<span class="kw">laser</span>))
<span class="fu"><a href="https://rdrr.io/pkg/rgl/man/surface3d.html">surface3d</a></span>(
  y = <span class="fu"><a href="../reference/wl.html">wl</a></span>(<span class="kw">laser</span>), x = <span class="kw">laser</span><span class="op">$</span><span class="kw">t</span>,
  z = <span class="kw">laser</span><span class="op">$</span><span class="kw">spc</span>, col = <span class="kw">cols</span>
)
<span class="fu"><a href="https://rdrr.io/pkg/rgl/man/aspect3d.html">aspect3d</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">0.25</span>))
<span class="fu"><a href="https://rdrr.io/pkg/rgl/man/axes3d.html">axes3d</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"x+-"</span>, <span class="st">"y--"</span>, <span class="st">"z--"</span>))
<span class="fu"><a href="https://rdrr.io/pkg/rgl/man/axes3d.html">axes3d</a></span>(<span class="st">"y--"</span>, nticks = <span class="fl">25</span>, labels = <span class="fl">FALSE</span>)
<span class="fu"><a href="https://rdrr.io/pkg/rgl/man/axes3d.html">mtext3d</a></span>(<span class="st">"t / h"</span>, <span class="st">"x+-"</span>, line = <span class="fl">2.5</span>)
<span class="fu"><a href="https://rdrr.io/pkg/rgl/man/axes3d.html">mtext3d</a></span>(<span class="st">"lambda / nm"</span>, <span class="st">"y--"</span>, line = <span class="fl">2.5</span>)
<span class="fu"><a href="https://rdrr.io/pkg/rgl/man/axes3d.html">mtext3d</a></span>(<span class="st">"I / a.u."</span>, edge = <span class="st">"z--"</span>, line = <span class="fl">2.5</span>)
</pre></div>
<div class="figure" style="text-align: center">
<span id="fig:rgl-plot-png"></span>
<img src="plotting--fig-3D-01.png" alt="A snapshot of an **rgl** plot.  " width="100%"><p class="caption">
Figure 9.1: A snapshot of an <strong>rgl</strong> plot.
</p>
</div>
<!-- ======================================================================= -->
<!-- ======================================================================= -->
</div>
<div id="plots-ggplot2" class="section level1">
<h1 class="hasAnchor">
<a href="#plots-ggplot2" class="anchor"></a><span class="header-section-number">10</span> Using <strong><em>ggplot2</em></strong> with <strong><em>hyperSpec</em></strong> objects</h1>
<p>Class <code class="sourceCode r">hyperSpec</code> objects do not yet directly support plotting with package <strong>ggplot2</strong><span class="citation">[<a href="#ref-ggplot2" role="doc-biblioref">7</a>]</span>.
Nevertheless, package <strong>ggplot2</strong> graphics can easily be obtained, and <code class="sourceCode r">qplot<span class="op">*</span></code> equivalents to <code class="sourceCode r"><span class="kw">plotspc</span>()</code> and <code class="sourceCode r"><span class="kw">plotmap</span>()</code>.</p>
<div id="qplotspc" class="section level2">
<h2 class="hasAnchor">
<a href="#qplotspc" class="anchor"></a><span class="header-section-number">10.1</span> Function <code class="sourceCode r"><span class="kw">qplotspc</span>()</code>
</h2>
<p>Plot spectra with <code class="sourceCode r"><span class="kw">qplotspc</span>()</code> (Fig. <a href="#fig:ggplotspc">10.1</a>).<!-- `as.long.df()`{.r}" --></p>
<div class="sourceCode" id="cb74"><pre class="downlit">
<span class="fu"><a href="../reference/qplotspc.html">qplotspc</a></span>(<span class="kw">flu</span>) <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(colour = <span class="kw">c</span>)
</pre></div>
<div class="figure" style="text-align: center">
<span id="fig:ggplotspc"></span>
<img src="plotting_files/figure-html/ggplotspc-1.png" alt="Plot spectra with `as.long.df()`{.r}  "><p class="caption">
Figure 10.1: Plot spectra with <code class="sourceCode r"><span class="kw">as.long.df</span>()</code>
</p>
</div>
</div>
<div id="ggplotmap" class="section level2">
<h2 class="hasAnchor">
<a href="#ggplotmap" class="anchor"></a><span class="header-section-number">10.2</span> Function <code class="sourceCode r"><span class="kw">ggplotmap</span>()</code>
</h2>
<p>Fig. <a href="#fig:ggplotmap">10.2</a> shows a map created with package <strong>ggplot2</strong>.</p>
<div class="sourceCode" id="cb75"><pre class="downlit">
<span class="fu"><a href="../reference/qplotmap.html">qplotmap</a></span>(<span class="kw">chondro</span>) <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html">scale_fill_gradientn</a></span>(<span class="st">"spc"</span>, colours = <span class="fu"><a href="../reference/matlab.palette.html">matlab.palette</a></span>())
</pre></div>
<div class="figure" style="text-align: center">
<span id="fig:ggplotmap"></span>
<img src="plotting_files/figure-html/ggplotmap-1.png" alt="False-colour map with package **ggplot2**  "><p class="caption">
Figure 10.2: False-colour map with package <strong>ggplot2</strong>
</p>
</div>
<p>The two special columns <code class="sourceCode r">.wavelength</code> and <code class="sourceCode r">.rownames</code> contain the wavelength axis and allow to distinguish the spectra.</p>
</div>
<div id="general-plotting-ggplot2" class="section level2">
<h2 class="hasAnchor">
<a href="#general-plotting-ggplot2" class="anchor"></a><span class="header-section-number">10.3</span> More General Plotting with <strong><em>ggplot2</em></strong>
</h2>
<p>For more general plotting, <code class="sourceCode r"><span class="kw">as.long.df</span>()</code> transforms a <code class="sourceCode r">hyperSpec</code> object into a long-form <code class="sourceCode r">data.frame</code> that is suitable for <code class="sourceCode r"><span class="kw">qplot</span>()</code>, while <code class="sourceCode r"><span class="kw">as.t.df</span>()</code> produces a <code class="sourceCode r">data.frame</code> where each spectrum is one column, and an additional first column gives the wavelength.
Long <code class="sourceCode r">data.frame</code>s can be <em>very</em> memory consuming as they are of size <span class="math inline">\(nrow · nwl × (ncol + 2)\)</span> with respect to the dimensions of the <code class="sourceCode r">hyperSpec</code> object.
Thus, e.g., the <code class="sourceCode r">chondro</code> data set (2 MB) as <code class="sourceCode r">hyperSpec</code> object) needs 28 MB as long-format <code class="sourceCode r">data.frame</code>.
It is therefore highly recommended to calculate the particular data to be plotted beforehand<!-- (Fig. \@ref(fig:ggplotmeansd))-->.</p>
<div class="sourceCode" id="cb76"><pre class="downlit">
<span class="fu"><a href="../reference/qplotspc.html">qplotspc</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span>(<span class="kw">chondro</span>)) <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html">geom_ribbon</a></span>(<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(
    ymin = <span class="kw">mean</span> <span class="op">+</span> <span class="kw">sd</span>,
    ymax = <span class="kw">mean</span> <span class="op">-</span> <span class="kw">sd</span>,
    y = <span class="fl">0</span>,
    group = <span class="fl">NA</span>
  ),
  alpha = <span class="fl">0.25</span>,
  data = <span class="fu"><a href="../reference/as.data.frame.html">as.t.df</a></span>(<span class="fu"><a href="../reference/mean_sd,numeric-method.html">mean_sd</a></span>(<span class="kw">chondro</span>))
  )
</pre></div>
<p>Note that <code class="sourceCode r"><span class="kw">qpotspc</span>()</code> specifies aesthetics <code>y = spc</code> and <code>groups = .rownames</code>, which do not have corresponding columns in the <code>data.frame</code> returned by <code class="sourceCode r"><span class="kw">as.t.df</span>()</code>.
These aesthetics must therefore be set manually in the aesthetics definition in <code class="sourceCode r"><span class="kw">geom_ribbon</span>()</code> (or any other <code class="sourceCode r">geom_<span class="op">*</span>()</code> that uses <code class="sourceCode r"><span class="kw">as.t.df</span>()</code>).
Otherwise, errors occur that object <code>spc</code> (and/or <code>.rownames</code>) cannot be found.
Cut axes can be implemented by faceting (Fig. <a href="#fig:ggplotspccut">10.3</a>).</p>
<div class="sourceCode" id="cb77"><pre class="downlit">
<span class="fu"><a href="../reference/qplotspc.html">qplotspc</a></span>(<span class="kw">paracetamol</span> <span class="op">/</span> <span class="fl">1e4</span>, wl.range = <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="kw">min</span> <span class="op">~</span> <span class="fl">1800</span>, <span class="fl">2800</span> <span class="op">~</span> <span class="kw">max</span>)) <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous</a></span>(breaks = <span class="fu"><a href="../reference/seq.hyperSpec.html">seq</a></span>(<span class="fl">0</span>, <span class="fl">3200</span>, <span class="fl">400</span>))
</pre></div>
<div class="figure" style="text-align: center">
<span id="fig:ggplotspccut"></span>
<img src="plotting_files/figure-html/ggplotspccut-1.png" alt="Cut spectra with package **ggplot2**.   "><p class="caption">
Figure 10.3: Cut spectra with package <strong>ggplot2</strong>.
</p>
</div>
<!-- ======================================================================= -->
<!-- ======================================================================= -->
</div>
</div>
<div id="interactive-plots" class="section level1">
<h1 class="hasAnchor">
<a href="#interactive-plots" class="anchor"></a><span class="header-section-number">11</span> Interactive Graphics</h1>
<p>Package <strong>hyperSpec</strong> offers basic interaction, <code class="sourceCode r"><span class="kw">spc.identify</span>()</code> for spectra plots, and <code class="sourceCode r"><span class="kw">map.identify</span>()</code> and <code class="sourceCode r"><span class="kw">map.sel.poly</span>()</code> for maps.
The first two identify points in spectra plots and map plots, respectively.
Function <code class="sourceCode r"><span class="kw">map.sel.poly</span>()</code> selects the part of a <code class="sourceCode r">hyperSpec</code> object that lies inside the user defined polygon.</p>
<div id="sec:spc-identify" class="section level2">
<h2 class="hasAnchor">
<a href="#sec:spc-identify" class="anchor"></a><span class="header-section-number">11.1</span> <code class="sourceCode r"><span class="kw">spc.identify</span>()</code> Finding Out Wavelength, Intensity and Spectrum</h2>
<p>Function <code class="sourceCode r"><span class="kw">spc.identify</span>()</code> allows to measure points in graphics produced by <code class="sourceCode r"><span class="kw">plotspc</span>()</code>.
It works correctly with reversed and cut wavelength axes.</p>
<div class="sourceCode" id="cb78"><pre class="downlit">
<span class="fu"><a href="../reference/spc.identify.html">spc.identify</a></span>(<span class="fu"><a href="../reference/plotspc.html">plotspc</a></span>(<span class="kw">paracetamol</span>, wl.range = <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">600</span> <span class="op">~</span> <span class="fl">1800</span>, <span class="fl">2800</span> <span class="op">~</span> <span class="fl">3200</span>), xoffset = <span class="fl">800</span>))
</pre></div>
<p>The result is a data.frame with the indices of the spectra, the wavelength, and its intensity.</p>
</div>
<div id="sec:map-identify" class="section level2">
<h2 class="hasAnchor">
<a href="#sec:map-identify" class="anchor"></a><span class="header-section-number">11.2</span> <code class="sourceCode r"><span class="kw">map.identify</span>()</code> finding a spectrum in a map plot</h2>
<p>Function <code class="sourceCode r"><span class="kw">map.identify</span>()</code> returns the spectra indices of the clicked points.</p>
<div class="sourceCode" id="cb79"><pre class="downlit">
<span class="fu"><a href="../reference/plotmap.html">map.identify</a></span>(<span class="kw">chondro</span>)
</pre></div>
</div>
<div id="sec:map-sel-poly" class="section level2">
<h2 class="hasAnchor">
<a href="#sec:map-sel-poly" class="anchor"></a><span class="header-section-number">11.3</span> <code class="sourceCode r"><span class="kw">map.sel.poly</span>()</code> selecting spectra inside a polygon in a map plot</h2>
<p>Function <code class="sourceCode r"><span class="kw">map.sel.poly</span>()</code> returns a logical indicating which spectra are inside the polygon drawn by the user:</p>
<div class="sourceCode" id="cb80"><pre class="downlit">
<span class="fu"><a href="../reference/map.sel.poly.html">map.sel.poly</a></span>(<span class="kw">chondro</span>)
</pre></div>
</div>
<div id="sec:identify-other" class="section level2">
<h2 class="hasAnchor">
<a href="#sec:identify-other" class="anchor"></a><span class="header-section-number">11.4</span> Related Functions Provided by Base Graphics and <strong><em>lattice</em></strong>
</h2>
<p>For base graphics (as produced by <code class="sourceCode r"><span class="kw">plotspc</span>()</code>), <code class="sourceCode r"><span class="kw">locator</span>()</code> may be useful as well.
It returns the clicked coordinates. Note that these are <em>not</em> transformed according to <code>xoffset</code> &amp; Co.</p>
<p>For lattice graphics, <code class="sourceCode r"><span class="kw">grid.locator</span>()</code> may be used instead.
If it is not called in the panel function, a preceding call to <code class="sourceCode r"><span class="kw">trellis.focus</span>()</code> is needed:</p>
<div class="sourceCode" id="cb81"><pre class="downlit">
<span class="fu"><a href="../reference/plot-methods.html">plot</a></span>(<span class="kw">laser</span>, <span class="st">"mat"</span>)
<span class="fu">trellis.focus</span>()
<span class="fu">grid.locator</span>()
</pre></div>
<p>Function <code class="sourceCode r"><span class="kw">identify</span>()</code> (or <code class="sourceCode r"><span class="kw">panel.identify</span>()</code> for lattice graphics) allows to identify points of the plot directly.
Note that the returned indices correspond to the plotted object.</p>
</div>
</div>
<div id="sec:troubleshooting" class="section level1">
<h1 class="hasAnchor">
<a href="#sec:troubleshooting" class="anchor"></a><span class="header-section-number">12</span> Troubleshooting</h1>
<div id="sec:no-output-produced" class="section level2">
<h2 class="hasAnchor">
<a href="#sec:no-output-produced" class="anchor"></a><span class="header-section-number">12.1</span> No Output Is Produced</h2>
<p>Methods <code class="sourceCode r">plotmap</code>, <code class="sourceCode r">plotvoronoi</code>, <code class="sourceCode r">levelplot</code>, and <code class="sourceCode r">plotc</code> use package <strong>lattice</strong> functions.
Therefore, in loops, functions, Sweave, R Markdown chunks, etc. the lattice object needs to be printed explicitly by <code class="sourceCode r"><span class="kw">print</span>(<span class="kw">plotmap</span>(object))</code>
(<a href="http://cran.r-project.org/doc/FAQ/R-FAQ.html#Why-do-lattice_002ftrellis-graphics-not-work_003f">R FAQ: Why do lattice/trellis graphics not work?</a>).
The same holds for package <strong>ggplot2</strong> graphics.</p>
</div>
</div>
<div id="session-info" class="section level1 unnumbered">
<h1 class="hasAnchor">
<a href="#session-info" class="anchor"></a>Session Info</h1>
<div class="sourceCode" id="cb82"><pre class="downlit">
<span class="kw">sessioninfo</span>::<span class="fu"><a href="https://rdrr.io/pkg/sessioninfo/man/session_info.html">session_info</a></span>(<span class="st">"hyperSpec"</span>)
<span class="co">#&gt; ─ Session info ───────────────────────────────────────────────────────────────────────────────────</span>
<span class="co">#&gt;  setting  value                       </span>
<span class="co">#&gt;  version  R version 4.0.2 (2020-06-22)</span>
<span class="co">#&gt;  os       macOS Catalina 10.15.5      </span>
<span class="co">#&gt;  system   x86_64, darwin17.0          </span>
<span class="co">#&gt;  ui       X11                         </span>
<span class="co">#&gt;  language (EN)                        </span>
<span class="co">#&gt;  collate  en_US.UTF-8                 </span>
<span class="co">#&gt;  ctype    en_US.UTF-8                 </span>
<span class="co">#&gt;  tz       UTC                         </span>
<span class="co">#&gt;  date     2020-07-05                  </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; ─ Packages ───────────────────────────────────────────────────────────────────────────────────────</span>
<span class="co">#&gt;  package      * version       date       lib source        </span>
<span class="co">#&gt;  assertthat     0.2.1         2019-03-21 [1] CRAN (R 4.0.0)</span>
<span class="co">#&gt;  backports      1.1.8         2020-06-17 [1] CRAN (R 4.0.0)</span>
<span class="co">#&gt;  callr          3.4.3         2020-03-28 [1] CRAN (R 4.0.0)</span>
<span class="co">#&gt;  cli            2.0.2         2020-02-28 [1] CRAN (R 4.0.0)</span>
<span class="co">#&gt;  colorspace     1.4-1         2019-03-18 [1] CRAN (R 4.0.0)</span>
<span class="co">#&gt;  crayon         1.3.4         2017-09-16 [1] CRAN (R 4.0.0)</span>
<span class="co">#&gt;  desc           1.2.0         2018-05-01 [1] CRAN (R 4.0.0)</span>
<span class="co">#&gt;  digest         0.6.25        2020-02-23 [1] CRAN (R 4.0.0)</span>
<span class="co">#&gt;  dplyr          1.0.0         2020-05-29 [1] CRAN (R 4.0.0)</span>
<span class="co">#&gt;  ellipsis       0.3.1         2020-05-15 [1] CRAN (R 4.0.0)</span>
<span class="co">#&gt;  evaluate       0.14          2019-05-28 [1] CRAN (R 4.0.0)</span>
<span class="co">#&gt;  fansi          0.4.1         2020-01-08 [1] CRAN (R 4.0.0)</span>
<span class="co">#&gt;  farver         2.0.3         2020-01-16 [1] CRAN (R 4.0.0)</span>
<span class="co">#&gt;  generics       0.0.2         2018-11-29 [1] CRAN (R 4.0.0)</span>
<span class="co">#&gt;  ggplot2      * 3.3.2         2020-06-19 [1] CRAN (R 4.0.0)</span>
<span class="co">#&gt;  glue           1.4.1         2020-05-13 [1] CRAN (R 4.0.0)</span>
<span class="co">#&gt;  gtable         0.3.0         2019-03-25 [1] CRAN (R 4.0.0)</span>
<span class="co">#&gt;  hyperSpec    * 0.99-20200615 2020-07-05 [1] local         </span>
<span class="co">#&gt;  isoband        0.2.2         2020-06-20 [1] CRAN (R 4.0.1)</span>
<span class="co">#&gt;  jpeg           0.1-8.1       2019-10-24 [1] CRAN (R 4.0.0)</span>
<span class="co">#&gt;  labeling       0.3           2014-08-23 [1] CRAN (R 4.0.0)</span>
<span class="co">#&gt;  lattice      * 0.20-41       2020-04-02 [2] CRAN (R 4.0.2)</span>
<span class="co">#&gt;  latticeExtra * 0.6-29        2019-12-19 [1] CRAN (R 4.0.0)</span>
<span class="co">#&gt;  lazyeval       0.2.2         2019-03-15 [1] CRAN (R 4.0.0)</span>
<span class="co">#&gt;  lifecycle      0.2.0         2020-03-06 [1] CRAN (R 4.0.0)</span>
<span class="co">#&gt;  magrittr       1.5           2014-11-22 [1] CRAN (R 4.0.0)</span>
<span class="co">#&gt;  MASS           7.3-51.6      2020-04-26 [2] CRAN (R 4.0.2)</span>
<span class="co">#&gt;  Matrix         1.2-18        2019-11-27 [2] CRAN (R 4.0.2)</span>
<span class="co">#&gt;  mgcv           1.8-31        2019-11-09 [2] CRAN (R 4.0.2)</span>
<span class="co">#&gt;  munsell        0.5.0         2018-06-12 [1] CRAN (R 4.0.0)</span>
<span class="co">#&gt;  nlme           3.1-148       2020-05-24 [2] CRAN (R 4.0.2)</span>
<span class="co">#&gt;  pillar         1.4.4         2020-05-05 [1] CRAN (R 4.0.0)</span>
<span class="co">#&gt;  pkgbuild       1.0.8         2020-05-07 [1] CRAN (R 4.0.0)</span>
<span class="co">#&gt;  pkgconfig      2.0.3         2019-09-22 [1] CRAN (R 4.0.0)</span>
<span class="co">#&gt;  pkgload        1.1.0         2020-05-29 [1] CRAN (R 4.0.0)</span>
<span class="co">#&gt;  png            0.1-7         2013-12-03 [1] CRAN (R 4.0.0)</span>
<span class="co">#&gt;  praise         1.0.0         2015-08-11 [1] CRAN (R 4.0.0)</span>
<span class="co">#&gt;  prettyunits    1.1.1         2020-01-24 [1] CRAN (R 4.0.0)</span>
<span class="co">#&gt;  processx       3.4.3         2020-07-05 [1] CRAN (R 4.0.2)</span>
<span class="co">#&gt;  ps             1.3.3         2020-05-08 [1] CRAN (R 4.0.0)</span>
<span class="co">#&gt;  purrr          0.3.4         2020-04-17 [1] CRAN (R 4.0.0)</span>
<span class="co">#&gt;  R6             2.4.1         2019-11-12 [1] CRAN (R 4.0.0)</span>
<span class="co">#&gt;  RColorBrewer   1.1-2         2014-12-07 [1] CRAN (R 4.0.0)</span>
<span class="co">#&gt;  rlang          0.4.6         2020-05-02 [1] CRAN (R 4.0.0)</span>
<span class="co">#&gt;  rprojroot      1.3-2         2018-01-03 [1] CRAN (R 4.0.0)</span>
<span class="co">#&gt;  rstudioapi     0.11          2020-02-07 [1] CRAN (R 4.0.0)</span>
<span class="co">#&gt;  scales         1.1.1         2020-05-11 [1] CRAN (R 4.0.0)</span>
<span class="co">#&gt;  testthat       2.3.2         2020-03-02 [1] CRAN (R 4.0.0)</span>
<span class="co">#&gt;  tibble         3.0.1         2020-04-20 [1] CRAN (R 4.0.0)</span>
<span class="co">#&gt;  tidyselect     1.1.0         2020-05-11 [1] CRAN (R 4.0.0)</span>
<span class="co">#&gt;  utf8           1.1.4         2018-05-24 [1] CRAN (R 4.0.0)</span>
<span class="co">#&gt;  vctrs          0.3.1         2020-06-05 [1] CRAN (R 4.0.0)</span>
<span class="co">#&gt;  viridisLite    0.3.0         2018-02-01 [1] CRAN (R 4.0.0)</span>
<span class="co">#&gt;  withr          2.2.0         2020-04-20 [1] CRAN (R 4.0.0)</span>
<span class="co">#&gt;  xml2         * 1.3.2         2020-04-23 [1] CRAN (R 4.0.0)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [1] /Users/runner/work/_temp/Library</span>
<span class="co">#&gt; [2] /Library/Frameworks/R.framework/Versions/4.0/Resources/library</span>
</pre></div>
</div>
<div id="references" class="section level1 unnumbered">
<h1 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h1>
<div id="refs" class="references">
<div id="ref-tripack">
<p>[1] F. code by R. J. Renka. R functions by Albrecht Gebhardt. With contributions from Stephen Eglen &lt;stephen@anc.ed.ac.uk&gt;, S. Zuyev, D. White, Tripack: Triangulation of irregularly spaced data, 2020. <a href="https://CRAN.R-project.org/package=tripack">https://CRAN.R-project.org/package=tripack</a>.</p>
</div>
<div id="ref-lattice">
<p>[2] D. Sarkar, Lattice: Trellis graphics for r, 2020. <a href="https://CRAN.R-project.org/package=lattice">https://CRAN.R-project.org/package=lattice</a>.</p>
</div>
<div id="ref-plotrix">
<p>[3] J. Lemon, B. Bolker, S. Oom, E. Klein, B. Rowlingson, H. Wickham, A. Tyagi, O. Eterradossi, G. Grothendieck, M. Toews, J. Kane, R. Turner, C. Witthoft, J. Stander, T. Petzoldt, R. Duursma, E. Biancotto, O. Levy, C. Dutang, P. Solymos, R. Engelmann, M. Hecker, F. Steinbeck, H. Borchers, H. Singmann, T. Toal, D. Ogle, D. Baral, U. Groemping, B. Venables, Plotrix: Various plotting functions, 2020. <a href="https://CRAN.R-project.org/package=plotrix">https://CRAN.R-project.org/package=plotrix</a>.</p>
</div>
<div id="ref-latticeExtra">
<p>[4] D. Sarkar, F. Andrews, LatticeExtra: Extra graphical utilities based on lattice, 2019. <a href="https://CRAN.R-project.org/package=latticeExtra">https://CRAN.R-project.org/package=latticeExtra</a>.</p>
</div>
<div id="ref-deldir">
<p>[5] R. Turner, Deldir: Delaunay triangulation and dirichlet (voronoi) tessellation, 2020. <a href="https://CRAN.R-project.org/package=deldir">https://CRAN.R-project.org/package=deldir</a>.</p>
</div>
<div id="ref-rgl">
<p>[6] D. Adler, D. Murdoch, Rgl: 3D visualization using opengl, 2020. <a href="https://CRAN.R-project.org/package=rgl">https://CRAN.R-project.org/package=rgl</a>.</p>
</div>
<div id="ref-ggplot2">
<p>[7] H. Wickham, W. Chang, L. Henry, T.L. Pedersen, K. Takahashi, C. Wilke, K. Woo, H. Yutani, D. Dunnington, Ggplot2: Create elegant data visualisations using the grammar of graphics, 2020. <a href="https://CRAN.R-project.org/package=ggplot2">https://CRAN.R-project.org/package=ggplot2</a>.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Claudia Beleites, Valter Sergo.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.9000.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
