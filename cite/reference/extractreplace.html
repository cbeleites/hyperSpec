<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Extract and Replace parts of <code>hyperSpec</code> objects. — [,hyperSpec-method • hyperSpec</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cerulean/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



  <link href="../extra.css" rel="stylesheet">
  

<meta property="og:title" content="Extract and Replace parts of <code>hyperSpec</code> objects. — [,hyperSpec-method" />
<meta property="og:description" content="These Methods allow to extract and replace parts of the hyperSpec object." />

<meta name="robots" content="noindex" />
<meta name="robots" content="noindex">

<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">hyperSpec</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="In-development version">0.99-20200719</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa-book"></span>
     
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-header">Documentation for version of package:</li>
    <li>
      <a href="https://cbeleites.github.io/hyperSpec/">Released</a>
    </li>
    <li>
      <a href="https://cbeleites.github.io/hyperSpec/dev/">In-development</a>
    </li>
  </ul>
</li>
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/hyperSpec.html">Get started</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/fileio.html">Import and Export Files with Spectra</a>
    </li>
    <li>
      <a href="../articles/plotting.html">Plotting Functions in "hyperSpec"</a>
    </li>
    <li>
      <a href="../articles/baseline.html">Fitting Baselines to Spectra</a>
    </li>
    <li class="divider"></li>
    <li>
      <a href="../articles/index.html">More...</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/cbeleites/hyperSpec/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Extract and Replace parts of <code>hyperSpec</code> objects.</h1>
    <small class="dont-index">Source: <a href='https://github.com/cbeleites/hyperSpec/blob/master/R/extract.R'><code>R/extract.R</code></a>, <a href='https://github.com/cbeleites/hyperSpec/blob/master/R/replace.R'><code>R/replace.R</code></a></small>
    <div class="hidden name"><code>extractreplace.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>These Methods allow to extract and replace parts of the <code>hyperSpec</code> object.</p>
    </div>

    <pre class="usage"># S4 method for hyperSpec
[(x, i, j, l, ..., wl.index = FALSE, drop = FALSE)

# S4 method for hyperSpec
[[(x, i, j, l, ..., wl.index = FALSE, drop = FALSE)

# S4 method for hyperSpec
$(x, name)

# S4 method for hyperSpec
[(x, i, j, ...) &lt;- value

# S4 method for hyperSpec
[[(x, i, j, l, wl.index = FALSE, ...) &lt;- value

# S4 method for hyperSpec
$(x, name) &lt;- value</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>a <code>hyperSpec</code> Object</p></td>
    </tr>
    <tr>
      <th>i</th>
      <td><p>row index: selects spectra</p>
<p><code><a href='https://rdrr.io/r/base/Extract.html'>[[</a></code> and <code>[[&lt;-</code> accept indexing with logical matrix or a n by 2
integer index matrix. In this case the indexing is done inside the
spectra matrix. See the examples below.</p></td>
    </tr>
    <tr>
      <th>j</th>
      <td><p>selecting columns of <code>x@data</code></p></td>
    </tr>
    <tr>
      <th>l</th>
      <td><p>selecting columns of the spectra matrix. If <code>l</code> is numeric,
the default behaviour is treating <code>l</code> as wavelengths, <em>not</em> as
indices.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>ignored</p></td>
    </tr>
    <tr>
      <th>wl.index</th>
      <td><p>If <code>TRUE</code> (default), the value(s) in <code>l</code> are
treated as column indices for the spectral matrix. Otherwise, the numbers
in <code>l</code> are treated as wavelengths and the corresponding column
indices are looked up first via <code>wl2i()</code>.</p></td>
    </tr>
    <tr>
      <th>drop</th>
      <td><p>For <code><a href='https://rdrr.io/r/base/Extract.html'>[[</a></code>: drop unnecessary dimensions, see
<code><a href='https://rdrr.io/r/base/drop.html'>base::drop()</a></code> and <code><a href='https://rdrr.io/r/base/Extract.html'>base::Extract()</a></code>. Ignored for
<code><a href='https://rdrr.io/r/base/Extract.html'>[</a></code>, as otherwise invalid <code>hyperSpec</code> objects might result.</p></td>
    </tr>
    <tr>
      <th>name</th>
      <td><p>name of the data column to extract. <code>$spc</code> yields the spectra matrix.</p></td>
    </tr>
    <tr>
      <th>value</th>
      <td><p>the replacement value</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>For <code><a href='https://rdrr.io/r/base/Extract.html'>[</a></code>, <code>[&lt;-</code>, <code>[[&lt;-</code>, and <code>$&lt;-</code> a <code>hyperSpec</code> object,</p>
<p>for <code><a href='https://rdrr.io/r/base/Extract.html'>[[</a></code> a matrix or <code>data.frame</code>, and</p>
<p>for <code><a href='https://rdrr.io/r/base/Extract.html'>$</a></code> the column of the <code>data.frame</code> <code>@data</code>.</p>
<p><code>x[[]]</code> returns the complete spectra matrix.</p>
<p><code>x$.</code> returns the complete slot <code>@data</code>,</p>
<p><code>x$..</code> returns the <code>data.frame</code> in <code>@data</code> but without the column
<code>@data$spc</code> containing the spectra matrix.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>They work with respect to the spectra (rows of <code>x</code>), the columns of the data matrix, and the
wavelengths (columns of the spectra matrix).</p>
<p>Thus, they can be used for selecting/deleting spectra, cutting the spectral range, and extracting
or setting the data belonging to the spectra.</p>
<p>Convenient shortcuts for access of the spectra matrix and the <code>data.frame</code> in slot
<code>data</code> are provided.</p>
<p><em>Extracting: <code><a href='https://rdrr.io/r/base/Extract.html'>[</a></code>, <code><a href='https://rdrr.io/r/base/Extract.html'>[[</a></code>, and <code><a href='https://rdrr.io/r/base/Extract.html'>$</a></code></em>.</p>
<p>The version with single square brackets (<code><a href='https://rdrr.io/r/base/Extract.html'>[</a></code>) returns the resulting <code>hyperSpec</code> object.</p>
<p><code><a href='https://rdrr.io/r/base/Extract.html'>[[</a></code> yields <code>data.frame</code> of slot <code>@data</code> of that corresponding <code>hyperSpec</code>
object returned with the same arguments by <code><a href='https://rdrr.io/r/base/Extract.html'>[</a></code> if columns were selected (i.e. <code>j</code> is
given), otherwise the spectra <code>matrix</code> <code>x@data$spc</code>.</p>
<p><code><a href='https://rdrr.io/r/base/Extract.html'>$</a></code> returns the selected column of the <code>data.frame</code> in slot <code>@data</code>.</p>
<p><em>Shortcuts.</em> Three shortcuts to conveniently extract much needed parts of the object are
defined:</p>
<p><code>x[[]]</code> returns the spectra matrix.</p>
<p><code>x$.</code> returns the complete slot <code>@data</code>, including the spectra matrix in column
<code>$spc</code>, as a <code>data.frame</code>.</p>
<p><code>x$..</code> returns a <code>data.frame</code> like <code>x$.</code> but without the spectra matrix.</p>
<p><em>Replacing: <code>[&lt;-</code>, <code>[[&lt;-</code>, and <code>$&lt;-</code></em>.</p><pre>
## S4 method for signature 'hyperSpec':
x [i, j, l, \dots] &lt;- value

## S4 method for signature 'hyperSpec':
x[[i, j, l, wl.index = FALSE, \dots]] &lt;- value

## S4 method for signature 'hyperSpec':
x$name &lt;- value
</pre>

<p><code>value</code> gives the values to be assigned.<br /></p>
<p>For <code><a href='https://rdrr.io/r/base/Extract.html'>$</a></code>, this can also be a list of the form <code><a href='https://rdrr.io/r/base/list.html'>list (value = value, label = label)</a></code>, with <code>label</code> containing the label for data
column <code>name</code>.</p>
<p><code>[[&lt;-</code> replaces parts of the spectra matrix.</p>
<p><code>[&lt;-</code> replaces parts of the <code>data.frame</code> in slot <code>x@data</code>.</p>
<p><code>$&lt;-</code> replaces a column of the <code>data.frame</code> in slot
<code>x@data</code>.  The <code>value</code> may be a list with two elements,
<code>value</code> and <code>label</code>.  In this case the label of the data column
is changed accordingly.</p>
<p><code>$..&lt;-</code> is again an abbreviation for the data.frame without the
spectra matrix.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code>wl2i()</code> on conversion of wavelength ranges to indices.</p>
<p><code><a href='https://rdrr.io/r/base/drop.html'>base::drop()</a></code> and <code><a href='https://rdrr.io/r/base/Extract.html'>base::Extract()</a></code> on <code>drop</code>.</p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='co'>## index into the rows (spectra) -------------------------------------</span>
<span class='co'>## make some "spectra"</span>

<span class='co'>## numeric index</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span>(<span class='kw'>flu</span>, <span class='st'>"spc"</span>, lines.args = <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(lty = <span class='fl'>2</span>))</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span>(<span class='kw'>flu</span>[<span class='fl'>1</span><span class='op'>:</span><span class='fl'>3</span>], <span class='st'>"spc"</span>, add = <span class='fl'>TRUE</span>, col = <span class='st'>"red"</span>) <span class='co'># select spectra</span></div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span>(<span class='kw'>flu</span>[<span class='op'>-</span>(<span class='fl'>1</span><span class='op'>:</span><span class='fl'>3</span>)], <span class='st'>"spc"</span>, add = <span class='fl'>TRUE</span>, col = <span class='st'>"blue"</span>) <span class='co'># delete spectra</span></div><div class='img'><img src='extractreplace-1.png' alt='' width='466' height='288' /></div><div class='input'>
<span class='co'>## logic index</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span>(<span class='kw'>flu</span>, <span class='st'>"spc"</span>, lines.args = <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(lty = <span class='fl'>2</span>))</div><div class='input'><span class='kw'>index</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span>(<span class='fl'>6</span>) <span class='op'>&gt;</span> <span class='fl'>0</span>
<span class='kw'>index</span></div><div class='output co'>#&gt; [1]  TRUE  TRUE FALSE FALSE  TRUE  TRUE</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span>(<span class='kw'>flu</span>[<span class='kw'>index</span>], <span class='st'>"spc"</span>, add = <span class='fl'>TRUE</span>, col = <span class='st'>"red"</span>) <span class='co'># select spectra</span></div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span>(<span class='kw'>flu</span>[<span class='op'>!</span><span class='kw'>index</span>], <span class='st'>"spc"</span>, add = <span class='fl'>TRUE</span>, col = <span class='st'>"blue"</span>) <span class='co'># select spectra</span></div><div class='img'><img src='extractreplace-2.png' alt='' width='466' height='288' /></div><div class='input'>
<span class='co'>## index into the data columns ---------------------------------------</span>
<span class='fu'><a href='https://rdrr.io/r/base/range.html'>range</a></span>(<span class='kw'>faux_cell</span>[[, <span class='st'>"x"</span>]])</div><div class='output co'>#&gt; [1] -11.55  22.45</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span>(<span class='kw'>faux_cell</span>[[, <span class='fl'>1</span>]])</div><div class='output co'>#&gt; [1] "x"</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/dim.html'>dim</a></span>(<span class='kw'>faux_cell</span>[[, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>TRUE</span>, <span class='fl'>FALSE</span>, <span class='fl'>FALSE</span>)]])</div><div class='output co'>#&gt; [1] 875   2</div><div class='input'><span class='kw'>faux_cell</span><span class='op'>$</span><span class='kw'>x</span></div><div class='output co'>#&gt;   [1] -11.55 -10.55  -9.55  -8.55  -7.55  -6.55  -5.55  -4.55  -3.55  -2.55
#&gt;  [11]  -1.55  -0.55   0.45   1.45   2.45   3.45   4.45   5.45   6.45   7.45
#&gt;  [21]   8.45   9.45  10.45  11.45  12.45  13.45  14.45  15.45  16.45  17.45
#&gt;  [31]  18.45  19.45  20.45  21.45  22.45 -11.55 -10.55  -9.55  -8.55  -7.55
#&gt;  [41]  -6.55  -5.55  -4.55  -3.55  -2.55  -1.55  -0.55   0.45   1.45   2.45
#&gt;  [51]   3.45   4.45   5.45   6.45   7.45   8.45   9.45  10.45  11.45  12.45
#&gt;  [61]  13.45  14.45  15.45  16.45  17.45  18.45  19.45  20.45  21.45  22.45
#&gt;  [71] -11.55 -10.55  -9.55  -8.55  -7.55  -6.55  -5.55  -4.55  -3.55  -2.55
#&gt;  [81]  -1.55  -0.55   0.45   1.45   2.45   3.45   4.45   5.45   6.45   7.45
#&gt;  [91]   8.45   9.45  10.45  11.45  12.45  13.45  14.45  15.45  16.45  17.45
#&gt; [101]  18.45  19.45  20.45  21.45  22.45 -11.55 -10.55  -9.55  -8.55  -7.55
#&gt; [111]  -6.55  -5.55  -4.55  -3.55  -2.55  -1.55  -0.55   0.45   1.45   2.45
#&gt; [121]   3.45   4.45   5.45   6.45   7.45   8.45   9.45  10.45  11.45  12.45
#&gt; [131]  13.45  14.45  15.45  16.45  17.45  18.45  19.45  20.45  21.45  22.45
#&gt; [141] -11.55 -10.55  -9.55  -8.55  -7.55  -6.55  -5.55  -4.55  -3.55  -2.55
#&gt; [151]  -1.55  -0.55   0.45   1.45   2.45   3.45   4.45   5.45   6.45   7.45
#&gt; [161]   8.45   9.45  10.45  11.45  12.45  13.45  14.45  15.45  16.45  17.45
#&gt; [171]  18.45  19.45  20.45  21.45  22.45 -11.55 -10.55  -9.55  -8.55  -7.55
#&gt; [181]  -6.55  -5.55  -4.55  -3.55  -2.55  -1.55  -0.55   0.45   1.45   2.45
#&gt; [191]   3.45   4.45   5.45   6.45   7.45   8.45   9.45  10.45  11.45  12.45
#&gt; [201]  13.45  14.45  15.45  16.45  17.45  18.45  19.45  20.45  21.45  22.45
#&gt; [211] -11.55 -10.55  -9.55  -8.55  -7.55  -6.55  -5.55  -4.55  -3.55  -2.55
#&gt; [221]  -1.55  -0.55   0.45   1.45   2.45   3.45   4.45   5.45   6.45   7.45
#&gt; [231]   8.45   9.45  10.45  11.45  12.45  13.45  14.45  15.45  16.45  17.45
#&gt; [241]  18.45  19.45  20.45  21.45  22.45 -11.55 -10.55  -9.55  -8.55  -7.55
#&gt; [251]  -6.55  -5.55  -4.55  -3.55  -2.55  -1.55  -0.55   0.45   1.45   2.45
#&gt; [261]   3.45   4.45   5.45   6.45   7.45   8.45   9.45  10.45  11.45  12.45
#&gt; [271]  13.45  14.45  15.45  16.45  17.45  18.45  19.45  20.45  21.45  22.45
#&gt; [281] -11.55 -10.55  -9.55  -8.55  -7.55  -6.55  -5.55  -4.55  -3.55  -2.55
#&gt; [291]  -1.55  -0.55   0.45   1.45   2.45   3.45   4.45   5.45   6.45   7.45
#&gt; [301]   8.45   9.45  10.45  11.45  12.45  13.45  14.45  15.45  16.45  17.45
#&gt; [311]  18.45  19.45  20.45  21.45  22.45 -11.55 -10.55  -9.55  -8.55  -7.55
#&gt; [321]  -6.55  -5.55  -4.55  -3.55  -2.55  -1.55  -0.55   0.45   1.45   2.45
#&gt; [331]   3.45   4.45   5.45   6.45   7.45   8.45   9.45  10.45  11.45  12.45
#&gt; [341]  13.45  14.45  15.45  16.45  17.45  18.45  19.45  20.45  21.45  22.45
#&gt; [351] -11.55 -10.55  -9.55  -8.55  -7.55  -6.55  -5.55  -4.55  -3.55  -2.55
#&gt; [361]  -1.55  -0.55   0.45   1.45   2.45   3.45   4.45   5.45   6.45   7.45
#&gt; [371]   8.45   9.45  10.45  11.45  12.45  13.45  14.45  15.45  16.45  17.45
#&gt; [381]  18.45  19.45  20.45  21.45  22.45 -11.55 -10.55  -9.55  -8.55  -7.55
#&gt; [391]  -6.55  -5.55  -4.55  -3.55  -2.55  -1.55  -0.55   0.45   1.45   2.45
#&gt; [401]   3.45   4.45   5.45   6.45   7.45   8.45   9.45  10.45  11.45  12.45
#&gt; [411]  13.45  14.45  15.45  16.45  17.45  18.45  19.45  20.45  21.45  22.45
#&gt; [421] -11.55 -10.55  -9.55  -8.55  -7.55  -6.55  -5.55  -4.55  -3.55  -2.55
#&gt; [431]  -1.55  -0.55   0.45   1.45   2.45   3.45   4.45   5.45   6.45   7.45
#&gt; [441]   8.45   9.45  10.45  11.45  12.45  13.45  14.45  15.45  16.45  17.45
#&gt; [451]  18.45  19.45  20.45  21.45  22.45 -11.55 -10.55  -9.55  -8.55  -7.55
#&gt; [461]  -6.55  -5.55  -4.55  -3.55  -2.55  -1.55  -0.55   0.45   1.45   2.45
#&gt; [471]   3.45   4.45   5.45   6.45   7.45   8.45   9.45  10.45  11.45  12.45
#&gt; [481]  13.45  14.45  15.45  16.45  17.45  18.45  19.45  20.45  21.45  22.45
#&gt; [491] -11.55 -10.55  -9.55  -8.55  -7.55  -6.55  -5.55  -4.55  -3.55  -2.55
#&gt; [501]  -1.55  -0.55   0.45   1.45   2.45   3.45   4.45   5.45   6.45   7.45
#&gt; [511]   8.45   9.45  10.45  11.45  12.45  13.45  14.45  15.45  16.45  17.45
#&gt; [521]  18.45  19.45  20.45  21.45  22.45 -11.55 -10.55  -9.55  -8.55  -7.55
#&gt; [531]  -6.55  -5.55  -4.55  -3.55  -2.55  -1.55  -0.55   0.45   1.45   2.45
#&gt; [541]   3.45   4.45   5.45   6.45   7.45   8.45   9.45  10.45  11.45  12.45
#&gt; [551]  13.45  14.45  15.45  16.45  17.45  18.45  19.45  20.45  21.45  22.45
#&gt; [561] -11.55 -10.55  -9.55  -8.55  -7.55  -6.55  -5.55  -4.55  -3.55  -2.55
#&gt; [571]  -1.55  -0.55   0.45   1.45   2.45   3.45   4.45   5.45   6.45   7.45
#&gt; [581]   8.45   9.45  10.45  11.45  12.45  13.45  14.45  15.45  16.45  17.45
#&gt; [591]  18.45  19.45  20.45  21.45  22.45 -11.55 -10.55  -9.55  -8.55  -7.55
#&gt; [601]  -6.55  -5.55  -4.55  -3.55  -2.55  -1.55  -0.55   0.45   1.45   2.45
#&gt; [611]   3.45   4.45   5.45   6.45   7.45   8.45   9.45  10.45  11.45  12.45
#&gt; [621]  13.45  14.45  15.45  16.45  17.45  18.45  19.45  20.45  21.45  22.45
#&gt; [631] -11.55 -10.55  -9.55  -8.55  -7.55  -6.55  -5.55  -4.55  -3.55  -2.55
#&gt; [641]  -1.55  -0.55   0.45   1.45   2.45   3.45   4.45   5.45   6.45   7.45
#&gt; [651]   8.45   9.45  10.45  11.45  12.45  13.45  14.45  15.45  16.45  17.45
#&gt; [661]  18.45  19.45  20.45  21.45  22.45 -11.55 -10.55  -9.55  -8.55  -7.55
#&gt; [671]  -6.55  -5.55  -4.55  -3.55  -2.55  -1.55  -0.55   0.45   1.45   2.45
#&gt; [681]   3.45   4.45   5.45   6.45   7.45   8.45   9.45  10.45  11.45  12.45
#&gt; [691]  13.45  14.45  15.45  16.45  17.45  18.45  19.45  20.45  21.45  22.45
#&gt; [701] -11.55 -10.55  -9.55  -8.55  -7.55  -6.55  -5.55  -4.55  -3.55  -2.55
#&gt; [711]  -1.55  -0.55   0.45   1.45   2.45   3.45   4.45   5.45   6.45   7.45
#&gt; [721]   8.45   9.45  10.45  11.45  12.45  13.45  14.45  15.45  16.45  17.45
#&gt; [731]  18.45  19.45  20.45  21.45  22.45 -11.55 -10.55  -9.55  -8.55  -7.55
#&gt; [741]  -6.55  -5.55  -4.55  -3.55  -2.55  -1.55  -0.55   0.45   1.45   2.45
#&gt; [751]   3.45   4.45   5.45   6.45   7.45   8.45   9.45  10.45  11.45  12.45
#&gt; [761]  13.45  14.45  15.45  16.45  17.45  18.45  19.45  20.45  21.45  22.45
#&gt; [771] -11.55 -10.55  -9.55  -8.55  -7.55  -6.55  -5.55  -4.55  -3.55  -2.55
#&gt; [781]  -1.55  -0.55   0.45   1.45   2.45   3.45   4.45   5.45   6.45   7.45
#&gt; [791]   8.45   9.45  10.45  11.45  12.45  13.45  14.45  15.45  16.45  17.45
#&gt; [801]  18.45  19.45  20.45  21.45  22.45 -11.55 -10.55  -9.55  -8.55  -7.55
#&gt; [811]  -6.55  -5.55  -4.55  -3.55  -2.55  -1.55  -0.55   0.45   1.45   2.45
#&gt; [821]   3.45   4.45   5.45   6.45   7.45   8.45   9.45  10.45  11.45  12.45
#&gt; [831]  13.45  14.45  15.45  16.45  17.45  18.45  19.45  20.45  21.45  22.45
#&gt; [841] -11.55 -10.55  -9.55  -8.55  -7.55  -6.55  -5.55  -4.55  -3.55  -2.55
#&gt; [851]  -1.55  -0.55   0.45   1.45   2.45   3.45   4.45   5.45   6.45   7.45
#&gt; [861]   8.45   9.45  10.45  11.45  12.45  13.45  14.45  15.45  16.45  17.45
#&gt; [871]  18.45  19.45  20.45  21.45  22.45</div><div class='input'>

<span class='co'>## the shortcut functions --------------------------------------------</span>

<span class='co'>## extract the spectra matrix</span>
<span class='kw'>flu</span>[[]]</div><div class='output co'>#&gt;            405     405.5       406     406.5       407     407.5      408
#&gt; [1,]  27.15000  32.34467  33.37867  34.41933  36.53133  37.64767  38.1370
#&gt; [2,]  66.80133  63.71533  66.71200  69.58233  72.52967  74.55833  77.0480
#&gt; [3,]  93.14433 103.06767 106.19367 110.18633 113.24867 119.17300 121.3133
#&gt; [4,] 130.66367 139.99833 143.79767 148.42000 152.13267 159.31033 165.0523
#&gt; [5,] 167.26667 171.89833 177.47067 184.62467 189.75233 198.11533 205.5627
#&gt; [6,] 198.43033 209.45800 215.78500 224.58700 232.52800 240.77133 248.0467
#&gt;          408.5       409     409.5       410     410.5       411     411.5
#&gt; [1,]  39.17700  40.73567  41.38133  44.25133  44.12633  46.98067  49.08167
#&gt; [2,]  80.25967  82.53867  84.49167  88.15167  91.08533  95.37233  95.53033
#&gt; [3,] 124.67533 129.56867 134.11733 139.98667 145.02333 147.10367 150.53400
#&gt; [4,] 168.68967 175.45900 181.58100 185.69233 190.89667 197.70833 203.64700
#&gt; [5,] 208.41933 217.55267 224.74633 231.03567 236.35233 244.61233 251.95000
#&gt; [6,] 256.89133 262.73900 270.27133 281.82867 287.70467 297.23500 307.59333
#&gt;            412     412.5       413     413.5      414     414.5       415
#&gt; [1,]  50.27433  50.10967  52.23167  53.03967  54.5190  56.22033  57.71933
#&gt; [2,]  98.99533 101.03433 103.55800 107.02667 109.5453 111.67233 113.98733
#&gt; [3,] 151.91733 158.18767 162.47900 167.57967 170.9957 176.37600 181.19767
#&gt; [4,] 209.56433 214.66167 219.65333 225.73100 232.1257 236.47700 240.81533
#&gt; [5,] 257.34633 265.54500 272.06333 280.74133 288.1057 291.88367 300.74000
#&gt; [6,] 314.99367 324.56300 330.80033 340.89667 347.6217 355.02667 365.62333
#&gt;          415.5      416     416.5       417     417.5       418    418.5
#&gt; [1,]  59.51433  58.7450  60.09467  61.84067  62.16867  66.04933  65.2450
#&gt; [2,] 117.03267 119.8350 123.49433 123.32367 127.00167 130.68067 132.3580
#&gt; [3,] 181.86833 187.9893 192.12267 194.55600 198.58033 204.04367 208.4330
#&gt; [4,] 247.19200 252.6117 258.44767 262.91767 269.74967 273.44567 279.3453
#&gt; [5,] 307.87567 315.4297 321.89600 326.73133 334.01200 339.59933 343.8617
#&gt; [6,] 374.35700 380.2173 391.40100 398.17300 405.42933 412.48400 421.2730
#&gt;           419     419.5      420     420.5      421     421.5       422
#&gt; [1,]  65.7990  66.94333  69.1360  70.92467  73.8340  74.38567  74.17333
#&gt; [2,] 136.1647 138.39933 140.2243 141.04333 143.1313 147.17967 150.01200
#&gt; [3,] 212.5187 215.81567 219.5087 222.67767 227.5900 229.54900 234.28167
#&gt; [4,] 283.7437 290.86000 295.6520 300.38267 303.5927 307.91433 315.23467
#&gt; [5,] 351.2567 357.79733 360.3600 367.96533 374.5490 381.76000 389.24100
#&gt; [6,] 429.3627 433.35767 443.1873 447.88033 461.3393 467.12733 475.18967
#&gt;          422.5       423    423.5       424     424.5       425     425.5
#&gt; [1,]  75.53067  76.42967  76.1320  77.89067  79.36867  79.42733  82.02833
#&gt; [2,] 153.69333 155.72800 158.4720 159.50067 160.81567 163.90967 166.25500
#&gt; [3,] 236.97767 241.06967 245.4193 249.38867 251.92200 256.41200 261.64400
#&gt; [4,] 319.20133 322.25767 328.2200 331.54600 337.62033 341.84300 347.36800
#&gt; [5,] 397.79733 403.78367 408.0230 418.35533 420.61400 427.04333 433.33900
#&gt; [6,] 481.66667 488.73567 494.0187 504.47333 515.40467 521.23867 522.64633
#&gt;            426     426.5       427     427.5       428     428.5      429
#&gt; [1,]  83.87833  83.81367  85.50667  86.50233  88.93733  88.99533  89.5150
#&gt; [2,] 169.59233 170.82833 172.08767 175.21133 178.47067 179.68100 181.8287
#&gt; [3,] 264.58433 268.46033 274.54733 275.68967 279.99767 283.71833 285.2170
#&gt; [4,] 352.53033 358.72233 363.61833 369.33300 373.90100 377.09633 383.9850
#&gt; [5,] 438.43633 449.57667 449.64833 455.43800 463.33200 471.47433 476.6003
#&gt; [6,] 536.03533 544.41767 551.63333 556.71267 567.61267 572.54933 578.7267
#&gt;          429.5       430    430.5      431     431.5      432     432.5
#&gt; [1,]  90.55667  91.70633  93.5790  94.0130  94.21033  96.4420  96.62733
#&gt; [2,] 184.42933 187.75600 187.9377 191.0570 192.50900 192.8010 195.55600
#&gt; [3,] 290.15667 292.75667 294.9913 299.2253 301.33567 301.4620 309.15933
#&gt; [4,] 386.89700 393.22067 398.5423 402.3163 405.33067 409.5040 412.68800
#&gt; [5,] 480.93533 486.53833 491.9100 500.5920 502.12433 508.4073 512.70433
#&gt; [6,] 587.74900 590.54867 600.4230 608.3580 614.03833 616.9557 621.87267
#&gt;            433     433.5      434    434.5      435    435.5      436    436.5
#&gt; [1,]  98.96233  98.84767 100.5683 100.4493  99.9160  99.7190 100.8863 101.4453
#&gt; [2,] 197.89067 198.78200 200.9947 201.5223 200.2060 204.1320 204.9043 203.9883
#&gt; [3,] 309.92833 310.05567 312.8650 314.6237 318.4220 323.1797 324.5793 325.8513
#&gt; [4,] 418.63200 418.58267 417.9557 420.1910 428.1477 428.4030 430.1730 431.3680
#&gt; [5,] 515.62733 522.20267 524.7247 525.2070 529.6997 531.7140 537.0060 538.2057
#&gt; [6,] 629.80033 633.44500 637.1323 639.1617 642.8983 648.1720 651.6790 654.5397
#&gt;           437    437.5      438    438.5      439    439.5      440    440.5
#&gt; [1,] 102.6427 104.2297 103.1113 104.7580 103.1583 103.9427 105.3710 105.8633
#&gt; [2,] 205.7560 204.8170 206.0910 208.6073 210.7967 210.5840 210.1903 210.5423
#&gt; [3,] 326.6177 324.6370 326.9670 327.7893 329.9097 328.2817 328.5657 331.6910
#&gt; [4,] 434.9550 434.4253 438.4397 439.8547 438.5417 440.2727 438.3083 440.5403
#&gt; [5,] 543.8357 544.0853 547.9363 552.1570 550.9350 548.2033 548.1477 550.7770
#&gt; [6,] 656.8327 659.7780 662.0563 663.1230 663.4820 670.4757 669.8870 670.0603
#&gt;           441    441.5      442    442.5      443    443.5      444    444.5
#&gt; [1,] 103.6797 104.0900 104.6540 105.2263 104.8043 105.8103 104.7580 103.8830
#&gt; [2,] 209.8593 212.8273 212.5207 212.4197 211.2223 215.5637 213.4247 211.1593
#&gt; [3,] 330.7493 335.0677 334.6253 334.2713 332.6473 333.6263 332.7240 330.8293
#&gt; [4,] 443.2797 445.8890 444.9900 446.4053 444.7670 445.8270 446.1643 446.2410
#&gt; [5,] 550.8607 551.7877 553.3040 552.5740 553.5453 551.1150 555.8740 554.8480
#&gt; [6,] 671.0080 667.6123 666.3083 669.9743 675.6830 675.9787 676.6420 674.7367
#&gt;           445    445.5      446    446.5      447    447.5      448    448.5
#&gt; [1,] 105.3617 105.0150 105.0593 105.3493 103.9870 105.4387 104.1967 105.0980
#&gt; [2,] 212.9753 213.9893 214.1720 213.4763 212.4887 211.7410 212.7047 212.9403
#&gt; [3,] 332.1467 334.2557 333.9380 332.7860 331.5540 331.9737 334.1657 334.1063
#&gt; [4,] 446.3653 442.3090 444.8933 446.9203 448.1863 446.1877 446.0927 448.2060
#&gt; [5,] 558.4950 556.9250 559.0123 557.1283 555.6883 553.0920 554.9623 553.3000
#&gt; [6,] 671.2343 673.6113 676.7353 677.4947 674.2803 676.6457 674.8907 673.0920
#&gt;           449    449.5      450    450.5      451    451.5      452    452.5
#&gt; [1,] 104.7233 106.6673 106.9497 104.7547 105.0827 105.3000 105.2130 104.7810
#&gt; [2,] 212.1293 213.7727 213.4973 213.4640 213.1707 212.8360 211.9633 208.7987
#&gt; [3,] 333.8570 336.5057 333.7757 334.7063 333.2027 333.3697 332.1660 330.7990
#&gt; [4,] 446.9607 446.4583 446.6307 448.4503 448.0997 446.2220 445.8603 443.3197
#&gt; [5,] 555.8330 555.1780 556.5237 554.7757 551.0763 553.9157 553.4520 550.7607
#&gt; [6,] 674.8980 671.6417 672.5317 672.2803 671.0003 672.8790 674.7430 672.7247
#&gt;           453    453.5      454    454.5      455    455.5      456    456.5
#&gt; [1,] 104.5387 105.1327 105.1697 104.0570 106.3853 104.0797 104.4013 102.1813
#&gt; [2,] 211.5063 209.4770 211.8597 213.2620 212.2837 211.7733 209.3907 208.8560
#&gt; [3,] 332.4763 332.6367 330.2320 329.0633 327.7353 327.0317 326.8933 327.0880
#&gt; [4,] 443.8383 442.6733 440.8430 444.9053 442.4323 438.7657 435.7203 436.7387
#&gt; [5,] 551.4177 548.2610 549.3907 553.8383 549.5407 544.3870 544.4403 543.0117
#&gt; [6,] 669.7910 672.0043 672.3397 668.7403 662.6333 666.2970 664.6327 659.9180
#&gt;           457    457.5      458    458.5      459    459.5       460     460.5
#&gt; [1,] 103.4417 101.7970 102.8717 102.3887 100.4190 101.1617  98.61133  98.42933
#&gt; [2,] 208.3403 206.5063 206.7773 206.6450 205.2550 201.7470 201.98800 199.57000
#&gt; [3,] 326.7383 324.4573 322.2523 318.6133 319.2347 318.6657 314.18900 313.58533
#&gt; [4,] 438.1527 432.7040 433.1373 430.0993 427.1347 421.5907 421.58900 420.52567
#&gt; [5,] 539.7383 538.8133 537.6860 532.2233 531.4020 527.5887 526.91933 519.80200
#&gt; [6,] 660.1303 656.2373 654.1950 652.3183 647.8210 643.3813 640.79033 632.11967
#&gt;           461    461.5       462    462.5      463     463.5       464
#&gt; [1,]  98.5760  98.3410  98.46733  95.1490  94.7110  95.27433  94.88433
#&gt; [2,] 200.5510 198.7677 197.03300 194.1447 193.3830 193.66467 192.51267
#&gt; [3,] 310.7470 311.7763 306.24567 305.3137 303.6507 299.22133 301.25333
#&gt; [4,] 417.2103 414.8137 415.02733 407.9040 404.0217 401.89667 397.83033
#&gt; [5,] 518.6207 515.2290 511.55500 506.8747 503.2640 498.34400 494.06167
#&gt; [6,] 633.5637 627.8190 623.21133 619.9967 613.5513 606.01267 605.92100
#&gt;          464.5       465     465.5       466    466.5      467     467.5
#&gt; [1,]  93.62133  92.46567  92.11533  91.30867  89.5390  88.2810  86.13633
#&gt; [2,] 190.63300 186.45567 186.05433 182.30533 182.3337 180.5693 180.50633
#&gt; [3,] 296.55200 294.46667 291.52000 288.69967 286.6547 283.8240 282.00933
#&gt; [4,] 395.28733 391.98100 386.99833 387.28467 379.8793 377.2287 374.34933
#&gt; [5,] 491.78467 484.60533 486.67233 479.56767 475.9010 472.1310 464.54333
#&gt; [6,] 599.88400 593.00650 587.40150 586.38900 581.4985 574.1510 566.49250
#&gt;           468     468.5       469    469.5      470     470.5       471
#&gt; [1,]  86.1620  86.81733  85.95767  84.0670  86.2120  83.68333  82.56867
#&gt; [2,] 180.2127 175.21100 171.65000 170.4167 170.3740 169.40700 164.89000
#&gt; [3,] 279.3910 274.85267 271.53567 268.8547 265.9293 261.68533 260.63400
#&gt; [4,] 368.4563 365.84700 360.04467 359.2973 354.6593 350.36133 346.36533
#&gt; [5,] 457.9090 455.22167 449.28400 446.3457 442.7517 438.25067 432.26667
#&gt; [6,] 560.2900 559.46250 550.27850 545.5435 542.7690 528.92800 528.12900
#&gt;          471.5       472     472.5       473    473.5      474    474.5
#&gt; [1,]  82.70533  81.26033  78.75233  76.67533  77.9530  77.5070  76.1640
#&gt; [2,] 164.14133 163.17333 160.98933 159.66533 157.7463 155.1347 153.2393
#&gt; [3,] 258.69100 254.81867 250.93133 247.61267 247.5203 244.7883 241.2600
#&gt; [4,] 343.82067 341.66833 334.16667 330.03433 328.7680 324.6757 324.6210
#&gt; [5,] 427.76167 422.73000 416.02133 413.34567 408.6227 403.8053 400.3250
#&gt; [6,] 519.65350 516.54950 512.45650 502.48600 499.6525 495.0010 486.4970
#&gt;           475    475.5       476    476.5       477    477.5       478
#&gt; [1,]  75.6460  76.4370  74.57033  72.8790  72.80267  71.0520  70.21367
#&gt; [2,] 151.5230 149.1967 147.49467 147.4900 145.43367 144.8190 142.43867
#&gt; [3,] 240.2400 238.4173 233.56600 231.2630 229.50400 228.8280 225.52900
#&gt; [4,] 318.5067 314.8400 312.79333 309.2847 306.05233 304.2447 299.30133
#&gt; [5,] 393.7733 393.7857 386.53867 383.8693 378.65500 373.6480 372.70233
#&gt; [6,] 481.7395 476.4720 472.37900 469.2545 466.99550 457.7630 452.32300
#&gt;          478.5       479    479.5       480     480.5      481     481.5
#&gt; [1,]  69.60533  69.98967  68.7800  68.34233  67.68467  67.2770  67.04833
#&gt; [2,] 142.68967 142.88100 139.8377 135.47933 135.25267 135.8457 133.55900
#&gt; [3,] 221.65767 218.32400 216.5063 213.21500 215.24567 208.5493 208.86967
#&gt; [4,] 295.51333 292.25100 290.5580 286.98100 285.83633 283.1347 276.48133
#&gt; [5,] 368.87433 366.15533 362.8997 357.86333 354.96700 352.3707 344.31567
#&gt; [6,] 450.48350 445.14500 444.2740 435.22800 430.33300 424.7200 420.74800
#&gt;           482    482.5       483     483.5      484     484.5      485    485.5
#&gt; [1,]  65.3130  64.5090  63.50567  62.18367  62.0450  62.02733  61.7990  60.5280
#&gt; [2,] 133.3177 132.8240 128.93033 125.20300 124.7397 124.71667 121.6783 120.9017
#&gt; [3,] 210.3090 205.6747 203.98400 200.07500 197.6877 197.21600 193.0293 191.2113
#&gt; [4,] 275.8033 272.5720 270.89733 266.44633 265.4230 262.04033 259.8753 256.7253
#&gt; [5,] 342.1013 339.0143 336.71533 334.59300 326.0983 324.69400 320.5670 315.9307
#&gt; [6,] 418.4665 414.0175 408.32400 403.85400 405.0045 394.33500 389.9775 384.4910
#&gt;           486    486.5      487     487.5       488    488.5       489
#&gt; [1,]  59.3420  59.1250  57.7480  57.44667  57.74267  56.2750  55.49233
#&gt; [2,] 121.4060 117.6677 117.0410 115.94100 112.22900 112.7243 111.67267
#&gt; [3,] 190.7627 186.5793 183.0927 182.39100 179.87400 177.1340 176.43600
#&gt; [4,] 250.2083 249.2670 245.6137 240.69333 240.84900 233.9953 233.73500
#&gt; [5,] 312.7320 307.9437 306.3863 298.34667 298.57433 296.0523 292.49933
#&gt; [6,] 382.3370 375.0820 369.0990 366.06300 362.45350 358.9965 352.14300
#&gt;          489.5       490     490.5       491    491.5       492    492.5
#&gt; [1,]  54.40933  53.83267  53.26333  52.45733  52.1400  49.78433  49.6230
#&gt; [2,] 109.69833 107.64067 108.05067 105.22000 102.9530 102.75833 100.6280
#&gt; [3,] 173.72833 170.26000 168.65033 166.09067 164.4463 160.81267 158.9110
#&gt; [4,] 230.80467 228.26600 223.37333 221.35733 218.9017 214.44667 210.0177
#&gt; [5,] 285.46933 282.62833 279.92767 273.34667 267.5543 266.10100 261.7657
#&gt; [6,] 348.20000 347.10650 338.79150 335.34700 330.0400 325.16200 322.0685
#&gt;           493     493.5       494     494.5       495
#&gt; [1,]  48.3380  47.30400  47.16267  46.41233  45.25633
#&gt; [2,]  97.9650  97.35333  96.60167  96.20600  94.61033
#&gt; [3,] 156.7613 154.92067 149.53900 148.52667 145.79333
#&gt; [4,] 206.0153 204.57500 201.48433 198.86733 195.86733
#&gt; [5,] 259.4020 256.20067 252.06567 248.06700 246.95200
#&gt; [6,] 315.6455 312.32950 307.51850 302.32550 294.64950</div><div class='input'>
<span class='co'>## indexing via logical matrix</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='kw'>flu</span>[[<span class='kw'>flu</span> <span class='op'>&lt;</span> <span class='fl'>125</span>]])</div><div class='output co'>#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
#&gt;   27.15   66.94   90.56   85.06  104.08  124.74 </div><div class='input'>
<span class='co'>## indexing the spectra matrix with index matrix n by 2</span>
<span class='kw'>ind</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1</span>, <span class='fl'>2</span>, <span class='fl'>4</span>, <span class='fl'>406</span>, <span class='fl'>405.5</span>, <span class='fl'>409</span>), ncol = <span class='fl'>2</span>)
<span class='kw'>ind</span></div><div class='output co'>#&gt;      [,1]  [,2]
#&gt; [1,]    1 406.0
#&gt; [2,]    2 405.5
#&gt; [3,]    4 409.0</div><div class='input'><span class='kw'>flu</span>[[<span class='kw'>ind</span>]]</div><div class='output co'>#&gt; [1]  33.37867  63.71533 175.45900</div><div class='input'>
<span class='kw'>ind</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1</span>, <span class='fl'>2</span>, <span class='fl'>4</span>, <span class='fl'>4</span><span class='op'>:</span><span class='fl'>6</span>), ncol = <span class='fl'>2</span>)
<span class='kw'>ind</span></div><div class='output co'>#&gt;      [,1] [,2]
#&gt; [1,]    1    4
#&gt; [2,]    2    5
#&gt; [3,]    4    6</div><div class='input'><span class='kw'>flu</span>[[<span class='kw'>ind</span>, wl.index = <span class='fl'>TRUE</span>]]</div><div class='output co'>#&gt; [1]  34.41933  72.52967 159.31033</div><div class='input'>
<span class='kw'>pca</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/prcomp.html'>prcomp</a></span>(<span class='kw'>flu</span>[[]])

<span class='co'>## result is data.frame, if j is given:</span>
<span class='kw'>result</span> <span class='op'>&lt;-</span> <span class='kw'>flu</span>[[, <span class='fl'>1</span><span class='op'>:</span><span class='fl'>2</span>, <span class='fl'>405</span> <span class='op'>~</span> <span class='fl'>410</span>]]
<span class='kw'>result</span></div><div class='output co'>#&gt;     spc.405 spc.405.5   spc.406 spc.406.5   spc.407 spc.407.5   spc.408
#&gt; 1  27.15000  32.34467  33.37867  34.41933  36.53133  37.64767  38.13700
#&gt; 2  66.80133  63.71533  66.71200  69.58233  72.52967  74.55833  77.04800
#&gt; 3  93.14433 103.06767 106.19367 110.18633 113.24867 119.17300 121.31333
#&gt; 4 130.66367 139.99833 143.79767 148.42000 152.13267 159.31033 165.05233
#&gt; 5 167.26667 171.89833 177.47067 184.62467 189.75233 198.11533 205.56267
#&gt; 6 198.43033 209.45800 215.78500 224.58700 232.52800 240.77133 248.04667
#&gt;   spc.408.5   spc.409 spc.409.5   spc.410         filename
#&gt; 1  39.17700  40.73567  41.38133  44.25133 rawdata/flu1.txt
#&gt; 2  80.25967  82.53867  84.49167  88.15167 rawdata/flu2.txt
#&gt; 3 124.67533 129.56867 134.11733 139.98667 rawdata/flu3.txt
#&gt; 4 168.68967 175.45900 181.58100 185.69233 rawdata/flu4.txt
#&gt; 5 208.41933 217.55267 224.74633 231.03567 rawdata/flu5.txt
#&gt; 6 256.89133 262.73900 270.27133 281.82867 rawdata/flu6.txt</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/class.html'>class</a></span>(<span class='kw'>result</span>)</div><div class='output co'>#&gt; [1] "data.frame"</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span>(<span class='kw'>result</span>)</div><div class='output co'>#&gt; [1] "spc"      "filename"</div><div class='input'>
<span class='co'>## extract the data.frame including the spectra matrix</span>
<span class='kw'>flu</span><span class='op'>$</span><span class='kw'>.</span></div><div class='output co'>#&gt;     spc.405 spc.405.5   spc.406 spc.406.5   spc.407 spc.407.5   spc.408
#&gt; 1  27.15000  32.34467  33.37867  34.41933  36.53133  37.64767  38.13700
#&gt; 2  66.80133  63.71533  66.71200  69.58233  72.52967  74.55833  77.04800
#&gt; 3  93.14433 103.06767 106.19367 110.18633 113.24867 119.17300 121.31333
#&gt; 4 130.66367 139.99833 143.79767 148.42000 152.13267 159.31033 165.05233
#&gt; 5 167.26667 171.89833 177.47067 184.62467 189.75233 198.11533 205.56267
#&gt; 6 198.43033 209.45800 215.78500 224.58700 232.52800 240.77133 248.04667
#&gt;   spc.408.5   spc.409 spc.409.5   spc.410 spc.410.5   spc.411 spc.411.5
#&gt; 1  39.17700  40.73567  41.38133  44.25133  44.12633  46.98067  49.08167
#&gt; 2  80.25967  82.53867  84.49167  88.15167  91.08533  95.37233  95.53033
#&gt; 3 124.67533 129.56867 134.11733 139.98667 145.02333 147.10367 150.53400
#&gt; 4 168.68967 175.45900 181.58100 185.69233 190.89667 197.70833 203.64700
#&gt; 5 208.41933 217.55267 224.74633 231.03567 236.35233 244.61233 251.95000
#&gt; 6 256.89133 262.73900 270.27133 281.82867 287.70467 297.23500 307.59333
#&gt;     spc.412 spc.412.5   spc.413 spc.413.5   spc.414 spc.414.5   spc.415
#&gt; 1  50.27433  50.10967  52.23167  53.03967  54.51900  56.22033  57.71933
#&gt; 2  98.99533 101.03433 103.55800 107.02667 109.54533 111.67233 113.98733
#&gt; 3 151.91733 158.18767 162.47900 167.57967 170.99567 176.37600 181.19767
#&gt; 4 209.56433 214.66167 219.65333 225.73100 232.12567 236.47700 240.81533
#&gt; 5 257.34633 265.54500 272.06333 280.74133 288.10567 291.88367 300.74000
#&gt; 6 314.99367 324.56300 330.80033 340.89667 347.62167 355.02667 365.62333
#&gt;   spc.415.5   spc.416 spc.416.5   spc.417 spc.417.5   spc.418 spc.418.5
#&gt; 1  59.51433  58.74500  60.09467  61.84067  62.16867  66.04933  65.24500
#&gt; 2 117.03267 119.83500 123.49433 123.32367 127.00167 130.68067 132.35800
#&gt; 3 181.86833 187.98933 192.12267 194.55600 198.58033 204.04367 208.43300
#&gt; 4 247.19200 252.61167 258.44767 262.91767 269.74967 273.44567 279.34533
#&gt; 5 307.87567 315.42967 321.89600 326.73133 334.01200 339.59933 343.86167
#&gt; 6 374.35700 380.21733 391.40100 398.17300 405.42933 412.48400 421.27300
#&gt;     spc.419 spc.419.5   spc.420 spc.420.5   spc.421 spc.421.5   spc.422
#&gt; 1  65.79900  66.94333  69.13600  70.92467  73.83400  74.38567  74.17333
#&gt; 2 136.16467 138.39933 140.22433 141.04333 143.13133 147.17967 150.01200
#&gt; 3 212.51867 215.81567 219.50867 222.67767 227.59000 229.54900 234.28167
#&gt; 4 283.74367 290.86000 295.65200 300.38267 303.59267 307.91433 315.23467
#&gt; 5 351.25667 357.79733 360.36000 367.96533 374.54900 381.76000 389.24100
#&gt; 6 429.36267 433.35767 443.18733 447.88033 461.33933 467.12733 475.18967
#&gt;   spc.422.5   spc.423 spc.423.5   spc.424 spc.424.5   spc.425 spc.425.5
#&gt; 1  75.53067  76.42967  76.13200  77.89067  79.36867  79.42733  82.02833
#&gt; 2 153.69333 155.72800 158.47200 159.50067 160.81567 163.90967 166.25500
#&gt; 3 236.97767 241.06967 245.41933 249.38867 251.92200 256.41200 261.64400
#&gt; 4 319.20133 322.25767 328.22000 331.54600 337.62033 341.84300 347.36800
#&gt; 5 397.79733 403.78367 408.02300 418.35533 420.61400 427.04333 433.33900
#&gt; 6 481.66667 488.73567 494.01867 504.47333 515.40467 521.23867 522.64633
#&gt;     spc.426 spc.426.5   spc.427 spc.427.5   spc.428 spc.428.5   spc.429
#&gt; 1  83.87833  83.81367  85.50667  86.50233  88.93733  88.99533  89.51500
#&gt; 2 169.59233 170.82833 172.08767 175.21133 178.47067 179.68100 181.82867
#&gt; 3 264.58433 268.46033 274.54733 275.68967 279.99767 283.71833 285.21700
#&gt; 4 352.53033 358.72233 363.61833 369.33300 373.90100 377.09633 383.98500
#&gt; 5 438.43633 449.57667 449.64833 455.43800 463.33200 471.47433 476.60033
#&gt; 6 536.03533 544.41767 551.63333 556.71267 567.61267 572.54933 578.72667
#&gt;   spc.429.5   spc.430 spc.430.5   spc.431 spc.431.5   spc.432 spc.432.5
#&gt; 1  90.55667  91.70633  93.57900  94.01300  94.21033  96.44200  96.62733
#&gt; 2 184.42933 187.75600 187.93767 191.05700 192.50900 192.80100 195.55600
#&gt; 3 290.15667 292.75667 294.99133 299.22533 301.33567 301.46200 309.15933
#&gt; 4 386.89700 393.22067 398.54233 402.31633 405.33067 409.50400 412.68800
#&gt; 5 480.93533 486.53833 491.91000 500.59200 502.12433 508.40733 512.70433
#&gt; 6 587.74900 590.54867 600.42300 608.35800 614.03833 616.95567 621.87267
#&gt;     spc.433 spc.433.5   spc.434 spc.434.5   spc.435 spc.435.5   spc.436
#&gt; 1  98.96233  98.84767 100.56833 100.44933  99.91600  99.71900 100.88633
#&gt; 2 197.89067 198.78200 200.99467 201.52233 200.20600 204.13200 204.90433
#&gt; 3 309.92833 310.05567 312.86500 314.62367 318.42200 323.17967 324.57933
#&gt; 4 418.63200 418.58267 417.95567 420.19100 428.14767 428.40300 430.17300
#&gt; 5 515.62733 522.20267 524.72467 525.20700 529.69967 531.71400 537.00600
#&gt; 6 629.80033 633.44500 637.13233 639.16167 642.89833 648.17200 651.67900
#&gt;   spc.436.5   spc.437 spc.437.5   spc.438 spc.438.5   spc.439 spc.439.5
#&gt; 1 101.44533 102.64267 104.22967 103.11133 104.75800 103.15833 103.94267
#&gt; 2 203.98833 205.75600 204.81700 206.09100 208.60733 210.79667 210.58400
#&gt; 3 325.85133 326.61767 324.63700 326.96700 327.78933 329.90967 328.28167
#&gt; 4 431.36800 434.95500 434.42533 438.43967 439.85467 438.54167 440.27267
#&gt; 5 538.20567 543.83567 544.08533 547.93633 552.15700 550.93500 548.20333
#&gt; 6 654.53967 656.83267 659.77800 662.05633 663.12300 663.48200 670.47567
#&gt;     spc.440 spc.440.5   spc.441 spc.441.5   spc.442 spc.442.5   spc.443
#&gt; 1 105.37100 105.86333 103.67967 104.09000 104.65400 105.22633 104.80433
#&gt; 2 210.19033 210.54233 209.85933 212.82733 212.52067 212.41967 211.22233
#&gt; 3 328.56567 331.69100 330.74933 335.06767 334.62533 334.27133 332.64733
#&gt; 4 438.30833 440.54033 443.27967 445.88900 444.99000 446.40533 444.76700
#&gt; 5 548.14767 550.77700 550.86067 551.78767 553.30400 552.57400 553.54533
#&gt; 6 669.88700 670.06033 671.00800 667.61233 666.30833 669.97433 675.68300
#&gt;   spc.443.5   spc.444 spc.444.5   spc.445 spc.445.5   spc.446 spc.446.5
#&gt; 1 105.81033 104.75800 103.88300 105.36167 105.01500 105.05933 105.34933
#&gt; 2 215.56367 213.42467 211.15933 212.97533 213.98933 214.17200 213.47633
#&gt; 3 333.62633 332.72400 330.82933 332.14667 334.25567 333.93800 332.78600
#&gt; 4 445.82700 446.16433 446.24100 446.36533 442.30900 444.89333 446.92033
#&gt; 5 551.11500 555.87400 554.84800 558.49500 556.92500 559.01233 557.12833
#&gt; 6 675.97867 676.64200 674.73667 671.23433 673.61133 676.73533 677.49467
#&gt;     spc.447 spc.447.5   spc.448 spc.448.5   spc.449 spc.449.5   spc.450
#&gt; 1 103.98700 105.43867 104.19667 105.09800 104.72333 106.66733 106.94967
#&gt; 2 212.48867 211.74100 212.70467 212.94033 212.12933 213.77267 213.49733
#&gt; 3 331.55400 331.97367 334.16567 334.10633 333.85700 336.50567 333.77567
#&gt; 4 448.18633 446.18767 446.09267 448.20600 446.96067 446.45833 446.63067
#&gt; 5 555.68833 553.09200 554.96233 553.30000 555.83300 555.17800 556.52367
#&gt; 6 674.28033 676.64567 674.89067 673.09200 674.89800 671.64167 672.53167
#&gt;   spc.450.5   spc.451 spc.451.5   spc.452 spc.452.5   spc.453 spc.453.5
#&gt; 1 104.75467 105.08267 105.30000 105.21300 104.78100 104.53867 105.13267
#&gt; 2 213.46400 213.17067 212.83600 211.96333 208.79867 211.50633 209.47700
#&gt; 3 334.70633 333.20267 333.36967 332.16600 330.79900 332.47633 332.63667
#&gt; 4 448.45033 448.09967 446.22200 445.86033 443.31967 443.83833 442.67333
#&gt; 5 554.77567 551.07633 553.91567 553.45200 550.76067 551.41767 548.26100
#&gt; 6 672.28033 671.00033 672.87900 674.74300 672.72467 669.79100 672.00433
#&gt;     spc.454 spc.454.5   spc.455 spc.455.5   spc.456 spc.456.5   spc.457
#&gt; 1 105.16967 104.05700 106.38533 104.07967 104.40133 102.18133 103.44167
#&gt; 2 211.85967 213.26200 212.28367 211.77333 209.39067 208.85600 208.34033
#&gt; 3 330.23200 329.06333 327.73533 327.03167 326.89333 327.08800 326.73833
#&gt; 4 440.84300 444.90533 442.43233 438.76567 435.72033 436.73867 438.15267
#&gt; 5 549.39067 553.83833 549.54067 544.38700 544.44033 543.01167 539.73833
#&gt; 6 672.33967 668.74033 662.63333 666.29700 664.63267 659.91800 660.13033
#&gt;   spc.457.5   spc.458 spc.458.5   spc.459 spc.459.5   spc.460 spc.460.5
#&gt; 1 101.79700 102.87167 102.38867 100.41900 101.16167  98.61133  98.42933
#&gt; 2 206.50633 206.77733 206.64500 205.25500 201.74700 201.98800 199.57000
#&gt; 3 324.45733 322.25233 318.61333 319.23467 318.66567 314.18900 313.58533
#&gt; 4 432.70400 433.13733 430.09933 427.13467 421.59067 421.58900 420.52567
#&gt; 5 538.81333 537.68600 532.22333 531.40200 527.58867 526.91933 519.80200
#&gt; 6 656.23733 654.19500 652.31833 647.82100 643.38133 640.79033 632.11967
#&gt;     spc.461 spc.461.5   spc.462 spc.462.5   spc.463 spc.463.5   spc.464
#&gt; 1  98.57600  98.34100  98.46733  95.14900  94.71100  95.27433  94.88433
#&gt; 2 200.55100 198.76767 197.03300 194.14467 193.38300 193.66467 192.51267
#&gt; 3 310.74700 311.77633 306.24567 305.31367 303.65067 299.22133 301.25333
#&gt; 4 417.21033 414.81367 415.02733 407.90400 404.02167 401.89667 397.83033
#&gt; 5 518.62067 515.22900 511.55500 506.87467 503.26400 498.34400 494.06167
#&gt; 6 633.56367 627.81900 623.21133 619.99667 613.55133 606.01267 605.92100
#&gt;   spc.464.5   spc.465 spc.465.5   spc.466 spc.466.5   spc.467 spc.467.5
#&gt; 1  93.62133  92.46567  92.11533  91.30867  89.53900  88.28100  86.13633
#&gt; 2 190.63300 186.45567 186.05433 182.30533 182.33367 180.56933 180.50633
#&gt; 3 296.55200 294.46667 291.52000 288.69967 286.65467 283.82400 282.00933
#&gt; 4 395.28733 391.98100 386.99833 387.28467 379.87933 377.22867 374.34933
#&gt; 5 491.78467 484.60533 486.67233 479.56767 475.90100 472.13100 464.54333
#&gt; 6 599.88400 593.00650 587.40150 586.38900 581.49850 574.15100 566.49250
#&gt;     spc.468 spc.468.5   spc.469 spc.469.5   spc.470 spc.470.5   spc.471
#&gt; 1  86.16200  86.81733  85.95767  84.06700  86.21200  83.68333  82.56867
#&gt; 2 180.21267 175.21100 171.65000 170.41667 170.37400 169.40700 164.89000
#&gt; 3 279.39100 274.85267 271.53567 268.85467 265.92933 261.68533 260.63400
#&gt; 4 368.45633 365.84700 360.04467 359.29733 354.65933 350.36133 346.36533
#&gt; 5 457.90900 455.22167 449.28400 446.34567 442.75167 438.25067 432.26667
#&gt; 6 560.29000 559.46250 550.27850 545.54350 542.76900 528.92800 528.12900
#&gt;   spc.471.5   spc.472 spc.472.5   spc.473 spc.473.5   spc.474 spc.474.5
#&gt; 1  82.70533  81.26033  78.75233  76.67533  77.95300  77.50700  76.16400
#&gt; 2 164.14133 163.17333 160.98933 159.66533 157.74633 155.13467 153.23933
#&gt; 3 258.69100 254.81867 250.93133 247.61267 247.52033 244.78833 241.26000
#&gt; 4 343.82067 341.66833 334.16667 330.03433 328.76800 324.67567 324.62100
#&gt; 5 427.76167 422.73000 416.02133 413.34567 408.62267 403.80533 400.32500
#&gt; 6 519.65350 516.54950 512.45650 502.48600 499.65250 495.00100 486.49700
#&gt;     spc.475 spc.475.5   spc.476 spc.476.5   spc.477 spc.477.5   spc.478
#&gt; 1  75.64600  76.43700  74.57033  72.87900  72.80267  71.05200  70.21367
#&gt; 2 151.52300 149.19667 147.49467 147.49000 145.43367 144.81900 142.43867
#&gt; 3 240.24000 238.41733 233.56600 231.26300 229.50400 228.82800 225.52900
#&gt; 4 318.50667 314.84000 312.79333 309.28467 306.05233 304.24467 299.30133
#&gt; 5 393.77333 393.78567 386.53867 383.86933 378.65500 373.64800 372.70233
#&gt; 6 481.73950 476.47200 472.37900 469.25450 466.99550 457.76300 452.32300
#&gt;   spc.478.5   spc.479 spc.479.5   spc.480 spc.480.5   spc.481 spc.481.5
#&gt; 1  69.60533  69.98967  68.78000  68.34233  67.68467  67.27700  67.04833
#&gt; 2 142.68967 142.88100 139.83767 135.47933 135.25267 135.84567 133.55900
#&gt; 3 221.65767 218.32400 216.50633 213.21500 215.24567 208.54933 208.86967
#&gt; 4 295.51333 292.25100 290.55800 286.98100 285.83633 283.13467 276.48133
#&gt; 5 368.87433 366.15533 362.89967 357.86333 354.96700 352.37067 344.31567
#&gt; 6 450.48350 445.14500 444.27400 435.22800 430.33300 424.72000 420.74800
#&gt;     spc.482 spc.482.5   spc.483 spc.483.5   spc.484 spc.484.5   spc.485
#&gt; 1  65.31300  64.50900  63.50567  62.18367  62.04500  62.02733  61.79900
#&gt; 2 133.31767 132.82400 128.93033 125.20300 124.73967 124.71667 121.67833
#&gt; 3 210.30900 205.67467 203.98400 200.07500 197.68767 197.21600 193.02933
#&gt; 4 275.80333 272.57200 270.89733 266.44633 265.42300 262.04033 259.87533
#&gt; 5 342.10133 339.01433 336.71533 334.59300 326.09833 324.69400 320.56700
#&gt; 6 418.46650 414.01750 408.32400 403.85400 405.00450 394.33500 389.97750
#&gt;   spc.485.5   spc.486 spc.486.5   spc.487 spc.487.5   spc.488 spc.488.5
#&gt; 1  60.52800  59.34200  59.12500  57.74800  57.44667  57.74267  56.27500
#&gt; 2 120.90167 121.40600 117.66767 117.04100 115.94100 112.22900 112.72433
#&gt; 3 191.21133 190.76267 186.57933 183.09267 182.39100 179.87400 177.13400
#&gt; 4 256.72533 250.20833 249.26700 245.61367 240.69333 240.84900 233.99533
#&gt; 5 315.93067 312.73200 307.94367 306.38633 298.34667 298.57433 296.05233
#&gt; 6 384.49100 382.33700 375.08200 369.09900 366.06300 362.45350 358.99650
#&gt;     spc.489 spc.489.5   spc.490 spc.490.5   spc.491 spc.491.5   spc.492
#&gt; 1  55.49233  54.40933  53.83267  53.26333  52.45733  52.14000  49.78433
#&gt; 2 111.67267 109.69833 107.64067 108.05067 105.22000 102.95300 102.75833
#&gt; 3 176.43600 173.72833 170.26000 168.65033 166.09067 164.44633 160.81267
#&gt; 4 233.73500 230.80467 228.26600 223.37333 221.35733 218.90167 214.44667
#&gt; 5 292.49933 285.46933 282.62833 279.92767 273.34667 267.55433 266.10100
#&gt; 6 352.14300 348.20000 347.10650 338.79150 335.34700 330.04000 325.16200
#&gt;   spc.492.5   spc.493 spc.493.5   spc.494 spc.494.5   spc.495         filename
#&gt; 1  49.62300  48.33800  47.30400  47.16267  46.41233  45.25633 rawdata/flu1.txt
#&gt; 2 100.62800  97.96500  97.35333  96.60167  96.20600  94.61033 rawdata/flu2.txt
#&gt; 3 158.91100 156.76133 154.92067 149.53900 148.52667 145.79333 rawdata/flu3.txt
#&gt; 4 210.01767 206.01533 204.57500 201.48433 198.86733 195.86733 rawdata/flu4.txt
#&gt; 5 261.76567 259.40200 256.20067 252.06567 248.06700 246.95200 rawdata/flu5.txt
#&gt; 6 322.06850 315.64550 312.32950 307.51850 302.32550 294.64950 rawdata/flu6.txt
#&gt;      c
#&gt; 1 0.05
#&gt; 2 0.10
#&gt; 3 0.15
#&gt; 4 0.20
#&gt; 5 0.25
#&gt; 6 0.30</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/dim.html'>dim</a></span>(<span class='kw'>flu</span><span class='op'>$</span><span class='kw'>.</span>)</div><div class='output co'>#&gt; [1] 6 3</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span>(<span class='kw'>flu</span><span class='op'>$</span><span class='kw'>.</span>)</div><div class='output co'>#&gt; [1] "spc"      "filename" "c"       </div><div class='input'><span class='kw'>flu</span><span class='op'>$</span><span class='kw'>.</span><span class='op'>$</span><span class='kw'>spc</span></div><div class='output co'>#&gt;            405     405.5       406     406.5       407     407.5      408
#&gt; [1,]  27.15000  32.34467  33.37867  34.41933  36.53133  37.64767  38.1370
#&gt; [2,]  66.80133  63.71533  66.71200  69.58233  72.52967  74.55833  77.0480
#&gt; [3,]  93.14433 103.06767 106.19367 110.18633 113.24867 119.17300 121.3133
#&gt; [4,] 130.66367 139.99833 143.79767 148.42000 152.13267 159.31033 165.0523
#&gt; [5,] 167.26667 171.89833 177.47067 184.62467 189.75233 198.11533 205.5627
#&gt; [6,] 198.43033 209.45800 215.78500 224.58700 232.52800 240.77133 248.0467
#&gt;          408.5       409     409.5       410     410.5       411     411.5
#&gt; [1,]  39.17700  40.73567  41.38133  44.25133  44.12633  46.98067  49.08167
#&gt; [2,]  80.25967  82.53867  84.49167  88.15167  91.08533  95.37233  95.53033
#&gt; [3,] 124.67533 129.56867 134.11733 139.98667 145.02333 147.10367 150.53400
#&gt; [4,] 168.68967 175.45900 181.58100 185.69233 190.89667 197.70833 203.64700
#&gt; [5,] 208.41933 217.55267 224.74633 231.03567 236.35233 244.61233 251.95000
#&gt; [6,] 256.89133 262.73900 270.27133 281.82867 287.70467 297.23500 307.59333
#&gt;            412     412.5       413     413.5      414     414.5       415
#&gt; [1,]  50.27433  50.10967  52.23167  53.03967  54.5190  56.22033  57.71933
#&gt; [2,]  98.99533 101.03433 103.55800 107.02667 109.5453 111.67233 113.98733
#&gt; [3,] 151.91733 158.18767 162.47900 167.57967 170.9957 176.37600 181.19767
#&gt; [4,] 209.56433 214.66167 219.65333 225.73100 232.1257 236.47700 240.81533
#&gt; [5,] 257.34633 265.54500 272.06333 280.74133 288.1057 291.88367 300.74000
#&gt; [6,] 314.99367 324.56300 330.80033 340.89667 347.6217 355.02667 365.62333
#&gt;          415.5      416     416.5       417     417.5       418    418.5
#&gt; [1,]  59.51433  58.7450  60.09467  61.84067  62.16867  66.04933  65.2450
#&gt; [2,] 117.03267 119.8350 123.49433 123.32367 127.00167 130.68067 132.3580
#&gt; [3,] 181.86833 187.9893 192.12267 194.55600 198.58033 204.04367 208.4330
#&gt; [4,] 247.19200 252.6117 258.44767 262.91767 269.74967 273.44567 279.3453
#&gt; [5,] 307.87567 315.4297 321.89600 326.73133 334.01200 339.59933 343.8617
#&gt; [6,] 374.35700 380.2173 391.40100 398.17300 405.42933 412.48400 421.2730
#&gt;           419     419.5      420     420.5      421     421.5       422
#&gt; [1,]  65.7990  66.94333  69.1360  70.92467  73.8340  74.38567  74.17333
#&gt; [2,] 136.1647 138.39933 140.2243 141.04333 143.1313 147.17967 150.01200
#&gt; [3,] 212.5187 215.81567 219.5087 222.67767 227.5900 229.54900 234.28167
#&gt; [4,] 283.7437 290.86000 295.6520 300.38267 303.5927 307.91433 315.23467
#&gt; [5,] 351.2567 357.79733 360.3600 367.96533 374.5490 381.76000 389.24100
#&gt; [6,] 429.3627 433.35767 443.1873 447.88033 461.3393 467.12733 475.18967
#&gt;          422.5       423    423.5       424     424.5       425     425.5
#&gt; [1,]  75.53067  76.42967  76.1320  77.89067  79.36867  79.42733  82.02833
#&gt; [2,] 153.69333 155.72800 158.4720 159.50067 160.81567 163.90967 166.25500
#&gt; [3,] 236.97767 241.06967 245.4193 249.38867 251.92200 256.41200 261.64400
#&gt; [4,] 319.20133 322.25767 328.2200 331.54600 337.62033 341.84300 347.36800
#&gt; [5,] 397.79733 403.78367 408.0230 418.35533 420.61400 427.04333 433.33900
#&gt; [6,] 481.66667 488.73567 494.0187 504.47333 515.40467 521.23867 522.64633
#&gt;            426     426.5       427     427.5       428     428.5      429
#&gt; [1,]  83.87833  83.81367  85.50667  86.50233  88.93733  88.99533  89.5150
#&gt; [2,] 169.59233 170.82833 172.08767 175.21133 178.47067 179.68100 181.8287
#&gt; [3,] 264.58433 268.46033 274.54733 275.68967 279.99767 283.71833 285.2170
#&gt; [4,] 352.53033 358.72233 363.61833 369.33300 373.90100 377.09633 383.9850
#&gt; [5,] 438.43633 449.57667 449.64833 455.43800 463.33200 471.47433 476.6003
#&gt; [6,] 536.03533 544.41767 551.63333 556.71267 567.61267 572.54933 578.7267
#&gt;          429.5       430    430.5      431     431.5      432     432.5
#&gt; [1,]  90.55667  91.70633  93.5790  94.0130  94.21033  96.4420  96.62733
#&gt; [2,] 184.42933 187.75600 187.9377 191.0570 192.50900 192.8010 195.55600
#&gt; [3,] 290.15667 292.75667 294.9913 299.2253 301.33567 301.4620 309.15933
#&gt; [4,] 386.89700 393.22067 398.5423 402.3163 405.33067 409.5040 412.68800
#&gt; [5,] 480.93533 486.53833 491.9100 500.5920 502.12433 508.4073 512.70433
#&gt; [6,] 587.74900 590.54867 600.4230 608.3580 614.03833 616.9557 621.87267
#&gt;            433     433.5      434    434.5      435    435.5      436    436.5
#&gt; [1,]  98.96233  98.84767 100.5683 100.4493  99.9160  99.7190 100.8863 101.4453
#&gt; [2,] 197.89067 198.78200 200.9947 201.5223 200.2060 204.1320 204.9043 203.9883
#&gt; [3,] 309.92833 310.05567 312.8650 314.6237 318.4220 323.1797 324.5793 325.8513
#&gt; [4,] 418.63200 418.58267 417.9557 420.1910 428.1477 428.4030 430.1730 431.3680
#&gt; [5,] 515.62733 522.20267 524.7247 525.2070 529.6997 531.7140 537.0060 538.2057
#&gt; [6,] 629.80033 633.44500 637.1323 639.1617 642.8983 648.1720 651.6790 654.5397
#&gt;           437    437.5      438    438.5      439    439.5      440    440.5
#&gt; [1,] 102.6427 104.2297 103.1113 104.7580 103.1583 103.9427 105.3710 105.8633
#&gt; [2,] 205.7560 204.8170 206.0910 208.6073 210.7967 210.5840 210.1903 210.5423
#&gt; [3,] 326.6177 324.6370 326.9670 327.7893 329.9097 328.2817 328.5657 331.6910
#&gt; [4,] 434.9550 434.4253 438.4397 439.8547 438.5417 440.2727 438.3083 440.5403
#&gt; [5,] 543.8357 544.0853 547.9363 552.1570 550.9350 548.2033 548.1477 550.7770
#&gt; [6,] 656.8327 659.7780 662.0563 663.1230 663.4820 670.4757 669.8870 670.0603
#&gt;           441    441.5      442    442.5      443    443.5      444    444.5
#&gt; [1,] 103.6797 104.0900 104.6540 105.2263 104.8043 105.8103 104.7580 103.8830
#&gt; [2,] 209.8593 212.8273 212.5207 212.4197 211.2223 215.5637 213.4247 211.1593
#&gt; [3,] 330.7493 335.0677 334.6253 334.2713 332.6473 333.6263 332.7240 330.8293
#&gt; [4,] 443.2797 445.8890 444.9900 446.4053 444.7670 445.8270 446.1643 446.2410
#&gt; [5,] 550.8607 551.7877 553.3040 552.5740 553.5453 551.1150 555.8740 554.8480
#&gt; [6,] 671.0080 667.6123 666.3083 669.9743 675.6830 675.9787 676.6420 674.7367
#&gt;           445    445.5      446    446.5      447    447.5      448    448.5
#&gt; [1,] 105.3617 105.0150 105.0593 105.3493 103.9870 105.4387 104.1967 105.0980
#&gt; [2,] 212.9753 213.9893 214.1720 213.4763 212.4887 211.7410 212.7047 212.9403
#&gt; [3,] 332.1467 334.2557 333.9380 332.7860 331.5540 331.9737 334.1657 334.1063
#&gt; [4,] 446.3653 442.3090 444.8933 446.9203 448.1863 446.1877 446.0927 448.2060
#&gt; [5,] 558.4950 556.9250 559.0123 557.1283 555.6883 553.0920 554.9623 553.3000
#&gt; [6,] 671.2343 673.6113 676.7353 677.4947 674.2803 676.6457 674.8907 673.0920
#&gt;           449    449.5      450    450.5      451    451.5      452    452.5
#&gt; [1,] 104.7233 106.6673 106.9497 104.7547 105.0827 105.3000 105.2130 104.7810
#&gt; [2,] 212.1293 213.7727 213.4973 213.4640 213.1707 212.8360 211.9633 208.7987
#&gt; [3,] 333.8570 336.5057 333.7757 334.7063 333.2027 333.3697 332.1660 330.7990
#&gt; [4,] 446.9607 446.4583 446.6307 448.4503 448.0997 446.2220 445.8603 443.3197
#&gt; [5,] 555.8330 555.1780 556.5237 554.7757 551.0763 553.9157 553.4520 550.7607
#&gt; [6,] 674.8980 671.6417 672.5317 672.2803 671.0003 672.8790 674.7430 672.7247
#&gt;           453    453.5      454    454.5      455    455.5      456    456.5
#&gt; [1,] 104.5387 105.1327 105.1697 104.0570 106.3853 104.0797 104.4013 102.1813
#&gt; [2,] 211.5063 209.4770 211.8597 213.2620 212.2837 211.7733 209.3907 208.8560
#&gt; [3,] 332.4763 332.6367 330.2320 329.0633 327.7353 327.0317 326.8933 327.0880
#&gt; [4,] 443.8383 442.6733 440.8430 444.9053 442.4323 438.7657 435.7203 436.7387
#&gt; [5,] 551.4177 548.2610 549.3907 553.8383 549.5407 544.3870 544.4403 543.0117
#&gt; [6,] 669.7910 672.0043 672.3397 668.7403 662.6333 666.2970 664.6327 659.9180
#&gt;           457    457.5      458    458.5      459    459.5       460     460.5
#&gt; [1,] 103.4417 101.7970 102.8717 102.3887 100.4190 101.1617  98.61133  98.42933
#&gt; [2,] 208.3403 206.5063 206.7773 206.6450 205.2550 201.7470 201.98800 199.57000
#&gt; [3,] 326.7383 324.4573 322.2523 318.6133 319.2347 318.6657 314.18900 313.58533
#&gt; [4,] 438.1527 432.7040 433.1373 430.0993 427.1347 421.5907 421.58900 420.52567
#&gt; [5,] 539.7383 538.8133 537.6860 532.2233 531.4020 527.5887 526.91933 519.80200
#&gt; [6,] 660.1303 656.2373 654.1950 652.3183 647.8210 643.3813 640.79033 632.11967
#&gt;           461    461.5       462    462.5      463     463.5       464
#&gt; [1,]  98.5760  98.3410  98.46733  95.1490  94.7110  95.27433  94.88433
#&gt; [2,] 200.5510 198.7677 197.03300 194.1447 193.3830 193.66467 192.51267
#&gt; [3,] 310.7470 311.7763 306.24567 305.3137 303.6507 299.22133 301.25333
#&gt; [4,] 417.2103 414.8137 415.02733 407.9040 404.0217 401.89667 397.83033
#&gt; [5,] 518.6207 515.2290 511.55500 506.8747 503.2640 498.34400 494.06167
#&gt; [6,] 633.5637 627.8190 623.21133 619.9967 613.5513 606.01267 605.92100
#&gt;          464.5       465     465.5       466    466.5      467     467.5
#&gt; [1,]  93.62133  92.46567  92.11533  91.30867  89.5390  88.2810  86.13633
#&gt; [2,] 190.63300 186.45567 186.05433 182.30533 182.3337 180.5693 180.50633
#&gt; [3,] 296.55200 294.46667 291.52000 288.69967 286.6547 283.8240 282.00933
#&gt; [4,] 395.28733 391.98100 386.99833 387.28467 379.8793 377.2287 374.34933
#&gt; [5,] 491.78467 484.60533 486.67233 479.56767 475.9010 472.1310 464.54333
#&gt; [6,] 599.88400 593.00650 587.40150 586.38900 581.4985 574.1510 566.49250
#&gt;           468     468.5       469    469.5      470     470.5       471
#&gt; [1,]  86.1620  86.81733  85.95767  84.0670  86.2120  83.68333  82.56867
#&gt; [2,] 180.2127 175.21100 171.65000 170.4167 170.3740 169.40700 164.89000
#&gt; [3,] 279.3910 274.85267 271.53567 268.8547 265.9293 261.68533 260.63400
#&gt; [4,] 368.4563 365.84700 360.04467 359.2973 354.6593 350.36133 346.36533
#&gt; [5,] 457.9090 455.22167 449.28400 446.3457 442.7517 438.25067 432.26667
#&gt; [6,] 560.2900 559.46250 550.27850 545.5435 542.7690 528.92800 528.12900
#&gt;          471.5       472     472.5       473    473.5      474    474.5
#&gt; [1,]  82.70533  81.26033  78.75233  76.67533  77.9530  77.5070  76.1640
#&gt; [2,] 164.14133 163.17333 160.98933 159.66533 157.7463 155.1347 153.2393
#&gt; [3,] 258.69100 254.81867 250.93133 247.61267 247.5203 244.7883 241.2600
#&gt; [4,] 343.82067 341.66833 334.16667 330.03433 328.7680 324.6757 324.6210
#&gt; [5,] 427.76167 422.73000 416.02133 413.34567 408.6227 403.8053 400.3250
#&gt; [6,] 519.65350 516.54950 512.45650 502.48600 499.6525 495.0010 486.4970
#&gt;           475    475.5       476    476.5       477    477.5       478
#&gt; [1,]  75.6460  76.4370  74.57033  72.8790  72.80267  71.0520  70.21367
#&gt; [2,] 151.5230 149.1967 147.49467 147.4900 145.43367 144.8190 142.43867
#&gt; [3,] 240.2400 238.4173 233.56600 231.2630 229.50400 228.8280 225.52900
#&gt; [4,] 318.5067 314.8400 312.79333 309.2847 306.05233 304.2447 299.30133
#&gt; [5,] 393.7733 393.7857 386.53867 383.8693 378.65500 373.6480 372.70233
#&gt; [6,] 481.7395 476.4720 472.37900 469.2545 466.99550 457.7630 452.32300
#&gt;          478.5       479    479.5       480     480.5      481     481.5
#&gt; [1,]  69.60533  69.98967  68.7800  68.34233  67.68467  67.2770  67.04833
#&gt; [2,] 142.68967 142.88100 139.8377 135.47933 135.25267 135.8457 133.55900
#&gt; [3,] 221.65767 218.32400 216.5063 213.21500 215.24567 208.5493 208.86967
#&gt; [4,] 295.51333 292.25100 290.5580 286.98100 285.83633 283.1347 276.48133
#&gt; [5,] 368.87433 366.15533 362.8997 357.86333 354.96700 352.3707 344.31567
#&gt; [6,] 450.48350 445.14500 444.2740 435.22800 430.33300 424.7200 420.74800
#&gt;           482    482.5       483     483.5      484     484.5      485    485.5
#&gt; [1,]  65.3130  64.5090  63.50567  62.18367  62.0450  62.02733  61.7990  60.5280
#&gt; [2,] 133.3177 132.8240 128.93033 125.20300 124.7397 124.71667 121.6783 120.9017
#&gt; [3,] 210.3090 205.6747 203.98400 200.07500 197.6877 197.21600 193.0293 191.2113
#&gt; [4,] 275.8033 272.5720 270.89733 266.44633 265.4230 262.04033 259.8753 256.7253
#&gt; [5,] 342.1013 339.0143 336.71533 334.59300 326.0983 324.69400 320.5670 315.9307
#&gt; [6,] 418.4665 414.0175 408.32400 403.85400 405.0045 394.33500 389.9775 384.4910
#&gt;           486    486.5      487     487.5       488    488.5       489
#&gt; [1,]  59.3420  59.1250  57.7480  57.44667  57.74267  56.2750  55.49233
#&gt; [2,] 121.4060 117.6677 117.0410 115.94100 112.22900 112.7243 111.67267
#&gt; [3,] 190.7627 186.5793 183.0927 182.39100 179.87400 177.1340 176.43600
#&gt; [4,] 250.2083 249.2670 245.6137 240.69333 240.84900 233.9953 233.73500
#&gt; [5,] 312.7320 307.9437 306.3863 298.34667 298.57433 296.0523 292.49933
#&gt; [6,] 382.3370 375.0820 369.0990 366.06300 362.45350 358.9965 352.14300
#&gt;          489.5       490     490.5       491    491.5       492    492.5
#&gt; [1,]  54.40933  53.83267  53.26333  52.45733  52.1400  49.78433  49.6230
#&gt; [2,] 109.69833 107.64067 108.05067 105.22000 102.9530 102.75833 100.6280
#&gt; [3,] 173.72833 170.26000 168.65033 166.09067 164.4463 160.81267 158.9110
#&gt; [4,] 230.80467 228.26600 223.37333 221.35733 218.9017 214.44667 210.0177
#&gt; [5,] 285.46933 282.62833 279.92767 273.34667 267.5543 266.10100 261.7657
#&gt; [6,] 348.20000 347.10650 338.79150 335.34700 330.0400 325.16200 322.0685
#&gt;           493     493.5       494     494.5       495
#&gt; [1,]  48.3380  47.30400  47.16267  46.41233  45.25633
#&gt; [2,]  97.9650  97.35333  96.60167  96.20600  94.61033
#&gt; [3,] 156.7613 154.92067 149.53900 148.52667 145.79333
#&gt; [4,] 206.0153 204.57500 201.48433 198.86733 195.86733
#&gt; [5,] 259.4020 256.20067 252.06567 248.06700 246.95200
#&gt; [6,] 315.6455 312.32950 307.51850 302.32550 294.64950</div><div class='input'>
<span class='kw'>calibration</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/lm.html'>lm</a></span>(<span class='kw'>spc</span> <span class='op'>~</span> <span class='kw'>c</span>, data = <span class='kw'>flu</span>[, , <span class='fl'>450</span>]<span class='op'>$</span><span class='kw'>.</span>)
<span class='kw'>calibration</span></div><div class='output co'>#&gt; 
#&gt; Call:
#&gt; lm(formula = spc ~ c, data = flu[, , 450]$.)
#&gt; 
#&gt; Coefficients:
#&gt; (Intercept)            c  
#&gt;      -8.666     2268.482  
#&gt; </div><div class='input'>
<span class='kw'>flu</span><span class='op'>$</span><span class='kw'>..</span></div><div class='output co'>#&gt;           filename    c
#&gt; 1 rawdata/flu1.txt 0.05
#&gt; 2 rawdata/flu2.txt 0.10
#&gt; 3 rawdata/flu3.txt 0.15
#&gt; 4 rawdata/flu4.txt 0.20
#&gt; 5 rawdata/flu5.txt 0.25
#&gt; 6 rawdata/flu6.txt 0.30</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span>(<span class='kw'>flu</span><span class='op'>$</span><span class='kw'>..</span>)</div><div class='output co'>#&gt; [1] "filename" "c"       </div><div class='input'><span class='co'>## replacement functions</span>
<span class='kw'>spc</span> <span class='op'>&lt;-</span> <span class='kw'>flu</span>
<span class='kw'>spc</span><span class='op'>$</span><span class='kw'>.</span></div><div class='output co'>#&gt;     spc.405 spc.405.5   spc.406 spc.406.5   spc.407 spc.407.5   spc.408
#&gt; 1  27.15000  32.34467  33.37867  34.41933  36.53133  37.64767  38.13700
#&gt; 2  66.80133  63.71533  66.71200  69.58233  72.52967  74.55833  77.04800
#&gt; 3  93.14433 103.06767 106.19367 110.18633 113.24867 119.17300 121.31333
#&gt; 4 130.66367 139.99833 143.79767 148.42000 152.13267 159.31033 165.05233
#&gt; 5 167.26667 171.89833 177.47067 184.62467 189.75233 198.11533 205.56267
#&gt; 6 198.43033 209.45800 215.78500 224.58700 232.52800 240.77133 248.04667
#&gt;   spc.408.5   spc.409 spc.409.5   spc.410 spc.410.5   spc.411 spc.411.5
#&gt; 1  39.17700  40.73567  41.38133  44.25133  44.12633  46.98067  49.08167
#&gt; 2  80.25967  82.53867  84.49167  88.15167  91.08533  95.37233  95.53033
#&gt; 3 124.67533 129.56867 134.11733 139.98667 145.02333 147.10367 150.53400
#&gt; 4 168.68967 175.45900 181.58100 185.69233 190.89667 197.70833 203.64700
#&gt; 5 208.41933 217.55267 224.74633 231.03567 236.35233 244.61233 251.95000
#&gt; 6 256.89133 262.73900 270.27133 281.82867 287.70467 297.23500 307.59333
#&gt;     spc.412 spc.412.5   spc.413 spc.413.5   spc.414 spc.414.5   spc.415
#&gt; 1  50.27433  50.10967  52.23167  53.03967  54.51900  56.22033  57.71933
#&gt; 2  98.99533 101.03433 103.55800 107.02667 109.54533 111.67233 113.98733
#&gt; 3 151.91733 158.18767 162.47900 167.57967 170.99567 176.37600 181.19767
#&gt; 4 209.56433 214.66167 219.65333 225.73100 232.12567 236.47700 240.81533
#&gt; 5 257.34633 265.54500 272.06333 280.74133 288.10567 291.88367 300.74000
#&gt; 6 314.99367 324.56300 330.80033 340.89667 347.62167 355.02667 365.62333
#&gt;   spc.415.5   spc.416 spc.416.5   spc.417 spc.417.5   spc.418 spc.418.5
#&gt; 1  59.51433  58.74500  60.09467  61.84067  62.16867  66.04933  65.24500
#&gt; 2 117.03267 119.83500 123.49433 123.32367 127.00167 130.68067 132.35800
#&gt; 3 181.86833 187.98933 192.12267 194.55600 198.58033 204.04367 208.43300
#&gt; 4 247.19200 252.61167 258.44767 262.91767 269.74967 273.44567 279.34533
#&gt; 5 307.87567 315.42967 321.89600 326.73133 334.01200 339.59933 343.86167
#&gt; 6 374.35700 380.21733 391.40100 398.17300 405.42933 412.48400 421.27300
#&gt;     spc.419 spc.419.5   spc.420 spc.420.5   spc.421 spc.421.5   spc.422
#&gt; 1  65.79900  66.94333  69.13600  70.92467  73.83400  74.38567  74.17333
#&gt; 2 136.16467 138.39933 140.22433 141.04333 143.13133 147.17967 150.01200
#&gt; 3 212.51867 215.81567 219.50867 222.67767 227.59000 229.54900 234.28167
#&gt; 4 283.74367 290.86000 295.65200 300.38267 303.59267 307.91433 315.23467
#&gt; 5 351.25667 357.79733 360.36000 367.96533 374.54900 381.76000 389.24100
#&gt; 6 429.36267 433.35767 443.18733 447.88033 461.33933 467.12733 475.18967
#&gt;   spc.422.5   spc.423 spc.423.5   spc.424 spc.424.5   spc.425 spc.425.5
#&gt; 1  75.53067  76.42967  76.13200  77.89067  79.36867  79.42733  82.02833
#&gt; 2 153.69333 155.72800 158.47200 159.50067 160.81567 163.90967 166.25500
#&gt; 3 236.97767 241.06967 245.41933 249.38867 251.92200 256.41200 261.64400
#&gt; 4 319.20133 322.25767 328.22000 331.54600 337.62033 341.84300 347.36800
#&gt; 5 397.79733 403.78367 408.02300 418.35533 420.61400 427.04333 433.33900
#&gt; 6 481.66667 488.73567 494.01867 504.47333 515.40467 521.23867 522.64633
#&gt;     spc.426 spc.426.5   spc.427 spc.427.5   spc.428 spc.428.5   spc.429
#&gt; 1  83.87833  83.81367  85.50667  86.50233  88.93733  88.99533  89.51500
#&gt; 2 169.59233 170.82833 172.08767 175.21133 178.47067 179.68100 181.82867
#&gt; 3 264.58433 268.46033 274.54733 275.68967 279.99767 283.71833 285.21700
#&gt; 4 352.53033 358.72233 363.61833 369.33300 373.90100 377.09633 383.98500
#&gt; 5 438.43633 449.57667 449.64833 455.43800 463.33200 471.47433 476.60033
#&gt; 6 536.03533 544.41767 551.63333 556.71267 567.61267 572.54933 578.72667
#&gt;   spc.429.5   spc.430 spc.430.5   spc.431 spc.431.5   spc.432 spc.432.5
#&gt; 1  90.55667  91.70633  93.57900  94.01300  94.21033  96.44200  96.62733
#&gt; 2 184.42933 187.75600 187.93767 191.05700 192.50900 192.80100 195.55600
#&gt; 3 290.15667 292.75667 294.99133 299.22533 301.33567 301.46200 309.15933
#&gt; 4 386.89700 393.22067 398.54233 402.31633 405.33067 409.50400 412.68800
#&gt; 5 480.93533 486.53833 491.91000 500.59200 502.12433 508.40733 512.70433
#&gt; 6 587.74900 590.54867 600.42300 608.35800 614.03833 616.95567 621.87267
#&gt;     spc.433 spc.433.5   spc.434 spc.434.5   spc.435 spc.435.5   spc.436
#&gt; 1  98.96233  98.84767 100.56833 100.44933  99.91600  99.71900 100.88633
#&gt; 2 197.89067 198.78200 200.99467 201.52233 200.20600 204.13200 204.90433
#&gt; 3 309.92833 310.05567 312.86500 314.62367 318.42200 323.17967 324.57933
#&gt; 4 418.63200 418.58267 417.95567 420.19100 428.14767 428.40300 430.17300
#&gt; 5 515.62733 522.20267 524.72467 525.20700 529.69967 531.71400 537.00600
#&gt; 6 629.80033 633.44500 637.13233 639.16167 642.89833 648.17200 651.67900
#&gt;   spc.436.5   spc.437 spc.437.5   spc.438 spc.438.5   spc.439 spc.439.5
#&gt; 1 101.44533 102.64267 104.22967 103.11133 104.75800 103.15833 103.94267
#&gt; 2 203.98833 205.75600 204.81700 206.09100 208.60733 210.79667 210.58400
#&gt; 3 325.85133 326.61767 324.63700 326.96700 327.78933 329.90967 328.28167
#&gt; 4 431.36800 434.95500 434.42533 438.43967 439.85467 438.54167 440.27267
#&gt; 5 538.20567 543.83567 544.08533 547.93633 552.15700 550.93500 548.20333
#&gt; 6 654.53967 656.83267 659.77800 662.05633 663.12300 663.48200 670.47567
#&gt;     spc.440 spc.440.5   spc.441 spc.441.5   spc.442 spc.442.5   spc.443
#&gt; 1 105.37100 105.86333 103.67967 104.09000 104.65400 105.22633 104.80433
#&gt; 2 210.19033 210.54233 209.85933 212.82733 212.52067 212.41967 211.22233
#&gt; 3 328.56567 331.69100 330.74933 335.06767 334.62533 334.27133 332.64733
#&gt; 4 438.30833 440.54033 443.27967 445.88900 444.99000 446.40533 444.76700
#&gt; 5 548.14767 550.77700 550.86067 551.78767 553.30400 552.57400 553.54533
#&gt; 6 669.88700 670.06033 671.00800 667.61233 666.30833 669.97433 675.68300
#&gt;   spc.443.5   spc.444 spc.444.5   spc.445 spc.445.5   spc.446 spc.446.5
#&gt; 1 105.81033 104.75800 103.88300 105.36167 105.01500 105.05933 105.34933
#&gt; 2 215.56367 213.42467 211.15933 212.97533 213.98933 214.17200 213.47633
#&gt; 3 333.62633 332.72400 330.82933 332.14667 334.25567 333.93800 332.78600
#&gt; 4 445.82700 446.16433 446.24100 446.36533 442.30900 444.89333 446.92033
#&gt; 5 551.11500 555.87400 554.84800 558.49500 556.92500 559.01233 557.12833
#&gt; 6 675.97867 676.64200 674.73667 671.23433 673.61133 676.73533 677.49467
#&gt;     spc.447 spc.447.5   spc.448 spc.448.5   spc.449 spc.449.5   spc.450
#&gt; 1 103.98700 105.43867 104.19667 105.09800 104.72333 106.66733 106.94967
#&gt; 2 212.48867 211.74100 212.70467 212.94033 212.12933 213.77267 213.49733
#&gt; 3 331.55400 331.97367 334.16567 334.10633 333.85700 336.50567 333.77567
#&gt; 4 448.18633 446.18767 446.09267 448.20600 446.96067 446.45833 446.63067
#&gt; 5 555.68833 553.09200 554.96233 553.30000 555.83300 555.17800 556.52367
#&gt; 6 674.28033 676.64567 674.89067 673.09200 674.89800 671.64167 672.53167
#&gt;   spc.450.5   spc.451 spc.451.5   spc.452 spc.452.5   spc.453 spc.453.5
#&gt; 1 104.75467 105.08267 105.30000 105.21300 104.78100 104.53867 105.13267
#&gt; 2 213.46400 213.17067 212.83600 211.96333 208.79867 211.50633 209.47700
#&gt; 3 334.70633 333.20267 333.36967 332.16600 330.79900 332.47633 332.63667
#&gt; 4 448.45033 448.09967 446.22200 445.86033 443.31967 443.83833 442.67333
#&gt; 5 554.77567 551.07633 553.91567 553.45200 550.76067 551.41767 548.26100
#&gt; 6 672.28033 671.00033 672.87900 674.74300 672.72467 669.79100 672.00433
#&gt;     spc.454 spc.454.5   spc.455 spc.455.5   spc.456 spc.456.5   spc.457
#&gt; 1 105.16967 104.05700 106.38533 104.07967 104.40133 102.18133 103.44167
#&gt; 2 211.85967 213.26200 212.28367 211.77333 209.39067 208.85600 208.34033
#&gt; 3 330.23200 329.06333 327.73533 327.03167 326.89333 327.08800 326.73833
#&gt; 4 440.84300 444.90533 442.43233 438.76567 435.72033 436.73867 438.15267
#&gt; 5 549.39067 553.83833 549.54067 544.38700 544.44033 543.01167 539.73833
#&gt; 6 672.33967 668.74033 662.63333 666.29700 664.63267 659.91800 660.13033
#&gt;   spc.457.5   spc.458 spc.458.5   spc.459 spc.459.5   spc.460 spc.460.5
#&gt; 1 101.79700 102.87167 102.38867 100.41900 101.16167  98.61133  98.42933
#&gt; 2 206.50633 206.77733 206.64500 205.25500 201.74700 201.98800 199.57000
#&gt; 3 324.45733 322.25233 318.61333 319.23467 318.66567 314.18900 313.58533
#&gt; 4 432.70400 433.13733 430.09933 427.13467 421.59067 421.58900 420.52567
#&gt; 5 538.81333 537.68600 532.22333 531.40200 527.58867 526.91933 519.80200
#&gt; 6 656.23733 654.19500 652.31833 647.82100 643.38133 640.79033 632.11967
#&gt;     spc.461 spc.461.5   spc.462 spc.462.5   spc.463 spc.463.5   spc.464
#&gt; 1  98.57600  98.34100  98.46733  95.14900  94.71100  95.27433  94.88433
#&gt; 2 200.55100 198.76767 197.03300 194.14467 193.38300 193.66467 192.51267
#&gt; 3 310.74700 311.77633 306.24567 305.31367 303.65067 299.22133 301.25333
#&gt; 4 417.21033 414.81367 415.02733 407.90400 404.02167 401.89667 397.83033
#&gt; 5 518.62067 515.22900 511.55500 506.87467 503.26400 498.34400 494.06167
#&gt; 6 633.56367 627.81900 623.21133 619.99667 613.55133 606.01267 605.92100
#&gt;   spc.464.5   spc.465 spc.465.5   spc.466 spc.466.5   spc.467 spc.467.5
#&gt; 1  93.62133  92.46567  92.11533  91.30867  89.53900  88.28100  86.13633
#&gt; 2 190.63300 186.45567 186.05433 182.30533 182.33367 180.56933 180.50633
#&gt; 3 296.55200 294.46667 291.52000 288.69967 286.65467 283.82400 282.00933
#&gt; 4 395.28733 391.98100 386.99833 387.28467 379.87933 377.22867 374.34933
#&gt; 5 491.78467 484.60533 486.67233 479.56767 475.90100 472.13100 464.54333
#&gt; 6 599.88400 593.00650 587.40150 586.38900 581.49850 574.15100 566.49250
#&gt;     spc.468 spc.468.5   spc.469 spc.469.5   spc.470 spc.470.5   spc.471
#&gt; 1  86.16200  86.81733  85.95767  84.06700  86.21200  83.68333  82.56867
#&gt; 2 180.21267 175.21100 171.65000 170.41667 170.37400 169.40700 164.89000
#&gt; 3 279.39100 274.85267 271.53567 268.85467 265.92933 261.68533 260.63400
#&gt; 4 368.45633 365.84700 360.04467 359.29733 354.65933 350.36133 346.36533
#&gt; 5 457.90900 455.22167 449.28400 446.34567 442.75167 438.25067 432.26667
#&gt; 6 560.29000 559.46250 550.27850 545.54350 542.76900 528.92800 528.12900
#&gt;   spc.471.5   spc.472 spc.472.5   spc.473 spc.473.5   spc.474 spc.474.5
#&gt; 1  82.70533  81.26033  78.75233  76.67533  77.95300  77.50700  76.16400
#&gt; 2 164.14133 163.17333 160.98933 159.66533 157.74633 155.13467 153.23933
#&gt; 3 258.69100 254.81867 250.93133 247.61267 247.52033 244.78833 241.26000
#&gt; 4 343.82067 341.66833 334.16667 330.03433 328.76800 324.67567 324.62100
#&gt; 5 427.76167 422.73000 416.02133 413.34567 408.62267 403.80533 400.32500
#&gt; 6 519.65350 516.54950 512.45650 502.48600 499.65250 495.00100 486.49700
#&gt;     spc.475 spc.475.5   spc.476 spc.476.5   spc.477 spc.477.5   spc.478
#&gt; 1  75.64600  76.43700  74.57033  72.87900  72.80267  71.05200  70.21367
#&gt; 2 151.52300 149.19667 147.49467 147.49000 145.43367 144.81900 142.43867
#&gt; 3 240.24000 238.41733 233.56600 231.26300 229.50400 228.82800 225.52900
#&gt; 4 318.50667 314.84000 312.79333 309.28467 306.05233 304.24467 299.30133
#&gt; 5 393.77333 393.78567 386.53867 383.86933 378.65500 373.64800 372.70233
#&gt; 6 481.73950 476.47200 472.37900 469.25450 466.99550 457.76300 452.32300
#&gt;   spc.478.5   spc.479 spc.479.5   spc.480 spc.480.5   spc.481 spc.481.5
#&gt; 1  69.60533  69.98967  68.78000  68.34233  67.68467  67.27700  67.04833
#&gt; 2 142.68967 142.88100 139.83767 135.47933 135.25267 135.84567 133.55900
#&gt; 3 221.65767 218.32400 216.50633 213.21500 215.24567 208.54933 208.86967
#&gt; 4 295.51333 292.25100 290.55800 286.98100 285.83633 283.13467 276.48133
#&gt; 5 368.87433 366.15533 362.89967 357.86333 354.96700 352.37067 344.31567
#&gt; 6 450.48350 445.14500 444.27400 435.22800 430.33300 424.72000 420.74800
#&gt;     spc.482 spc.482.5   spc.483 spc.483.5   spc.484 spc.484.5   spc.485
#&gt; 1  65.31300  64.50900  63.50567  62.18367  62.04500  62.02733  61.79900
#&gt; 2 133.31767 132.82400 128.93033 125.20300 124.73967 124.71667 121.67833
#&gt; 3 210.30900 205.67467 203.98400 200.07500 197.68767 197.21600 193.02933
#&gt; 4 275.80333 272.57200 270.89733 266.44633 265.42300 262.04033 259.87533
#&gt; 5 342.10133 339.01433 336.71533 334.59300 326.09833 324.69400 320.56700
#&gt; 6 418.46650 414.01750 408.32400 403.85400 405.00450 394.33500 389.97750
#&gt;   spc.485.5   spc.486 spc.486.5   spc.487 spc.487.5   spc.488 spc.488.5
#&gt; 1  60.52800  59.34200  59.12500  57.74800  57.44667  57.74267  56.27500
#&gt; 2 120.90167 121.40600 117.66767 117.04100 115.94100 112.22900 112.72433
#&gt; 3 191.21133 190.76267 186.57933 183.09267 182.39100 179.87400 177.13400
#&gt; 4 256.72533 250.20833 249.26700 245.61367 240.69333 240.84900 233.99533
#&gt; 5 315.93067 312.73200 307.94367 306.38633 298.34667 298.57433 296.05233
#&gt; 6 384.49100 382.33700 375.08200 369.09900 366.06300 362.45350 358.99650
#&gt;     spc.489 spc.489.5   spc.490 spc.490.5   spc.491 spc.491.5   spc.492
#&gt; 1  55.49233  54.40933  53.83267  53.26333  52.45733  52.14000  49.78433
#&gt; 2 111.67267 109.69833 107.64067 108.05067 105.22000 102.95300 102.75833
#&gt; 3 176.43600 173.72833 170.26000 168.65033 166.09067 164.44633 160.81267
#&gt; 4 233.73500 230.80467 228.26600 223.37333 221.35733 218.90167 214.44667
#&gt; 5 292.49933 285.46933 282.62833 279.92767 273.34667 267.55433 266.10100
#&gt; 6 352.14300 348.20000 347.10650 338.79150 335.34700 330.04000 325.16200
#&gt;   spc.492.5   spc.493 spc.493.5   spc.494 spc.494.5   spc.495         filename
#&gt; 1  49.62300  48.33800  47.30400  47.16267  46.41233  45.25633 rawdata/flu1.txt
#&gt; 2 100.62800  97.96500  97.35333  96.60167  96.20600  94.61033 rawdata/flu2.txt
#&gt; 3 158.91100 156.76133 154.92067 149.53900 148.52667 145.79333 rawdata/flu3.txt
#&gt; 4 210.01767 206.01533 204.57500 201.48433 198.86733 195.86733 rawdata/flu4.txt
#&gt; 5 261.76567 259.40200 256.20067 252.06567 248.06700 246.95200 rawdata/flu5.txt
#&gt; 6 322.06850 315.64550 312.32950 307.51850 302.32550 294.64950 rawdata/flu6.txt
#&gt;      c
#&gt; 1 0.05
#&gt; 2 0.10
#&gt; 3 0.15
#&gt; 4 0.20
#&gt; 5 0.25
#&gt; 6 0.30</div><div class='input'><span class='kw'>spc</span>[, <span class='st'>"c"</span>] <span class='op'>&lt;-</span> <span class='fl'>16</span><span class='op'>:</span><span class='fl'>11</span>
<span class='co'>## be careful:</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span>(<span class='kw'>spc</span>)</div><div class='img'><img src='extractreplace-3.png' alt='' width='466' height='288' /></div><div class='input'><span class='kw'>spc</span> [] <span class='op'>&lt;-</span> <span class='fl'>6</span><span class='op'>:</span><span class='fl'>1</span>
<span class='kw'>spc</span><span class='op'>$</span><span class='kw'>..</span></div><div class='output co'>#&gt;   filename c
#&gt; 1        6 6
#&gt; 2        5 5
#&gt; 3        4 4
#&gt; 4        3 3
#&gt; 5        2 2
#&gt; 6        1 1</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span>(<span class='kw'>spc</span>)</div><div class='img'><img src='extractreplace-4.png' alt='' width='466' height='288' /></div><div class='input'><span class='kw'>spc</span> <span class='op'>&lt;-</span> <span class='kw'>flu</span> [, , <span class='fl'>405</span> <span class='op'>~</span> <span class='fl'>410</span>]
<span class='kw'>spc</span>[[]]</div><div class='output co'>#&gt;            405     405.5       406     406.5       407     407.5      408
#&gt; [1,]  27.15000  32.34467  33.37867  34.41933  36.53133  37.64767  38.1370
#&gt; [2,]  66.80133  63.71533  66.71200  69.58233  72.52967  74.55833  77.0480
#&gt; [3,]  93.14433 103.06767 106.19367 110.18633 113.24867 119.17300 121.3133
#&gt; [4,] 130.66367 139.99833 143.79767 148.42000 152.13267 159.31033 165.0523
#&gt; [5,] 167.26667 171.89833 177.47067 184.62467 189.75233 198.11533 205.5627
#&gt; [6,] 198.43033 209.45800 215.78500 224.58700 232.52800 240.77133 248.0467
#&gt;          408.5       409     409.5       410
#&gt; [1,]  39.17700  40.73567  41.38133  44.25133
#&gt; [2,]  80.25967  82.53867  84.49167  88.15167
#&gt; [3,] 124.67533 129.56867 134.11733 139.98667
#&gt; [4,] 168.68967 175.45900 181.58100 185.69233
#&gt; [5,] 208.41933 217.55267 224.74633 231.03567
#&gt; [6,] 256.89133 262.73900 270.27133 281.82867</div><div class='input'><span class='kw'>spc</span>[[<span class='fl'>3</span>]] <span class='op'>&lt;-</span> <span class='op'>-</span><span class='kw'>spc</span>[[<span class='fl'>3</span>]]
<span class='kw'>spc</span>[[]]</div><div class='output co'>#&gt;            405      405.5        406      406.5        407      407.5       408
#&gt; [1,]  27.15000   32.34467   33.37867   34.41933   36.53133   37.64767   38.1370
#&gt; [2,]  66.80133   63.71533   66.71200   69.58233   72.52967   74.55833   77.0480
#&gt; [3,] -93.14433 -103.06767 -106.19367 -110.18633 -113.24867 -119.17300 -121.3133
#&gt; [4,] 130.66367  139.99833  143.79767  148.42000  152.13267  159.31033  165.0523
#&gt; [5,] 167.26667  171.89833  177.47067  184.62467  189.75233  198.11533  205.5627
#&gt; [6,] 198.43033  209.45800  215.78500  224.58700  232.52800  240.77133  248.0467
#&gt;           408.5        409      409.5        410
#&gt; [1,]   39.17700   40.73567   41.38133   44.25133
#&gt; [2,]   80.25967   82.53867   84.49167   88.15167
#&gt; [3,] -124.67533 -129.56867 -134.11733 -139.98667
#&gt; [4,]  168.68967  175.45900  181.58100  185.69233
#&gt; [5,]  208.41933  217.55267  224.74633  231.03567
#&gt; [6,]  256.89133  262.73900  270.27133  281.82867</div><div class='input'><span class='kw'>spc</span>[[, , <span class='fl'>405</span><span class='op'>:</span><span class='fl'>410</span>]] <span class='op'>&lt;-</span> <span class='op'>-</span><span class='kw'>spc</span>[[, , <span class='fl'>405</span><span class='op'>:</span><span class='fl'>410</span>]]
<span class='kw'>spc</span>[[]]</div><div class='output co'>#&gt;             405      405.5        406      406.5        407      407.5
#&gt; [1,]  -27.15000   32.34467  -33.37867   34.41933  -36.53133   37.64767
#&gt; [2,]  -66.80133   63.71533  -66.71200   69.58233  -72.52967   74.55833
#&gt; [3,]   93.14433 -103.06767  106.19367 -110.18633  113.24867 -119.17300
#&gt; [4,] -130.66367  139.99833 -143.79767  148.42000 -152.13267  159.31033
#&gt; [5,] -167.26667  171.89833 -177.47067  184.62467 -189.75233  198.11533
#&gt; [6,] -198.43033  209.45800 -215.78500  224.58700 -232.52800  240.77133
#&gt;            408      408.5        409      409.5        410
#&gt; [1,]  -38.1370   39.17700  -40.73567   41.38133  -44.25133
#&gt; [2,]  -77.0480   80.25967  -82.53867   84.49167  -88.15167
#&gt; [3,]  121.3133 -124.67533  129.56867 -134.11733  139.98667
#&gt; [4,] -165.0523  168.68967 -175.45900  181.58100 -185.69233
#&gt; [5,] -205.5627  208.41933 -217.55267  224.74633 -231.03567
#&gt; [6,] -248.0467  256.89133 -262.73900  270.27133 -281.82867</div><div class='input'><span class='kw'>spc</span>[[, , <span class='fl'>405</span> <span class='op'>~</span> <span class='fl'>410</span>]] <span class='op'>&lt;-</span> <span class='op'>-</span><span class='kw'>spc</span>[[, , <span class='fl'>405</span> <span class='op'>~</span> <span class='fl'>410</span>]]

<span class='co'>## indexing with logical matrix</span>
<span class='kw'>spc</span> <span class='op'>&lt;-</span> <span class='kw'>flu</span> [, , <span class='kw'>min</span> <span class='op'>~</span> <span class='fl'>410</span>]
<span class='kw'>spc</span> <span class='op'>&lt;</span> <span class='fl'>125</span></div><div class='output co'>#&gt;        405 405.5   406 406.5   407 407.5   408 408.5   409 409.5   410
#&gt; [1,]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE
#&gt; [2,]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE
#&gt; [3,]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE FALSE FALSE FALSE
#&gt; [4,] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
#&gt; [5,] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
#&gt; [6,] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE</div><div class='input'><span class='kw'>spc</span>[[<span class='kw'>spc</span> <span class='op'>&lt;</span> <span class='fl'>125</span>]] <span class='op'>&lt;-</span> <span class='fl'>NA</span>
<span class='kw'>spc</span>[[]]</div><div class='output co'>#&gt;           405    405.5      406    406.5      407    407.5      408    408.5
#&gt; [1,]       NA       NA       NA       NA       NA       NA       NA       NA
#&gt; [2,]       NA       NA       NA       NA       NA       NA       NA       NA
#&gt; [3,]       NA       NA       NA       NA       NA       NA       NA       NA
#&gt; [4,] 130.6637 139.9983 143.7977 148.4200 152.1327 159.3103 165.0523 168.6897
#&gt; [5,] 167.2667 171.8983 177.4707 184.6247 189.7523 198.1153 205.5627 208.4193
#&gt; [6,] 198.4303 209.4580 215.7850 224.5870 232.5280 240.7713 248.0467 256.8913
#&gt;           409    409.5      410
#&gt; [1,]       NA       NA       NA
#&gt; [2,]       NA       NA       NA
#&gt; [3,] 129.5687 134.1173 139.9867
#&gt; [4,] 175.4590 181.5810 185.6923
#&gt; [5,] 217.5527 224.7463 231.0357
#&gt; [6,] 262.7390 270.2713 281.8287</div><div class='input'>
<span class='co'>## indexing with n by 2 matrix</span>
<span class='kw'>ind</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1</span>, <span class='fl'>2</span>, <span class='fl'>4</span>, <span class='fl'>406</span>, <span class='fl'>405.5</span>, <span class='fl'>409</span>), ncol = <span class='fl'>2</span>)
<span class='kw'>ind</span></div><div class='output co'>#&gt;      [,1]  [,2]
#&gt; [1,]    1 406.0
#&gt; [2,]    2 405.5
#&gt; [3,]    4 409.0</div><div class='input'><span class='kw'>spc</span>[[<span class='kw'>ind</span>]] <span class='op'>&lt;-</span> <span class='fl'>3</span>
<span class='kw'>spc</span>[[]]</div><div class='output co'>#&gt;           405    405.5      406    406.5      407    407.5      408    408.5
#&gt; [1,]       NA       NA   3.0000       NA       NA       NA       NA       NA
#&gt; [2,]       NA   3.0000       NA       NA       NA       NA       NA       NA
#&gt; [3,]       NA       NA       NA       NA       NA       NA       NA       NA
#&gt; [4,] 130.6637 139.9983 143.7977 148.4200 152.1327 159.3103 165.0523 168.6897
#&gt; [5,] 167.2667 171.8983 177.4707 184.6247 189.7523 198.1153 205.5627 208.4193
#&gt; [6,] 198.4303 209.4580 215.7850 224.5870 232.5280 240.7713 248.0467 256.8913
#&gt;           409    409.5      410
#&gt; [1,]       NA       NA       NA
#&gt; [2,]       NA       NA       NA
#&gt; [3,] 129.5687 134.1173 139.9867
#&gt; [4,]   3.0000 181.5810 185.6923
#&gt; [5,] 217.5527 224.7463 231.0357
#&gt; [6,] 262.7390 270.2713 281.8287</div><div class='input'>
<span class='kw'>ind</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1</span>, <span class='fl'>2</span>, <span class='fl'>4</span>, <span class='fl'>4</span><span class='op'>:</span><span class='fl'>6</span>), ncol = <span class='fl'>2</span>)
<span class='kw'>ind</span></div><div class='output co'>#&gt;      [,1] [,2]
#&gt; [1,]    1    4
#&gt; [2,]    2    5
#&gt; [3,]    4    6</div><div class='input'><span class='kw'>spc</span>[[<span class='kw'>ind</span>, wl.index = <span class='fl'>TRUE</span>]] <span class='op'>&lt;-</span> <span class='fl'>9999</span>
<span class='kw'>spc</span>[[]]</div><div class='output co'>#&gt;           405    405.5      406     406.5       407     407.5      408    408.5
#&gt; [1,]       NA       NA   3.0000 9999.0000        NA        NA       NA       NA
#&gt; [2,]       NA   3.0000       NA        NA 9999.0000        NA       NA       NA
#&gt; [3,]       NA       NA       NA        NA        NA        NA       NA       NA
#&gt; [4,] 130.6637 139.9983 143.7977  148.4200  152.1327 9999.0000 165.0523 168.6897
#&gt; [5,] 167.2667 171.8983 177.4707  184.6247  189.7523  198.1153 205.5627 208.4193
#&gt; [6,] 198.4303 209.4580 215.7850  224.5870  232.5280  240.7713 248.0467 256.8913
#&gt;           409    409.5      410
#&gt; [1,]       NA       NA       NA
#&gt; [2,]       NA       NA       NA
#&gt; [3,] 129.5687 134.1173 139.9867
#&gt; [4,]   3.0000 181.5810 185.6923
#&gt; [5,] 217.5527 224.7463 231.0357
#&gt; [6,] 262.7390 270.2713 281.8287</div><div class='input'><span class='kw'>spc</span><span class='op'>$</span><span class='kw'>.</span></div><div class='output co'>#&gt;     spc.405 spc.405.5   spc.406 spc.406.5   spc.407 spc.407.5   spc.408
#&gt; 1        NA        NA    3.0000 9999.0000        NA        NA        NA
#&gt; 2        NA    3.0000        NA        NA 9999.0000        NA        NA
#&gt; 3        NA        NA        NA        NA        NA        NA        NA
#&gt; 4  130.6637  139.9983  143.7977  148.4200  152.1327 9999.0000  165.0523
#&gt; 5  167.2667  171.8983  177.4707  184.6247  189.7523  198.1153  205.5627
#&gt; 6  198.4303  209.4580  215.7850  224.5870  232.5280  240.7713  248.0467
#&gt;   spc.408.5   spc.409 spc.409.5   spc.410         filename    c
#&gt; 1        NA        NA        NA        NA rawdata/flu1.txt 0.05
#&gt; 2        NA        NA        NA        NA rawdata/flu2.txt 0.10
#&gt; 3        NA  129.5687  134.1173  139.9867 rawdata/flu3.txt 0.15
#&gt; 4  168.6897    3.0000  181.5810  185.6923 rawdata/flu4.txt 0.20
#&gt; 5  208.4193  217.5527  224.7463  231.0357 rawdata/flu5.txt 0.25
#&gt; 6  256.8913  262.7390  270.2713  281.8287 rawdata/flu6.txt 0.30</div><div class='input'><span class='kw'>spc</span><span class='op'>$</span><span class='kw'>z</span> <span class='op'>&lt;-</span> <span class='fl'>1</span><span class='op'>:</span><span class='fl'>6</span>
<span class='kw'>spc</span></div><div class='output co'>#&gt; hyperSpec object
#&gt;    6 spectra
#&gt;    4 data columns
#&gt;    11 data points / spectrum
#&gt; wavelength: lambda/nm [numeric] 405.0 405.5 ... 410 
#&gt; data:  (6 rows x 4 columns)
#&gt;    1. spc: I[fl]/"a.u." [matrix, array11] NA NA ... 281.8287 + NA
#&gt;    2. filename: filename [character] rawdata/flu1.txt rawdata/flu2.txt ... rawdata/flu6.txt 
#&gt;    3. c: c / (mg / l) [numeric] 0.05 0.10 ... 0.3 
#&gt;    4. z: z [integer] 1 2 ... 6 </div><div class='input'><span class='kw'>spc</span><span class='op'>$</span><span class='kw'>z</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='fl'>1</span><span class='op'>:</span><span class='fl'>6</span>, <span class='st'>"z / a.u."</span>)</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Claudia Beleites, Valter Sergo.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.9000.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


